function getListener(e,t,n){var r;return t=t.toLowerCase(),(r=e.__allListeners||n&&(e.__allListeners={}))&&(r[t]||n&&(r[t]=[]))}function getDomNode(e,t,n,r,i,s){var o=r&&e[t],u;!o&&(o=e[n]);while(!o&&(u=(u||e).parentNode)){if(u.tagName=="BODY"||s&&!s(u))return null;o=u[n]}return o&&i&&!i(o)?getDomNode(o,t,n,!1,i):o}(function(e,t,n,r){e.switchable={Config:{panels:".panels > *",initIndex:0,effect:"none",loop:!1,onBeforeSwitch:null,onSwitch:null},Effects:{none:function(e,t){var n=this,r=n.panels;r.slice(e,e+1).hide(),r.slice(t,t+1).show()}},Plugins:[]};var i=function(n,r){var i=this,s=e(this),o="beforeSwitch",u="switch";e.extend(i,{_initPlugins:function(){var t=e.switchable.Plugins,n=t.length,r=0;for(;r<n;r++)e.isFunction(t[r].init)&&t[r].init(i)},_warn:function(e){t.console&&t.console.warn&&console.warn(e)},_init:function(){i.root=n,i.config=r;var t=e(n),a;if(t[0]._switchable)return;if(!t.find(r.panels).length){i._warn("No panel in switchable");return}i.panels=t.find(r.panels),i.length=i.panels.length;if(i.length<1){i._warn("No panel group in switchable");return}return e.isFunction(r.onBeforeSwitch)&&s.on(o,r.onBeforeSwitch),e.isFunction(r.onSwitch)&&s.on(u,r.onSwitch),i.index=(r.initIndex%i.length+i.length)%i.length,i._nextIndex=i.index,a=i.panels.slice(i.index,i.index+1),r.effect.toLowerCase()==="none"&&(i.panels.not(a).hide(),a.show()),t[0]._switchable=this,!0},_switchPanels:function(t,n){if(n===t)return;r.effect=r.effect.toLowerCase();if(!r.effect||!e.switchable.Effects[r.effect]){i._warn("No switch effect");return}e.switchable.Effects[r.effect].call(i,t,n)},switchTo:function(t){t%=i.length;if(t===i.index)return i;i._nextIndex=t;var n=e.Event(o);s.trigger(n,[t]);if(n.isDefaultPrevented())return;return i._switchPanels(i.index,t),i.index=t,n.type=u,s.trigger(n,[t]),i},willTo:function(){return i._nextIndex},destroy:function(){i._destroyPlugins(),i._destroy()},_destroyPlugins:function(){var t=e.switchable.Plugins,n=t.length,r=0;for(;r<n;r++)e.isFunction(t[r].destroy)&&t[r].destroy(i)},_destroy:function(){var t;delete e(n)[0]._switchable;for(t in i)delete i[t]}});if(!i._init())return e(n)[0]._switchable;i._initPlugins()};e.fn.switchable=function(t){var n=e(this),r=n.length,s=[],o;t=e.extend({},e.switchable.Config,t);for(o=0;o<r;o++)s[o]=new i(n.eq(o),t);return s[0]}})(jQuery,window,document),function(e,t,n,r){if(!e.switchable)return;e.extend(e.switchable.Config,{duration:500,easing:"ease"}),e.switchable.Animate=function(t,n,s,o,u){var a=this,f={},l,c;e.switchable.Transition===r&&(e.switchable.Transition=i()),l=e.switchable.Transition,e.extend(a,{isAnimated:!1,run:function(){if(a.isAnimated)return;var r,i=[];for(r in n)i.push(r);if(l)f[l+"Property"]=i.join(", ")||"all",f[l+"Duration"]=s+"ms",f[l+"TimingFunction"]=o,t.css(e.extend(n,f)),c=setTimeout(function(){a._clearCss(),a._complete()},s);else{var u=/cubic-bezier\(([\s\d.,]+)\)/,h=o.match(u),p=e.switchable.TimingFn[o];if(p||h)o=e.switchable.Easing(h?h[1]:p.match(u)[1]);t.animate(n,s,o,function(){a._complete()})}return a.isAnimated=!0,a},stop:function(e){if(!a.isAnimated)return;return l?(clearTimeout(c),c=r,e&&(a._clearCss(),a._complete())):t.stop(!1,e),a.isAnimated=!1,a},_complete:function(){e.isFunction(u)&&u()},_clearCss:function(){f[l+"Property"]="none",t.css(f)}}),a.run()};var i=function(){var e=n.documentElement,t=["Webkit","Moz"],i="transition",s="",o;if(e.style[i]!==r)s=i;else for(o=0;o<2;o++)if(e.style[i=t[o]+"Transition"]!==r){s=i;break}return s}}(jQuery,window,document),function(e,t,n,r){if(!e.switchable)return;var i=function(e){return"cubic-bezier("+e+")"},s=function(e){var t=[],n=101,r;for(r=0;r<=n;r++)t[r]=e.call(null,r/n);return function(e){if(e===1)return t[n];var r=n*e,i=Math.floor(r),s=t[i],o=t[i+1];return s+(o-s)*(r-i)}},o=function(e,t,n,r,i,s){function h(e){return((o*e+u)*e+a)*e}function p(e){return((f*e+l)*e+c)*e}function d(e){return(3*o*e+2*u)*e+a}function v(e){return 1/(200*e)}function m(e,t){return p(g(e,t))}function g(e,t){function a(e){return e>=0?e:0-e}var n,r,i,s,o,u;for(i=e,u=0;u<8;u++){s=h(i)-e;if(a(s)<t)return i;o=d(i);if(a(o)<1e-6)break;i-=s/o}n=0,r=1,i=e;if(i<n)return n;if(i>r)return r;while(n<r){s=h(i);if(a(s-e)<t)return i;e>s?n=i:r=i,i=(r-n)*.5+n}return i}var o,u,a,f,l,c;return o=u=a=f=l=c=0,a=3*t,u=3*(r-t)-a,o=1-a-u,c=3*n,l=3*(i-n)-c,f=1-c-l,m(e,v(s))};e.switchable.TimingFn={ease:i(".25, .1, .25, 1"),linear:i("0, 0, 1, 1"),"ease-in":i(".42, 0, 1, 1"),"ease-out":i("0, 0, .58, 1"),"ease-in-out":i(".42, 0, .58, 1")},e.switchable.Easing=function(n){var r,u,a=0,f;n=n.split(","),u=n.length;for(;a<u;a++)n[a]=parseFloat(n[a]);return u!==4?t.console&&console.warn(i(n.join(", "))+" missing argument."):(r="cubic-bezier-"+n.join("-"),e.easing[r]||(f=s(function(e){return o(e,n[0],n[1],n[2],n[3],5)}),e.easing[r]=function(e){return f.call(null,e)})),r}}(jQuery,window,document),function(e,t,n,r){if(!e.switchable)return;e.switchable.Effects.fade=function(t,n){var i=this,s=i.config,o=i.panels,u=o.slice(t,t+1),a=o.slice(n,n+1),f=function(){a.css({opacity:1})},l=function(){a.css({zIndex:i.length}),u.css({zIndex:1}),i._anim=r};i._anim&&i._anim.stop(!0),f(),i._anim=new e.switchable.Animate(u,{opacity:0},s.duration,s.easing,l)},e.switchable.Plugins.push({name:"fade effect",init:function(e){var t=e.config,n=e.panels,r=e.index,i=n.slice(r,r+1);t.effect.toLowerCase()==="fade"&&(n.css({position:"absolute",top:0,left:0}),n.not(i).css({opacity:0,zIndex:1}),i.css({opacity:1,zIndex:e.length}))},destroy:function(e){e._anim&&e._anim.stop(!0)}})}(jQuery,window,document),function(e,t,n,r){if(!e.switchable)return;var i="position",s="absolute",o="relative";e.extend(e.switchable.Config,{horiz:!0}),e.switchable.Effects.scroll=function(t,n){var i=this,s=i.config,o=i._data,u=t===0&&n===o.max,a=(u||t===o.max&&n===0)&&i._circle,f={},l=function(){f[o.prop]=a?i._adjustPosition(u):-o.size*n},c=function(){a&&i._resetPosition(u),i._anim=r};i._anim&&i._anim.stop(!0),setTimeout(function(){l(),i._anim=new e.switchable.Animate(o.wrap,f,s.duration,s.easing,c)},0)},e.switchable.Plugins.push({name:"scroll effect",init:function(t){var n=t.config,u=t.panels,a=u.eq(0).outerWidth(!0),f=u.eq(0).outerHeight(!0),l={},c=t._data={wrap:u.parent(),max:t.length-1,prop:n.horiz?"left":"top",size:n.horiz?a:f};if(n.effect.toLowerCase()!=="scroll")return;n.loop,t.root.css(i)==="static"&&t.root.css(i,o),l[i]=s,l[c.prop]=-c.size*t.index,c.wrap.css(l).css("width",n.horiz?a*t.length:a),t.isHoriz=n.horiz,e.extend(t,{_adjustPosition:function(e){var n=e?c.max:0;return l[i]=o,l[c.prop]=(e?-1:1)*c.size*t.length,u.slice(n,n+1).css(l),e?c.size:-c.size*t.length},_resetPosition:function(e){var t=e?c.max:0;l[i]="",l[c.prop]="",u.slice(t,t+1).css(l),l[i]=r,l[c.prop]=e?-c.size*c.max:0,c.wrap.css(l)}})},destroy:function(e){e._anim&&e._anim.stop(!0)}})}(jQuery,window,document),function(e,t,n,r){if(!e.switchable)return;e.extend(e.switchable.Config,{autoplay:!1,interval:3e3,pauseOnHover:!0,isBackward:!1}),e.switchable.Plugins.push({name:"autoplay",init:function(t){var n=t.config,i=!1,s,o,u,a=function(){u=t.willTo();if(u===!1){t._cancelTimers();return}u===0&&!n.isBackward||u===t.length-1&&n.isBackward?t._circle=!0:t._circle=!1,t.switchTo(u)},f=function(){var e=n.duration||0;o=setInterval(function(){a()},n.interval+e)},l=function(e,r){if(!n.loop&&n.isBackward&&t.index===0)return;if(!n.loop&&!n.isBackward&&t.index===t.length-1)return;var i=1;n.isBackward&&(i=-1),t._nextIndex=(r+i+t.length)%t.length,t._circle=!1};if(!n.autoplay||t.length<=1)return;l(r,t.index),n.pauseOnHover&&t.panels.on("mouseenter.switchAutoplay",function(){t._pause()}).on("mouseleave.switchAutoplay",function(){i||t._play()}),e(t).on("switch",l),e.extend(t,{_play:function(){t._cancelTimers(),t.paused=!1,s=setTimeout(function(){a(),f()},n.interval)},_pause:function(){t._cancelTimers(),t.paused=!0},_cancelTimers:function(){s&&(clearTimeout(s),s=r),o&&(clearInterval(o),o=r)},play:function(){return t._play(),i=!1,t},pause:function(){return t._pause(),i=!0,t}}),t._play()},destroy:function(e){if(!e.config.autoplay||e.length<=1)return;e._pause(),e.panels.off(".switchAutoplay")}})}(jQuery,window,document),function(e,t,n,r){if(!e.switchable)return;e.extend(e.switchable.Config,{triggers:".trigger a",currentTrigger:"active",triggerType:"hover",delay:100}),e.switchable.Plugins.push({name:"trigger",init:function(t){var n=t.config,i=e(t.root),s,o,u=i.find(n.triggers).length;if(!u)return;while(u<t.length)i.find(n.triggers).slice(0,1).clone().insertAfter(i.find(n.triggers).last()),u=i.find(n.triggers).length;t.triggers=i.find(n.triggers).slice(0,t.length),t.triggers.removeClass(n.currentTrigger).eq(t.index).addClass(n.currentTrigger),t.triggers.on("click.switchTrigger",function(n){n.preventDefault(),s=e(this).index(),t._cancelDelayTimer(),t.switchTo(s)}),n.triggerType==="hover"&&t.triggers.on("mouseenter.switchTrigger",function(){s=e(this).index(),t._delayTimer=setTimeout(function(){t.switchTo(s)},n.delay)}).on("mouseleave.switchTrigger",function(){t._cancelDelayTimer()}),e(t).on("switch",function(e,n){t._switchTrigger(n)}),n.autoplay&&n.pauseOnHover&&t.triggers.on("mouseenter.switchTrigger",function(){o=t.paused,t._pause()}).on("mouseleave.switchTrigger",function(){o||t._play()}),e.extend(t,{_cancelDelayTimer:function(){t._delayTimer&&(clearTimeout(t._delayTimer),t._delayTimer=r)},_switchTrigger:function(e){t.triggers.removeClass(n.currentTrigger).eq(e).addClass(n.currentTrigger)}})},destroy:function(t){e(t.root).find(t.config.triggers).length&&(t.triggers.off("click.switchTrigger"),t.triggers.off(".switchTrigger"))}})}(jQuery,window,document),function(e,t,n,r){if(!e.switchable)return;e.extend(e.switchable.Config,{prev:".prev",next:".next",disabledClass:"disabled",respondinAnimating:!0}),e.switchable.Plugins.push({name:"carousel",init:function(t){var n=t.config,r=["prev","next"],i,s,o=0,u,a,f=function(e,r){if(!n.loop&&r&&e===0)return;if(!n.loop&&!r&&e===t.length-1)return;var i=1;r&&(i=-1),t._nextIndex=(e+i+t.length)%t.length};if(!e(t.root).find(n.prev).length&&!e(t.root).find(n.next).length)return;for(;o<2;o++){i=r[o],s=e(t.root).find(n[i]);if(!s.length)continue;t[i+"Btn"]=s}e(t.root).find(n.prev).on("click.switchCarousel",function(r){r.preventDefault();if(!e(this).hasClass(n.disabledClass)){if(t._anim){if(!n.respondinAnimating)return;t._anim.stop(!0)}f(t.index,!0),u=t.willTo(),u===t.length-1?t._circle=!0:t._circle=!1,t.switchTo(u)}}),e(t.root).find(n.next).on("click.switchCarousel",function(r){r.preventDefault();if(!e(this).hasClass(n.disabledClass)){if(t._anim){if(!n.respondinAnimating)return;t._anim.stop(!0)}f(t.index,!1),u=t.willTo(),u===0?t._circle=!0:t._circle=!1,t.switchTo(u)}}),n.autoplay&&n.pauseOnHover&&e(t.root).find(n.prev+", "+n.next).on("mouseenter.switchCarousel",function(){a=t.paused,t._pause()}).on("mouseleave.switchCarousel",function(){a||t._play()}),e(t).on("switch",function(){t.nextBtn&&(t.nextBtn.removeClass(n.disabledClass),!n.loop&&t.index===t.length-1&&t.nextBtn.addClass(n.disabledClass)),t.prevBtn&&(t.prevBtn.removeClass(n.disabledClass),!n.loop&&t.index===0&&t.prevBtn.addClass(n.disabledClass)),t._circle=!1})},destroy:function(t){e(t.root).find(t.config.prev).length&&e(t.root).find(t.config.prev).off(".switchCarousel"),e(t.root).find(t.config.next).length&&e(t.root).find(t.config.next).off(".switchCarousel")}})}(jQuery,window,document),function(e,t,n,r){if(!e.switchable)return;e.extend(e.switchable.Config,{indexOffset:1,numFormat:"[index]/[length]",switchNum:".switch-num"}),e.switchable.Plugins.push({name:"switchnum",init:function(t){var n=t.config,r=function(e,t){var r=n.numFormat.replace(/\[index\]/ig,"<span>"+(e+n.indexOffset)+"</span>");return r.replace(/\[length\]/ig,t)};if(!n.switchNum&&e(t.root).find(n.switchNum).length)return;e(t.root).find(n.switchNum).html(r(n.initIndex,t.length)),e(t).on("switch",function(){e(t.root).find(n.switchNum).html(r(t.index,t.length))})}})}(jQuery,window,document),function(e,t,n,r){e.extend(e.switchable.Config,{lazyloadCls:"switchlazyload"}),e.switchable.Plugins.push({name:"lazyload",init:function(t){var n=t.config.lazyloadCls,r=function(t){if(t.hasClass(n)){var r=e.trim(t.val());return t.replaceWith(r),!0}return!1};e(t).on("beforeSwitch",function(){e(t.panels).each(function(t,i){r(e(i))||r(e(i).find("."+n))})})}})}(jQuery,window,document),function(e){e(".j-switchable").each(function(t,n){var r=e(n).data("switch")||{},i=e(n).switchable(r);e.extend(n,{switchable:i})})}(jQuery),$.extend(namespace("Wenda.Timer"),function(){function r(e,t,r){var i=e||5,s="__countdown"+n+"__";return o(s,1e3,function(){i==0?(r&&r(),u(s)):(i--,t&&t(i))}),s}function i(e,n,r){t[e]=setTimeout(r,n)}function s(e){clearTimeout(t[e])}function o(e,n,r){t[e]=setInterval(r,n)}function u(e){clearInterval(t[e]),delete t[e]}function a(){var e,t={},n,r,i,s=0,o=!1,u=function(e){return e<=9&&(e="0"+e),e};return t.localize=function(e){var t=e/1e3,n=u(parseInt(t%60,10)),r=u(parseInt(t%3600/60,10)),i=u(parseInt(t%86400/3600,10)),s=i+"\uff1a"+r+"\uff1a"+n;return s},t.go=function(){var e=new Date,n=s-e,u=0;n<=0&&(e<r?(u=1,n=r-e):(u=2,n=e-r));var a=t.localize(n);i&&i(u,a),o&&setTimeout(function(){t.go()},1e3)},t.countdownByData=function(e,n,u){i=u,s=new Date(e),r=new Date(n),o=!0,t.go()},t.stop=function(){o=!1},t}function f(){var e=new Date;return e.setDate(e.getDate()+1),e.setHours(0,0,0,0),e}var e={},t={},n=0;return e.countdown=r,e.create=a,e.delay=i,e.undelay=s,e.loop=o,e.unloop=u,e.midnight=f,e.delayList=t,e}()),function(){function getHeight(e){e=e||document;var t=e.defaultView||e.parentWindow,n=e.compatMode,r=e.documentElement,i=t.innerHeight||0,s=r.scrollHeight,o;return n!="CSS1Compat"&&(r=e.body,s=r.scrollHeight),n&&window.navigator.userAgent.toLowerCase().indexOf("opera")<0&&(i=r.clientHeight),s=Math.max(s,i),o=(document.body==null?0:document.body.offsetHeight)||document.documentElement.offsetHeight,s==i?o:s}function XPC(e){var t={isParent:parent==window,iframeName:"XPC_IFRAME"};this.options=mix(e||{},t,!1),this._initialize()}function Pigeon(e){var t={iframeName:"pigeon-iframe",autoReport:!1,validVersion:!1};this.options=mix(t,e,!0),this.xpc=new XPC(this.options),this._t=0,this._init()}var VERSION="1.0.0",PigeonUtils=PigeonUtils||{},JSON;JSON||(JSON={}),function(){function f(e){return e<10?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return typeof t=="string"?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,r,i,s,o=gap,u,a=t[e];a&&typeof a=="object"&&typeof a.toJSON=="function"&&(a=a.toJSON(e)),typeof rep=="function"&&(a=rep.call(t,e,a));switch(typeof a){case"string":return quote(a);case"number":return isFinite(a)?String(a):"null";case"boolean":case"null":return String(a);case"object":if(!a)return"null";gap+=indent,u=[];if(Object.prototype.toString.apply(a)==="[object Array]"){s=a.length;for(n=0;n<s;n+=1)u[n]=str(n,a)||"null";return i=u.length===0?"[]":gap?"[\n"+gap+u.join(",\n"+gap)+"\n"+o+"]":"["+u.join(",")+"]",gap=o,i}if(rep&&typeof rep=="object"){s=rep.length;for(n=0;n<s;n+=1)typeof rep[n]=="string"&&(r=rep[n],i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i))}else for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i));return i=u.length===0?"{}":gap?"{\n"+gap+u.join(",\n"+gap)+"\n"+o+"}":"{"+u.join(",")+"}",gap=o,i}}"use strict",typeof Date.prototype.toJSON!="function"&&(Date.prototype.toJSON=function(e){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(e){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;typeof JSON.stringify!="function"&&(JSON.stringify=function(e,t,n){var r;gap="",indent="";if(typeof n=="number")for(r=0;r<n;r+=1)indent+=" ";else typeof n=="string"&&(indent=n);rep=t;if(!t||typeof t=="function"||typeof t=="object"&&typeof t.length=="number")return str("",{"":e});throw new Error("JSON.stringify")}),typeof JSON.parse!="function"&&(JSON.parse=function(text,reviver){function walk(e,t){var n,r,i=e[t];if(i&&typeof i=="object")for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r=walk(i,n),r!==undefined?i[n]=r:delete i[n]);return reviver.call(e,t,i)}var j;text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}();var mix=function(e,t,n){n=n||function(t,n,r){return e[r]||r in e?t:n},n===!0&&(n=function(e,t){return t});for(var r in t)e[r]=n(e[r],t[r],r,e,t),e[r]===undefined&&delete e[r];return e},createEvents=function(e){var t={};return mix(e,{on:function(e,n){t[e]=t[e]||[],t[e].push(n)},fire:function(n,r){r=r||{},mix(r,{type:n,target:e,preventDefault:function(){r.returnValue=!1}});var i=t[n]||[];for(var s=0;s<i.length;s++)i[s](r);return r.returnValue!==!1}}),e},addEvent=function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&(e["e"+t+n]=n,e.attachEvent("on"+t,function(){e["e"+t+n].call(e,window.event)}))},usePM=typeof window.postMessage!="undefined";mix(XPC.prototype,{_initialize:function(){function t(t){var n={};try{n=JSON.parse(t)}catch(r){}e.fire("message",n)}var e=this;createEvents(this);if(usePM)addEvent(window,"message",function(e){t(e.data)});else{var n=window.name;setInterval(function(){window.name!=n&&window.name!=""&&(n=window.name,t(n))},50)}},send:function(e){var t=this.options,n=t.win||(t.isParent?window.frames[t.iframeName]:parent);if(!n)throw new Error("XPC","can not find window!");var r={data:e,ts:(+(new Date)).toString(36)};r=JSON.stringify(r),usePM?n.postMessage(r,"*"):n.name=r}},!0);var frameHeight=0;mix(Pigeon.prototype,{_init:function(){var e=this,t=this.options;createEvents(this),this.xpc.on("message",function(n){var r=n.data;if(!r||!r.pigeon)return;(!t.validVersion||r.v==VERSION)&&e.fire(r.type,{data:r.data})}),t.autoReport&&this.reportHeightChange(),this.receive=this.on},report:function(e,t){var n=this.xpc;try{n.send({v:VERSION,type:e||"message",data:t||null,pigeon:!0})}catch(r){}},reportHeight:function(e){var t=this.options;e||(e=getHeight()),e!=frameHeight&&(this.report("heightChange",e),frameHeight=e)},reportHeightChange:function(e){e=typeof e=="undefined"?!0:e;var t=this,n=this._t;e?n=setInterval(function(){t.reportHeight()},50):clearInterval(n)}}),mix(Pigeon,new Pigeon),window.Pigeon=Pigeon,window.PigeonUtils={addEvent:addEvent}}();var SWFUpload;SWFUpload==undefined&&(SWFUpload=function(e){this.initSWFUpload(e)}),SWFUpload.prototype.initSWFUpload=function(e){try{this.customSettings={},this.settings=e,this.eventQueue=[],this.movieName="SWFUpload_"+SWFUpload.movieCount++,this.movieElement=null,SWFUpload.instances[this.movieName]=this,this.initSettings(),this.loadFlash(),this.displayDebugInfo()}catch(t){throw delete SWFUpload.instances[this.movieName],t}},SWFUpload.instances={},SWFUpload.movieCount=0,SWFUpload.version="2.2.0 2009-03-25",SWFUpload.QUEUE_ERROR={QUEUE_LIMIT_EXCEEDED:-100,FILE_EXCEEDS_SIZE_LIMIT:-110,ZERO_BYTE_FILE:-120,INVALID_FILETYPE:-130},SWFUpload.UPLOAD_ERROR={HTTP_ERROR:-200,MISSING_UPLOAD_URL:-210,IO_ERROR:-220,SECURITY_ERROR:-230,UPLOAD_LIMIT_EXCEEDED:-240,UPLOAD_FAILED:-250,SPECIFIED_FILE_ID_NOT_FOUND:-260,FILE_VALIDATION_FAILED:-270,FILE_CANCELLED:-280,UPLOAD_STOPPED:-290},SWFUpload.FILE_STATUS={QUEUED:-1,IN_PROGRESS:-2,ERROR:-3,COMPLETE:-4,CANCELLED:-5},SWFUpload.BUTTON_ACTION={SELECT_FILE:-100,SELECT_FILES:-110,START_UPLOAD:-120},SWFUpload.CURSOR={ARROW:-1,HAND:-2},SWFUpload.WINDOW_MODE={WINDOW:"window",TRANSPARENT:"transparent",OPAQUE:"opaque"},SWFUpload.completeURL=function(e){if(typeof e!="string"||e.match(/^https?:\/\//i)||e.match(/^\//))return e;var t=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""),n=window.location.pathname.lastIndexOf("/");return n<=0?path="/":path=window.location.pathname.substr(0,n)+"/",path+e},SWFUpload.prototype.initSettings=function(){this.ensureDefault=function(e,t){this.settings[e]=this.settings[e]==undefined?t:this.settings[e]},this.ensureDefault("upload_url",""),this.ensureDefault("preserve_relative_urls",!1),this.ensureDefault("file_post_name","Filedata"),this.ensureDefault("post_params",{}),this.ensureDefault("use_query_string",!1),this.ensureDefault("requeue_on_error",!1),this.ensureDefault("http_success",[]),this.ensureDefault("assume_success_timeout",0),this.ensureDefault("file_types","*.*"),this.ensureDefault("file_types_description","All Files"),this.ensureDefault("file_size_limit",0),this.ensureDefault("file_upload_limit",0),this.ensureDefault("file_queue_limit",0),this.ensureDefault("flash_url","swfupload.swf"),this.ensureDefault("prevent_swf_caching",!0),this.ensureDefault("button_image_url",""),this.ensureDefault("button_width",1),this.ensureDefault("button_height",1),this.ensureDefault("button_text",""),this.ensureDefault("button_text_style","color: #000000; font-size: 16pt;"),this.ensureDefault("button_text_top_padding",0),this.ensureDefault("button_text_left_padding",0),this.ensureDefault("button_action",SWFUpload.BUTTON_ACTION.SELECT_FILES),this.ensureDefault("button_disabled",!1),this.ensureDefault("button_placeholder_id",""),this.ensureDefault("button_placeholder",null),this.ensureDefault("button_cursor",SWFUpload.CURSOR.ARROW),this.ensureDefault("button_window_mode",SWFUpload.WINDOW_MODE.WINDOW),this.ensureDefault("debug",!1),this.settings.debug_enabled=this.settings.debug,this.settings.return_upload_start_handler=this.returnUploadStart,this.ensureDefault("swfupload_loaded_handler",null),this.ensureDefault("file_dialog_start_handler",null),this.ensureDefault("file_queued_handler",null),this.ensureDefault("file_queue_error_handler",null),this.ensureDefault("file_dialog_complete_handler",null),this.ensureDefault("upload_start_handler",null),this.ensureDefault("upload_progress_handler",null),this.ensureDefault("upload_error_handler",null),this.ensureDefault("upload_success_handler",null),this.ensureDefault("upload_complete_handler",null),this.ensureDefault("debug_handler",this.debugMessage),this.ensureDefault("custom_settings",{}),this.customSettings=this.settings.custom_settings,!this.settings.prevent_swf_caching||(this.settings.flash_url=this.settings.flash_url+(this.settings.flash_url.indexOf("?")<0?"?":"&")+"preventswfcaching="+(new Date).getTime()),this.settings.preserve_relative_urls||(this.settings.upload_url=SWFUpload.completeURL(this.settings.upload_url),this.settings.button_image_url=SWFUpload.completeURL(this.settings.button_image_url)),delete this.ensureDefault},SWFUpload.prototype.loadFlash=function(){var e,t;if(document.getElementById(this.movieName)!==null)throw"ID "+this.movieName+" is already in use. The Flash Object could not be added";e=document.getElementById(this.settings.button_placeholder_id)||this.settings.button_placeholder;if(e==undefined)throw"Could not find the placeholder element: "+this.settings.button_placeholder_id;t=document.createElement("div"),t.innerHTML=this.getFlashHTML(),e.parentNode.replaceChild(t.firstChild,e),window[this.movieName]==undefined&&(window[this.movieName]=this.getMovieElement())},SWFUpload.prototype.getFlashHTML=function(){var e=this.settings.button_window_mode;return['<object id="',this.movieName,'" type="application/x-shockwave-flash" data="',this.settings.flash_url,'" width="',this.settings.button_width,'" height="',this.settings.button_height,'" class="swfupload">','<param name="wmode" value="',e,'" />','<param name="movie" value="',this.settings.flash_url,'" />','<param name="quality" value="high" />','<param name="menu" value="false" />','<param name="allowScriptAccess" value="always" />','<param name="flashvars" value="'+this.getFlashVars()+'" />',"</object>"].join("")},SWFUpload.prototype.getFlashVars=function(){var e=this.buildParamString(),t=this.settings.http_success.join(",");return["movieName=",encodeURIComponent(this.movieName),"&amp;uploadURL=",encodeURIComponent(this.settings.upload_url),"&amp;useQueryString=",encodeURIComponent(this.settings.use_query_string),"&amp;requeueOnError=",encodeURIComponent(this.settings.requeue_on_error),"&amp;httpSuccess=",encodeURIComponent(t),"&amp;assumeSuccessTimeout=",encodeURIComponent(this.settings.assume_success_timeout),"&amp;params=",encodeURIComponent(e),"&amp;filePostName=",encodeURIComponent(this.settings.file_post_name),"&amp;fileTypes=",encodeURIComponent(this.settings.file_types),"&amp;fileTypesDescription=",encodeURIComponent(this.settings.file_types_description),"&amp;fileSizeLimit=",encodeURIComponent(this.settings.file_size_limit),"&amp;fileUploadLimit=",encodeURIComponent(this.settings.file_upload_limit),"&amp;fileQueueLimit=",encodeURIComponent(this.settings.file_queue_limit),"&amp;debugEnabled=",encodeURIComponent(this.settings.debug_enabled),"&amp;buttonImageURL=",encodeURIComponent(this.settings.button_image_url),"&amp;buttonWidth=",encodeURIComponent(this.settings.button_width),"&amp;buttonHeight=",encodeURIComponent(this.settings.button_height),"&amp;buttonText=",encodeURIComponent(this.settings.button_text),"&amp;buttonTextTopPadding=",encodeURIComponent(this.settings.button_text_top_padding),"&amp;buttonTextLeftPadding=",encodeURIComponent(this.settings.button_text_left_padding),"&amp;buttonTextStyle=",encodeURIComponent(this.settings.button_text_style),"&amp;buttonAction=",encodeURIComponent(this.settings.button_action),"&amp;buttonDisabled=",encodeURIComponent(this.settings.button_disabled),"&amp;buttonCursor=",encodeURIComponent(this.settings.button_cursor)].join("")},SWFUpload.prototype.getMovieElement=function(){this.movieElement==undefined&&(this.movieElement=document.getElementById(this.movieName));if(this.movieElement===null)throw"Could not find Flash element";return this.movieElement},SWFUpload.prototype.buildParamString=function(){var e=this.settings.post_params,t=[];if(typeof e=="object")for(var n in e)e.hasOwnProperty(n)&&t.push(encodeURIComponent(n.toString())+"="+encodeURIComponent(e[n].toString()));return t.join("&amp;")},SWFUpload.prototype.destroy=function(){try{this.cancelUpload(null,!1);var e=null;e=this.getMovieElement();if(e&&typeof e.CallFunction=="unknown"){for(var t in e)try{typeof e[t]=="function"&&(e[t]=null)}catch(n){}try{e.parentNode.removeChild(e)}catch(r){}}return window[this.movieName]=null,SWFUpload.instances[this.movieName]=null,delete SWFUpload.instances[this.movieName],this.movieElement=null,this.settings=null,this.customSettings=null,this.eventQueue=null,this.movieName=null,!0}catch(i){return!1}},SWFUpload.prototype.displayDebugInfo=function(){this.debug(["---SWFUpload Instance Info---\n","Version: ",SWFUpload.version,"\n","Movie Name: ",this.movieName,"\n","Settings:\n","	","upload_url:               ",this.settings.upload_url,"\n","	","flash_url:                ",this.settings.flash_url,"\n","	","use_query_string:         ",this.settings.use_query_string.toString(),"\n","	","requeue_on_error:         ",this.settings.requeue_on_error.toString(),"\n","	","http_success:             ",this.settings.http_success.join(", "),"\n","	","assume_success_timeout:   ",this.settings.assume_success_timeout,"\n","	","file_post_name:           ",this.settings.file_post_name,"\n","	","post_params:              ",this.settings.post_params.toString(),"\n","	","file_types:               ",this.settings.file_types,"\n","	","file_types_description:   ",this.settings.file_types_description,"\n","	","file_size_limit:          ",this.settings.file_size_limit,"\n","	","file_upload_limit:        ",this.settings.file_upload_limit,"\n","	","file_queue_limit:         ",this.settings.file_queue_limit,"\n","	","debug:                    ",this.settings.debug.toString(),"\n","	","prevent_swf_caching:      ",this.settings.prevent_swf_caching.toString(),"\n","	","button_placeholder_id:    ",this.settings.button_placeholder_id.toString(),"\n","	","button_placeholder:       ",this.settings.button_placeholder?"Set":"Not Set","\n","	","button_image_url:         ",this.settings.button_image_url.toString(),"\n","	","button_width:             ",this.settings.button_width.toString(),"\n","	","button_height:            ",this.settings.button_height.toString(),"\n","	","button_text:              ",this.settings.button_text.toString(),"\n","	","button_text_style:        ",this.settings.button_text_style.toString(),"\n","	","button_text_top_padding:  ",this.settings.button_text_top_padding.toString(),"\n","	","button_text_left_padding: ",this.settings.button_text_left_padding.toString(),"\n","	","button_action:            ",this.settings.button_action.toString(),"\n","	","button_disabled:          ",this.settings.button_disabled.toString(),"\n","	","custom_settings:          ",this.settings.custom_settings.toString(),"\n","Event Handlers:\n","	","swfupload_loaded_handler assigned:  ",(typeof this.settings.swfupload_loaded_handler=="function").toString(),"\n","	","file_dialog_start_handler assigned: ",(typeof this.settings.file_dialog_start_handler=="function").toString(),"\n","	","file_queued_handler assigned:       ",(typeof this.settings.file_queued_handler=="function").toString(),"\n","	","file_queue_error_handler assigned:  ",(typeof this.settings.file_queue_error_handler=="function").toString(),"\n","	","upload_start_handler assigned:      ",(typeof this.settings.upload_start_handler=="function").toString(),"\n","	","upload_progress_handler assigned:   ",(typeof this.settings.upload_progress_handler=="function").toString(),"\n","	","upload_error_handler assigned:      ",(typeof this.settings.upload_error_handler=="function").toString(),"\n","	","upload_success_handler assigned:    ",(typeof this.settings.upload_success_handler=="function").toString(),"\n","	","upload_complete_handler assigned:   ",(typeof this.settings.upload_complete_handler=="function").toString(),"\n","	","debug_handler assigned:             ",(typeof this.settings.debug_handler=="function").toString(),"\n"].join(""))},SWFUpload.prototype.addSetting=function(e,t,n){return t==undefined?this.settings[e]=n:this.settings[e]=t},SWFUpload.prototype.getSetting=function(e){return this.settings[e]!=undefined?this.settings[e]:""},SWFUpload.prototype.callFlash=function(functionName,argumentArray){argumentArray=argumentArray||[];var movieElement=this.getMovieElement(),returnValue,returnString;try{returnString=movieElement.CallFunction('<invoke name="'+functionName+'" returntype="javascript">'+__flash__argumentsToXML(argumentArray,0)+"</invoke>"),returnValue=eval(returnString)}catch(ex){throw"Call to "+functionName+" failed"}return returnValue!=undefined&&typeof returnValue.post=="object"&&(returnValue=this.unescapeFilePostParams(returnValue)),returnValue},SWFUpload.prototype.selectFile=function(){this.callFlash("SelectFile")},SWFUpload.prototype.selectFiles=function(){this.callFlash("SelectFiles")},SWFUpload.prototype.startUpload=function(e){this.callFlash("StartUpload",[e])},SWFUpload.prototype.cancelUpload=function(e,t){t!==!1&&(t=!0),this.callFlash("CancelUpload",[e,t])},SWFUpload.prototype.stopUpload=function(){this.callFlash("StopUpload")},SWFUpload.prototype.getStats=function(){return this.callFlash("GetStats")},SWFUpload.prototype.setStats=function(e){this.callFlash("SetStats",[e])},SWFUpload.prototype.getFile=function(e){return typeof e=="number"?this.callFlash("GetFileByIndex",[e]):this.callFlash("GetFile",[e])},SWFUpload.prototype.addFileParam=function(e,t,n){return this.callFlash("AddFileParam",[e,t,n])},SWFUpload.prototype.removeFileParam=function(e,t){this.callFlash("RemoveFileParam",[e,t])},SWFUpload.prototype.setUploadURL=function(e){this.settings.upload_url=e.toString(),this.callFlash("SetUploadURL",[e])},SWFUpload.prototype.setPostParams=function(e){this.settings.post_params=e,this.callFlash("SetPostParams",[e])},SWFUpload.prototype.addPostParam=function(e,t){this.settings.post_params[e]=t,this.callFlash("SetPostParams",[this.settings.post_params])},SWFUpload.prototype.removePostParam=function(e){delete this.settings.post_params[e],this.callFlash("SetPostParams",[this.settings.post_params
])},SWFUpload.prototype.setFileTypes=function(e,t){this.settings.file_types=e,this.settings.file_types_description=t,this.callFlash("SetFileTypes",[e,t])},SWFUpload.prototype.setFileSizeLimit=function(e){this.settings.file_size_limit=e,this.callFlash("SetFileSizeLimit",[e])},SWFUpload.prototype.setFileUploadLimit=function(e){this.settings.file_upload_limit=e,this.callFlash("SetFileUploadLimit",[e])},SWFUpload.prototype.setFileQueueLimit=function(e){this.settings.file_queue_limit=e,this.callFlash("SetFileQueueLimit",[e])},SWFUpload.prototype.setFilePostName=function(e){this.settings.file_post_name=e,this.callFlash("SetFilePostName",[e])},SWFUpload.prototype.setUseQueryString=function(e){this.settings.use_query_string=e,this.callFlash("SetUseQueryString",[e])},SWFUpload.prototype.setRequeueOnError=function(e){this.settings.requeue_on_error=e,this.callFlash("SetRequeueOnError",[e])},SWFUpload.prototype.setHTTPSuccess=function(e){typeof e=="string"&&(e=e.replace(" ","").split(",")),this.settings.http_success=e,this.callFlash("SetHTTPSuccess",[e])},SWFUpload.prototype.setAssumeSuccessTimeout=function(e){this.settings.assume_success_timeout=e,this.callFlash("SetAssumeSuccessTimeout",[e])},SWFUpload.prototype.setDebugEnabled=function(e){this.settings.debug_enabled=e,this.callFlash("SetDebugEnabled",[e])},SWFUpload.prototype.setButtonImageURL=function(e){e==undefined&&(e=""),this.settings.button_image_url=e,this.callFlash("SetButtonImageURL",[e])},SWFUpload.prototype.setButtonDimensions=function(e,t){this.settings.button_width=e,this.settings.button_height=t;var n=this.getMovieElement();n!=undefined&&(n.style.width=e+"px",n.style.height=t+"px"),this.callFlash("SetButtonDimensions",[e,t])},SWFUpload.prototype.setButtonText=function(e){this.settings.button_text=e,this.callFlash("SetButtonText",[e])},SWFUpload.prototype.setButtonTextPadding=function(e,t){this.settings.button_text_top_padding=t,this.settings.button_text_left_padding=e,this.callFlash("SetButtonTextPadding",[e,t])},SWFUpload.prototype.setButtonTextStyle=function(e){this.settings.button_text_style=e,this.callFlash("SetButtonTextStyle",[e])},SWFUpload.prototype.setButtonDisabled=function(e){this.settings.button_disabled=e,this.callFlash("SetButtonDisabled",[e])},SWFUpload.prototype.setButtonAction=function(e){this.settings.button_action=e,this.callFlash("SetButtonAction",[e])},SWFUpload.prototype.setButtonCursor=function(e){this.settings.button_cursor=e,this.callFlash("SetButtonCursor",[e])},SWFUpload.prototype.queueEvent=function(e,t){t==undefined?t=[]:t instanceof Array||(t=[t]);var n=this;if(typeof this.settings[e]=="function")this.eventQueue.push(function(){this.settings[e].apply(this,t)}),setTimeout(function(){n.executeNextEvent()},0);else if(this.settings[e]!==null)throw"Event handler "+e+" is unknown or is not a function"},SWFUpload.prototype.executeNextEvent=function(){var e=this.eventQueue?this.eventQueue.shift():null;typeof e=="function"&&e.apply(this)},SWFUpload.prototype.unescapeFilePostParams=function(e){var t=/[$]([0-9a-f]{4})/i,n={},r;if(e!=undefined){for(var i in e.post)if(e.post.hasOwnProperty(i)){r=i;var s;while((s=t.exec(r))!==null)r=r.replace(s[0],String.fromCharCode(parseInt("0x"+s[1],16)));n[r]=e.post[i]}e.post=n}return e},SWFUpload.prototype.testExternalInterface=function(){try{return this.callFlash("TestExternalInterface")}catch(e){return!1}},SWFUpload.prototype.flashReady=function(){var e=this.getMovieElement();if(!e){this.debug("Flash called back ready but the flash movie can't be found.");return}this.cleanUp(e),this.queueEvent("swfupload_loaded_handler")},SWFUpload.prototype.cleanUp=function(e){window.__flash__removeCallback=function(e,t){try{e&&(e[t]=null)}catch(n){}}},SWFUpload.prototype.fileDialogStart=function(){this.queueEvent("file_dialog_start_handler")},SWFUpload.prototype.fileQueued=function(e){e=this.unescapeFilePostParams(e),this.queueEvent("file_queued_handler",e)},SWFUpload.prototype.fileQueueError=function(e,t,n){e=this.unescapeFilePostParams(e),this.queueEvent("file_queue_error_handler",[e,t,n])},SWFUpload.prototype.fileDialogComplete=function(e,t,n){this.queueEvent("file_dialog_complete_handler",[e,t,n])},SWFUpload.prototype.uploadStart=function(e){e=this.unescapeFilePostParams(e),this.queueEvent("return_upload_start_handler",e)},SWFUpload.prototype.returnUploadStart=function(e){var t;if(typeof this.settings.upload_start_handler=="function")e=this.unescapeFilePostParams(e),t=this.settings.upload_start_handler.call(this,e);else if(this.settings.upload_start_handler!=undefined)throw"upload_start_handler must be a function";t===undefined&&(t=!0),t=!!t,this.callFlash("ReturnUploadStart",[t])},SWFUpload.prototype.uploadProgress=function(e,t,n){e=this.unescapeFilePostParams(e),this.queueEvent("upload_progress_handler",[e,t,n])},SWFUpload.prototype.uploadError=function(e,t,n){e=this.unescapeFilePostParams(e),this.queueEvent("upload_error_handler",[e,t,n])},SWFUpload.prototype.uploadSuccess=function(e,t,n){e=this.unescapeFilePostParams(e),this.queueEvent("upload_success_handler",[e,t,n])},SWFUpload.prototype.uploadComplete=function(e){e=this.unescapeFilePostParams(e),this.queueEvent("upload_complete_handler",e)},SWFUpload.prototype.debug=function(e){this.queueEvent("debug_handler",e)},SWFUpload.prototype.debugMessage=function(e){if(this.settings.debug){var t,n=[];if(typeof e=="object"&&typeof e.name=="string"&&typeof e.message=="string"){for(var r in e)e.hasOwnProperty(r)&&n.push(r+": "+e[r]);t=n.join("\n")||"",n=t.split("\n"),t="EXCEPTION: "+n.join("\nEXCEPTION: "),SWFUpload.Console.writeLine(t)}else SWFUpload.Console.writeLine(e)}},SWFUpload.Console={},SWFUpload.Console.writeLine=function(e){var t,n;try{t=document.getElementById("SWFUpload_Console"),t||(n=document.createElement("form"),document.getElementsByTagName("body")[0].appendChild(n),t=document.createElement("textarea"),t.id="SWFUpload_Console",t.style.fontFamily="monospace",t.setAttribute("wrap","off"),t.wrap="off",t.style.overflow="auto",t.style.width="700px",t.style.height="350px",t.style.margin="5px",n.appendChild(t)),t.value+=e+"\n",t.scrollTop=t.scrollHeight-t.clientHeight}catch(r){alert("Exception: "+r.name+" Message: "+r.message)}},function(){function t(t){this.opts=t,this.filesDone=0,this.filesCount=0,this.filesLength=0,e={MAXCOUNT:"\u4e00\u6b21\u6700\u591a\u4e0a\u4f20"+this.opts.maxfiles+"\u5f20\u56fe\u7247\u3002",MAXSIZE:"\u6587\u4ef6\u592a\u5927\uff0c\u8bf7\u4e0d\u8981\u8d85\u8fc7"+this.opts.maxfilesize+"\u3002",TYPE:"\u6587\u4ef6\u683c\u5f0f\u9519\u8bef\uff0c\u8bf7\u4e0a\u4f20JPG/PNG/GIF\u683c\u5f0f\u56fe\u7247\u3002"}}var e={};t.prototype={bindElement:function(){var e=this,t;this.opts.input.on("change",function(){t=Array.prototype.slice.call(this.files),e.checkfiles(t)})},checkfiles:function(t){var n=[],r="",i=t.length,s=this.opts.maxfilesize,o=this,u=$.type(this.opts.upload_file_type)=="regexp";if(i<1)return;if(i>this.opts.maxfiles)return this.onerror(e.MAXCOUNT);if($.isArray(t))t.forEach(function(i,s){(u?o.opts.upload_file_type.test(i.type):/image\/\w+/.test(i.type))?n.push(i):s==t.length-1?r+=i.name+e.TYPE:r+=i.name+"\uff0c"});else if(u?o.opts.upload_file_type.test(t.type):/image\/\w+/.test(t.type))t.name=t.name||(new Date).getTime()+"."+t.type.substr("image/".length),n.push(t);t=[],n.forEach(function(i,o){i.size<=s?t.push(i):o==n.length-1?r+=i.name+e.MAXSIZE:r+=i.name+"\uff0c"}),r.length>0&&this.onerror(r,"\u6587\u4ef6\u683c\u5f0f\u9519\u8bef");if(t.length<1)return;this.beforeUpload(t)&&this.upload(t)},onerror:function(e,t){return this.opts.onerror(e,t)&&!1},beforeUpload:function(e){return this.opts.beforeUpload(e)&&!0},upload:function(e){var t=this;t.filesLength=e.length,t.filesDone=0,e.forEach(function(e,n){t.analyData(e)})},analyData:function(e){try{var t=this;if(this.opts.uploadType=="BinaryString"){var n=new FormData;n.append(this.opts.paramname,e),this.send(e,n)}else if(this.opts.uploadType=="DataURL"){var r=new FileReader;r.readAsDataURL(e),r.onloadend=function(n){var r=this.opts.paramname+"="+this.result.split(",")[1];t.send(e,r)}}}catch(i){return this.onerror(i)}},send:function(e,t){var n=this,r=new XMLHttpRequest,i=r.upload;e.currentProgress=0,e.startData=0,e.startTime=Date.now(),e.id=+e.lastModifiedDate+parseInt(Math.random()*1e5),i.addEventListener("progress",function(t){n.progress(t,e)},!1),r.open("POST",this.opts.url,!0),this.opts.uploadType=="DataURL"&&r.setRequestHeader("content-type","application/x-www-form-urlencoded"),r.send(t),this.opts.uploadStarted(e),r.onload=function(){r.responseText&&(e.timeDiff=Date.now()-e.startTime,n.opts.uploadFinished(JSON.parse(r.responseText),e),n.filesDone++,n.filesDone==n.filesLength&&n.afterAll())}},progress:function(e,t){if(e.lengthComputable){var n=e.loaded,r=Math.round(n*100/e.total);if(t.currentProgress!=r){t.currentProgress=r;var i=Date.now(),s=i-(t.currentStart?t.currentStart:t.startTime),o=n-t.startData;t.speed=Math.floor(o/s),t.startData=n,t.currentStart=i,this.opts.progressUpdated(t)}}},afterAll:function(){return this.opts.input instanceof jQuery&&this.opts.input.val(""),this.opts.afterAll()}},$.extend({html5Upload:function(e){var n=$.extend(!0,{url:"",input:"",loadImg:"http://p6.qhmsg.com/t01798cd1a6b1065192.gif",paramname:"imgage",maxfiles:5,uploadType:"BinaryString",maxfilesize:5242880,afterAll:function(){},onerror:function(){},beforeUpload:function(){return!0},uploadStarted:function(){},uploadFinished:function(){},progressUpdated:function(){}},e),r=new t(n);return n.input instanceof jQuery&&r.bindElement(),r}})}(),$.extend(namespace("Wenda.UploadImg"),function(){function s(e){window.FormData?u(e):f(e)}function o(e){var t=null;e.handlerOptions.context&&e.handlerOptions.tpl&&(t=new i(e));var r=0,s={input:$("#"+e.html5Input),paramname:e.name,url:e.url,fileTypes:e.options,maxfiles:e.maxfiles,maxfilesize:e.maxfilesize,beforeUpload:function(t){return r=t.length,e.beforeUpload(t)},uploadStarted:function(n){$.isFunction(e.uploadStarted)?e.uploadStarted(n):t&&t.insert(n.id),r>=e.maxfiles&&$.isFunction(e.fileQueueComplete)&&e.fileQueueComplete()},progressUpdated:function(t){$.isFunction(e.progressUpdated)&&e.progressUpdated(t)},uploadFinished:function(n,r){$.isFunction(e.uploadSuccess)?e.uploadSuccess(n,r):t&&t.finish(r.id,n)},onerror:function(t,r){$.isFunction(e.uploadError)?e.uploadError(t,r):n.alert(r||"\u4e0a\u4f20\u5931\u8d25",t)},afterAll:function(t){$.isFunction(e.uploadComplete)&&e.uploadComplete(t)}};return s}function u(e){var e=$.extend(!0,{},r,e);$(e.html5Container).show(),$(e.flashContainer).hide(),$.html5Upload(o(e))}function a(e,t){if(!t)return;var e=$.extend(!0,{},r,e);$.html5Upload(o(e)).checkfiles(t)}function f(e){var e=$.extend(!0,{},r,e),s=null;$(e.html5Container).hide(),$(e.flashContainer).delay(100).show(0),e.handlerOptions.context&&e.handlerOptions.tpl&&(s=new i(e));var o=[],u={button_placeholder_id:e.flashInput,file_post_name:e.name,upload_url:e.url,file_types:e.fileTypes,file_upload_limit:0,file_size_limit:e.maxfilesize,button_width:e.buttonWidth,button_height:e.buttonHeight,file_queued_handler:function(e){o.push(e)},file_dialog_complete_handler:function(t,n){e.beforeUpload(o)?t>0&&t<=e.maxfiles?($.isFunction(e.uploadStarted)?$.each(o,function(t,n){var r=n;e.uploadStarted(r)}):s&&$.each(o,function(e,t){var n=t;s.insert(n.id)}),t==e.maxfiles&&$.isFunction(e.fileQueueComplete)&&e.fileQueueComplete(),this.startUpload()):t>e.maxfiles&&(this.stopUpload(),this.uploadError("","","\u4e00\u6b21\u6700\u591a\u4e0a\u4f20"+e.maxfiles+"\u5f20\u56fe\u7247\u3002")):this.stopUpload(),o=[]},upload_progress_handler:function(t){$.isFunction(e.progressUpdated)&&e.progressUpdated(t)},upload_success_handler:function(n,r){r=t.evalExp(r),$.isFunction(e.uploadSuccess)?e.uploadSuccess(r,n):s&&s.finish(n.id,r)},upload_error_handler:function(t,r,i){if($.isFunction(e.uploadError))e.uploadError(i,"\u4e0a\u4f20\u5931\u8d25");else{var s="";switch(r){case-220:s="\u7f51\u7edc\u8fde\u63a5\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5";break;default:s=i}n.alert("\u4e0a\u4f20\u5931\u8d25",s)}},upload_complete_handler:function(t){this.getStats().files_queued>0?this.startUpload():$.isFunction(e.uploadComplete)&&e.uploadComplete(t)},flash_url:"/resource/swf/swfupload.swf",button_window_mode:SWFUpload.WINDOW_MODE.TRANSPARENT,button_cursor:SWFUpload.CURSOR.HAND,button_text_top_padding:0,button_text_left_padding:18,button_image_url:"http://p3.qhmsg.com/d/inn/e16b8ae4/opacity.png",custom_settings:{},debug:!1};return new SWFUpload(u)}var e={},t=Wenda.Util,n=Wenda.Panel,r={container:$("#js-add-img"),html5Container:".js-add-html5-img",flashContainer:".js-add-flash-img",html5Input:"js-html5-upload",flashInput:"js-flash-upload",name:"picdata",url:"/submit/uploadimg/",fileTypes:"*.jpg;*.png;*.gif;*.jpeg",loadingImg:"http://p6.qhmsg.com/t01798cd1a6b1065192.gif",errorImg:"http://p1.qhmsg.com/t01383134a68d72f138.png",maxfiles:5,maxfilesize:5242880,buttonWidth:50,buttonHeight:20,handlerOptions:{context:null,tpl:"",tplData:{}},beforeUpload:function(e){return!0},uploadStarted:null,fileQueueComplete:null,progressUpdated:null,uploadSuccess:null,uploadError:null,uploadComplete:null},i=function(){function e(e){this.options=e,this.handlerOptions=this.options.handlerOptions}return e.prototype={insert:function(e){var n=this;n.handlerOptions.tplData.id=e,n.handlerOptions.tplData.src=n.options.loadingImg;var r=t.tmpl(n.handlerOptions.tpl,n.handlerOptions.tplData);n.handlerOptions.context.append(r)},finish:function(e,t){var n=this._getLoadingImg(e);if(!n.length)return;t.errno==0?n.attr({src:t.data.url}).data("size",t.data.size):this.failed(e)},failed:function(e){var t=this,n=t._getLoadingImg(e);if(!n.length)return;n.attr({src:t.options.errorImg})},_getLoadingImg:function(e){return this.handlerOptions.context.find("#"+e)}},e}();return e.init=s,e.makeHtml5=u,e.autoLoadImg=a,e.makeFlash=f,e}()),function(){var e="/resource/js/components/umeditor/";window.UMEDITOR_CONFIG={UMEDITOR_HOME_URL:e,imageUrl:e+"php/imageUp.php",imagePath:e+"php/",imageFieldName:"upfile",toolbar:["source | undo redo | bold italic underline strikethrough | superscript subscript | forecolor backcolor | removeformat |","insertorderedlist insertunorderedlist | selectall cleardoc paragraph | fontfamily fontsize","| justifyleft justifycenter justifyright justifyjustify |","link unlink | emotion image video  | map","| horizontal print preview  fullscreen","drafts","formula"],pasteFilterRules:function(){function e(e){e.tagName="p",e.setStyle(),e.setAttr()}function t(e){e.tagName="span",e.setStyle(),e.setAttr()}return{"-":"script style object embed input select img iframe",div:{$:{}},ul:{$:{}},ol:{$:{}},li:{$:{}},p:{$:{}},dl:{$:{}},dt:{$:{}},dd:{$:{}},a:t,h1:e,h2:e,h3:e,h4:e,h5:e,h6:e}}()}}(),UMEDITOR_CONFIG=window.UMEDITOR_CONFIG||{},window.UM={plugins:{},commands:{},I18N:{},version:"1.2.3"};var dom=UM.dom={};UM.I18N["zh-cn"]={labelMap:{anchor:"\u951a\u70b9",undo:"\u64a4\u9500",redo:"\u91cd\u505a",bold:"\u52a0\u7c97",indent:"\u9996\u884c\u7f29\u8fdb",snapscreen:"\u622a\u56fe",italic:"\u659c\u4f53",underline:"\u4e0b\u5212\u7ebf",strikethrough:"\u5220\u9664\u7ebf",subscript:"\u4e0b\u6807",fontborder:"\u5b57\u7b26\u8fb9\u6846",superscript:"\u4e0a\u6807",formatmatch:"\u683c\u5f0f\u5237",source:"\u6e90\u4ee3\u7801",blockquote:"\u5f15\u7528",pasteplain:"\u7eaf\u6587\u672c\u7c98\u8d34\u6a21\u5f0f",selectall:"\u5168\u9009",print:"\u6253\u5370",preview:"\u9884\u89c8",horizontal:"\u5206\u9694\u7ebf",removeformat:"\u6e05\u9664\u683c\u5f0f",time:"\u65f6\u95f4",date:"\u65e5\u671f",unlink:"\u53d6\u6d88\u94fe\u63a5",insertrow:"\u524d\u63d2\u5165\u884c",insertcol:"\u524d\u63d2\u5165\u5217",mergeright:"\u53f3\u5408\u5e76\u5355\u5143\u683c",mergedown:"\u4e0b\u5408\u5e76\u5355\u5143\u683c",deleterow:"\u5220\u9664\u884c",deletecol:"\u5220\u9664\u5217",splittorows:"\u62c6\u5206\u6210\u884c",splittocols:"\u62c6\u5206\u6210\u5217",splittocells:"\u5b8c\u5168\u62c6\u5206\u5355\u5143\u683c",mergecells:"\u5408\u5e76\u591a\u4e2a\u5355\u5143\u683c",deletetable:"\u5220\u9664\u8868\u683c",cleardoc:"\u6e05\u7a7a\u6587\u6863",insertparagraphbeforetable:"\u8868\u683c\u524d\u63d2\u5165\u884c",insertcode:"\u4ee3\u7801\u8bed\u8a00",fontfamily:"\u5b57\u4f53",fontsize:"\u5b57\u53f7",paragraph:"\u6bb5\u843d\u683c\u5f0f",image:"\u4e0a\u4f20\u56fe\u7247",edittable:"\u8868\u683c\u5c5e\u6027",edittd:"\u5355\u5143\u683c\u5c5e\u6027",link:"\u8d85\u94fe\u63a5",emotion:"\u8868\u60c5",spechars:"\u7279\u6b8a\u5b57\u7b26",searchreplace:"\u67e5\u8be2\u66ff\u6362",map:"\u767e\u5ea6\u5730\u56fe",gmap:"Google\u5730\u56fe",video:"\u89c6\u9891",help:"\u5e2e\u52a9",justifyleft:"\u5c45\u5de6\u5bf9\u9f50",justifyright:"\u5c45\u53f3\u5bf9\u9f50",justifycenter:"\u5c45\u4e2d\u5bf9\u9f50",justifyjustify:"\u4e24\u7aef\u5bf9\u9f50",forecolor:"\u5b57\u4f53\u989c\u8272",backcolor:"\u80cc\u666f\u8272",insertorderedlist:"\u6709\u5e8f\u5217\u8868",insertunorderedlist:"\u65e0\u5e8f\u5217\u8868",fullscreen:"\u5168\u5c4f",directionalityltr:"\u4ece\u5de6\u5411\u53f3\u8f93\u5165",directionalityrtl:"\u4ece\u53f3\u5411\u5de6\u8f93\u5165",rowspacingtop:"\u6bb5\u524d\u8ddd",rowspacingbottom:"\u6bb5\u540e\u8ddd",highlightcode:"\u63d2\u5165\u4ee3\u7801",pagebreak:"\u5206\u9875",insertframe:"\u63d2\u5165Iframe",imagenone:"\u9ed8\u8ba4",imageleft:"\u5de6\u6d6e\u52a8",imageright:"\u53f3\u6d6e\u52a8",attachment:"\u9644\u4ef6",imagecenter:"\u5c45\u4e2d",wordimage:"\u56fe\u7247\u8f6c\u5b58",lineheight:"\u884c\u95f4\u8ddd",edittip:"\u7f16\u8f91\u63d0\u793a",customstyle:"\u81ea\u5b9a\u4e49\u6807\u9898",autotypeset:"\u81ea\u52a8\u6392\u7248",webapp:"\u767e\u5ea6\u5e94\u7528",touppercase:"\u5b57\u6bcd\u5927\u5199",tolowercase:"\u5b57\u6bcd\u5c0f\u5199",background:"\u80cc\u666f",template:"\u6a21\u677f",scrawl:"\u6d82\u9e26",music:"\u97f3\u4e50",inserttable:"\u63d2\u5165\u8868\u683c",drafts:"\u8349\u7a3f\u7bb1",formula:"\u6570\u5b66\u516c\u5f0f",settitle:"\u8bbe\u7f6e\u6807\u9898","360map":"360\u5730\u56fe",uploadimg:"\u4e0a\u4f20\u56fe\u7247"},paragraph:{p:"\u6bb5\u843d",h1:"\u6807\u9898 1",h2:"\u6807\u9898 2",h3:"\u6807\u9898 3",h4:"\u6807\u9898 4",h5:"\u6807\u9898 5",h6:"\u6807\u9898 6"},fontfamily:{songti:"\u5b8b\u4f53",kaiti:"\u6977\u4f53",heiti:"\u9ed1\u4f53",lishu:"\u96b6\u4e66",yahei:"\u5fae\u8f6f\u96c5\u9ed1",andaleMono:"andale mono",arial:"arial",arialBlack:"arial black",comicSansMs:"comic sans ms",impact:"impact",timesNewRoman:"times new roman"},ok:"\u786e\u8ba4",cancel:"\u53d6\u6d88",closeDialog:"\u5173\u95ed\u5bf9\u8bdd\u6846",tableDrag:"\u8868\u683c\u62d6\u52a8\u5fc5\u987b\u5f15\u5165uiUtils.js\u6587\u4ef6\uff01",autofloatMsg:"\u5de5\u5177\u680f\u6d6e\u52a8\u4f9d\u8d56\u7f16\u8f91\u5668UI\uff0c\u60a8\u9996\u5148\u9700\u8981\u5f15\u5165UI\u6587\u4ef6!",anthorMsg:"\u94fe\u63a5",clearColor:"\u6e05\u7a7a\u989c\u8272",standardColor:"\u6807\u51c6\u989c\u8272",themeColor:"\u4e3b\u9898\u989c\u8272",property:"\u5c5e\u6027","default":"\u9ed8\u8ba4",modify:"\u4fee\u6539",justifyleft:"\u5de6\u5bf9\u9f50",justifyright:"\u53f3\u5bf9\u9f50",justifycenter:"\u5c45\u4e2d",justify:"\u9ed8\u8ba4",clear:"\u6e05\u9664",anchorMsg:"\u951a\u70b9","delete":"\u5220\u9664",clickToUpload:"\u70b9\u51fb\u4e0a\u4f20",unset:"\u5c1a\u672a\u8bbe\u7f6e\u8bed\u8a00\u6587\u4ef6",t_row:"\u884c",t_col:"\u5217",more:"\u66f4\u591a",pasteOpt:"\u7c98\u8d34\u9009\u9879",pasteSourceFormat:"\u4fdd\u7559\u6e90\u683c\u5f0f",tagFormat:"\u53ea\u4fdd\u7559\u6807\u7b7e",pasteTextFormat:"\u53ea\u4fdd\u7559\u6587\u672c",image:{"static":{lang_tab_local:"\u672c\u5730\u4e0a\u4f20",lang_tab_imgSearch:"\u7f51\u7edc\u56fe\u7247",lang_input_dragTip:"\u652f\u6301\u56fe\u7247\u62d6\u62fd\u4e0a\u4f20",lang_btn_add:"\u6dfb\u52a0"},uploadError:"\u4e0a\u4f20\u51fa\u9519"},emotion:{"static":{lang_input_choice:"\u7cbe\u9009",lang_input_Tuzki:"\u5154\u65af\u57fa",lang_input_BOBO:"BOBO",lang_input_lvdouwa:"\u7eff\u8c46\u86d9",lang_input_babyCat:"baby\u732b",lang_input_bubble:"\u6ce1\u6ce1",lang_input_youa:"\u6709\u554a"}},gmap:{"static":{lang_input_address:"\u5730\u5740",lang_input_search:"\u641c\u7d22",address:{value:"\u5317\u4eac"}},searchError:"\u65e0\u6cd5\u5b9a\u4f4d\u5230\u8be5\u5730\u5740!"},link:{"static":{lang_input_text:"\u6587\u672c\u5185\u5bb9\uff1a",lang_input_url:"\u94fe\u63a5\u5730\u5740\uff1a",lang_input_title:"\u6807\u9898\uff1a",lang_input_target:"\u662f\u5426\u5728\u65b0\u7a97\u53e3\u6253\u5f00\uff1a"},validLink:"\u53ea\u652f\u6301\u9009\u4e2d\u4e00\u4e2a\u94fe\u63a5\u65f6\u751f\u6548",httpPrompt:"\u60a8\u8f93\u5165\u7684\u8d85\u94fe\u63a5\u4e2d\u4e0d\u5305\u542bhttp\u7b49\u534f\u8bae\u540d\u79f0\uff0c\u9ed8\u8ba4\u5c06\u4e3a\u60a8\u6dfb\u52a0http://\u524d\u7f00"},map:{"static":{lang_city:"\u57ce\u5e02",lang_address:"\u5730\u5740",city:{value:"\u5317\u4eac"},lang_search:"\u641c\u7d22",lang_dynamicmap:"\u63d2\u5165\u52a8\u6001\u5730\u56fe"},cityMsg:"\u8bf7\u9009\u62e9\u57ce\u5e02",errorMsg:"\u62b1\u6b49\uff0c\u627e\u4e0d\u5230\u8be5\u4f4d\u7f6e\uff01"},video:{"static":{lang_tab_insertV:"\u63d2\u5165\u89c6\u9891",lang_video_url:"\u89c6\u9891\u7f51\u5740",lang_video_size:"\u89c6\u9891\u5c3a\u5bf8",lang_videoW:"\u5bbd\u5ea6",lang_videoH:"\u9ad8\u5ea6",lang_alignment:"\u5bf9\u9f50\u65b9\u5f0f",videoSearchTxt:{value:"\u8bf7\u8f93\u5165\u641c\u7d22\u5173\u952e\u5b57\uff01"},videoType:{options:["\u5168\u90e8","\u70ed\u95e8","\u5a31\u4e50","\u641e\u7b11","\u4f53\u80b2","\u79d1\u6280","\u7efc\u827a"]},videoSearchBtn:{value:"\u767e\u5ea6\u4e00\u4e0b"},videoSearchReset:{value:"\u6e05\u7a7a\u7ed3\u679c"}},numError:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u6570\u503c\uff0c\u5982123,400",floatLeft:"\u5de6\u6d6e\u52a8",floatRight:"\u53f3\u6d6e\u52a8","default":"\u9ed8\u8ba4",block:"\u72ec\u5360\u4e00\u884c",urlError:"\u8f93\u5165\u7684\u89c6\u9891\u5730\u5740\u6709\u8bef\uff0c\u8bf7\u68c0\u67e5\u540e\u518d\u8bd5\uff01",loading:" &nbsp;\u89c6\u9891\u52a0\u8f7d\u4e2d\uff0c\u8bf7\u7b49\u5f85\u2026\u2026",clickToSelect:"\u70b9\u51fb\u9009\u4e2d",goToSource:"\u8bbf\u95ee\u6e90\u89c6\u9891",noVideo:" &nbsp; &nbsp;\u62b1\u6b49\uff0c\u627e\u4e0d\u5230\u5bf9\u5e94\u7684\u89c6\u9891\uff0c\u8bf7\u91cd\u8bd5\uff01"},formula:{"static":{lang_tab_common:"\u5e38\u7528\u516c\u5f0f",lang_tab_symbol:"\u7b26\u53f7",lang_tab_letter:"\u5b57\u6bcd"}}};var browser=UM.browser=function(){var e=navigator.userAgent.toLowerCase(),t=window.opera,n={ie:/(msie\s|trident.*rv:)([\w.]+)/.test(e),opera:!!t&&t.version,webkit:e.indexOf(" applewebkit/")>-1,mac:e.indexOf("macintosh")>-1,quirks:document.compatMode=="BackCompat"};n.gecko=navigator.product=="Gecko"&&!n.webkit&&!n.opera&&!n.ie;var r=0;if(n.ie){var i=e.match(/(?:msie\s([\w.]+))/),s=e.match(/(?:trident.*rv:([\w.]+))/);i&&s&&i[1]&&s[1]?r=Math.max(i[1]*1,s[1]*1):i&&i[1]?r=i[1]*1:s&&s[1]?r=s[1]*1:r=0,n.ie11Compat=document.documentMode==11,n.ie9Compat=document.documentMode==9,n.ie8=!!document.documentMode,n.ie8Compat=document.documentMode==8,n.ie7Compat=r==7&&!document.documentMode||document.documentMode==7,n.ie6Compat=r<7||n.quirks,n.ie9above=r>8,n.ie9below=r<9}if(n.gecko){var o=e.match(/rv:([\d\.]+)/);o&&(o=o[1].split("."),r=o[0]*1e4+(o[1]||0)*100+(o[2]||0)*1)}return/chrome\/(\d+\.\d)/i.test(e)&&(n.chrome=+RegExp.$1),/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(e)&&!/chrome/i.test(e)&&(n.safari=+(RegExp.$1||RegExp.$2)),n.opera&&(r=parseFloat(t.version())),n.webkit&&(r=parseFloat(e.match(/ applewebkit\/(\d+)/)[1])),n.version=r,n.isCompatible=!n.mobile&&(n.ie&&r>=6||n.gecko&&r>=10801||n.opera&&r>=9.5||n.air&&r>=1||n.webkit&&r>=522||!1),n}(),ie=browser.ie,webkit=browser.webkit,gecko=browser.gecko,opera=browser.opera,utils=UM.utils={each:function(e,t,n){if(e==null)return;if(e.length===+e.length){for(var r=0,i=e.length;r<i;r++)if(t.call(n,e[r],r,e)===!1)return!1}else for(var s in e)if(e.hasOwnProperty(s)&&t.call(n,e[s],s,e)===!1)return!1},makeInstance:function(e){var t=new Function;return t.prototype=e,e=new t,t.prototype=null,e},extend:function(e,t,n){if(t)for(var r in t)if(!n||!e.hasOwnProperty(r))e[r]=t[r];return e},extend2:function(e){var t=arguments;for(var n=1;n<t.length;n++){var r=t[n];for(var i in r)e.hasOwnProperty(i)||(e[i]=r[i])}return e},inherits:function(e,t){var n=e.prototype,r=utils.makeInstance(t.prototype);return utils.extend(r,n,!0),e.prototype=r,r.constructor=e},bind:function(e,t){return function(){return e.apply(t,arguments)}},defer:function(e,t,n){var r;return function(){n&&clearTimeout(r),r=setTimeout(e,t)}},indexOf:function(e,t,n){var r=-1;return n=this.isNumber(n)?n:0,this.each(e,function(e,i){if(i>=n&&e===t)return r=i,!1}),r},removeItem:function(e,t){for(var n=0,r=e.length;n<r;n++)e[n]===t&&(e.splice(n,1),n--)},trim:function(e){return e.replace(/(^[ \t\n\r]+)|([ \t\n\r]+$)/g,"")},listToMap:function(e){if(!e)return{};e=utils.isArray(e)?e:e.split(",");for(var t=0,n,r={};n=e[t++];)r[n.toUpperCase()]=r[n]=1;return r},unhtml:function(e,t){return e?e.replace(t||/[&<">'](?:(amp|lt|quot|gt|#39|nbsp);)?/g,function(e,t){return t?e:{"<":"&lt;","&":"&amp;",'"':"&quot;",">":"&gt;","'":"&#39;"}[e]}):""},html:function(e){return e?e.replace(/&((g|l|quo)t|amp|#39);/g,function(e){return{"&lt;":"<","&amp;":"&","&quot;":'"',"&gt;":">","&#39;":"'"}[e]}):""},cssStyleToDomStyle:function(){var e=document.createElement("div").style,t={"float":e.cssFloat!=undefined?"cssFloat":e.styleFloat!=undefined?"styleFloat":"float"};return function(e){return t[e]||(t[e]=e.toLowerCase().replace(/-./g,function(e){return e.charAt(1).toUpperCase()}))}}(),loadFile:function(){function t(t,n){try{for(var r=0,i;i=e[r++];)if(i.doc===t&&i.url==(n.src||n.href))return i}catch(s){return null}}var e=[];return function(n,r,i){var s=t(n,r);if(s){s.ready?i&&i():s.funs.push(i);return}e.push({doc:n,url:r.src||r.href,funs:[i]});if(!n.body){var o=[];for(var u in r){if(u=="tag")continue;o.push(u+'="'+r[u]+'"')}n.write("<"+r.tag+" "+o.join(" ")+" ></"+r.tag+">");return}if(r.id&&n.getElementById(r.id))return;var a=n.createElement(r.tag);delete r.tag;for(var u in r)a.setAttribute(u,r[u]);a.onload=a.onreadystatechange=function(){if(!this.readyState||/loaded|complete/.test(this.readyState)){s=t(n,r);if(s.funs.length>0){s.ready=1;for(var e;e=s.funs.pop();)e()}a.onload=a.onreadystatechange=null}},a.onerror=function(){throw Error("The load "+(r.href||r.src)+" fails,check the url settings of file umeditor.config.js ")},n.getElementsByTagName("head")[0].appendChild(a)}}(),isEmptyObject:function(e){if(e==null)return!0;if(this.isArray(e)||this.isString(e))return e.length===0;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},fixColor:function(e,t){if(/color/i.test(e)&&/rgba?/.test(t)){var n=t.split(",");if(n.length>3)return"";t="#";for(var r=0,i;i=n[r++];)i=parseInt(i.replace(/[^\d]/gi,""),10).toString(16),t+=i.length==1?"0"+i:i;t=t.toUpperCase()}return t},clone:function(e,t){var n;t=t||{};for(var r in e)e.hasOwnProperty(r)&&(n=e[r],typeof n=="object"?(t[r]=utils.isArray(n)?[]:{},utils.clone(e[r],t[r])):t[r]=n);return t},transUnitToPx:function(e){if(!/(pt|cm)/.test(e))return e;var t;e.replace(/([\d.]+)(\w+)/,function(n,r,i){e=r,t=i});switch(t){case"cm":e=parseFloat(e)*25;break;case"pt":e=Math.round(parseFloat(e)*96/72)}return e+(e?"px":"")},cssRule:browser.ie&&browser.version!=11?function(e,t,n){var r,i;n=n||document,n.indexList?r=n.indexList:r=n.indexList={};var s;if(!r[e]){if(t===undefined)return"";s=n.createStyleSheet("",i=n.styleSheets.length),r[e]=i}else s=n.styleSheets[r[e]];if(t===undefined)return s.cssText;s.cssText=t||""}:function(e,t,n){n=n||document;var r=n.getElementsByTagName("head")[0],i;if(!(i=n.getElementById(e))){if(t===undefined)return"";i=n.createElement("style"),i.id=e,r.appendChild(i)}if(t===undefined)return i.innerHTML;t!==""?i.innerHTML=t:r.removeChild(i)}};utils.each(["String","Function","Array","Number","RegExp","Object"],function(e){UM.utils["is"+e]=function(t){return Object.prototype.toString.apply(t)=="[object "+e+"]"}});var EventBase=UM.EventBase=function(){};EventBase.prototype={addListener:function(e,t){e=utils.trim(e).split(" ");for(var n=0,r;r=e[n++];)getListener(this,r,!0).push(t)},removeListener:function(e,t){e=utils.trim(e).split(" ");for(var n=0,r;r=e[n++];)utils.removeItem(getListener(this,r)||[],t)},fireEvent:function(){var e=arguments[0];e=utils.trim(e).split(" ");for(var t=0,n;n=e[t++];){var r=getListener(this,n),i,s,o;if(r){o=r.length;while(o--){if(!r[o])continue;s=r[o].apply(this,arguments);if(s===!0)return s;s!==undefined&&(i=s)}}if(s=this["on"+n.toLowerCase()])i=s.apply(this,arguments)}return i}};var dtd=dom.dtd=function(){function e(e){for(var t in e)e[t.toUpperCase()]=e[t];return e}var t=utils.extend2,n=e({isindex:1,fieldset:1}),r=e({input:1,button:1,select:1,textarea:1,label:1}),i=t(e({a:1}),r),s=t({iframe:1},i),o=e({hr:1,ul:1,menu:1,div:1,blockquote:1,noscript:1,table:1,center:1,address:1,dir:1,pre:1,h5:1,dl:1,h4:1,noframes:1,h6:1,ol:1,h1:1,h3:1,h2:1}),u=e({ins:1,del:1,script:1,style:1}),a=t(e({b:1,acronym:1,bdo:1,"var":1,"#":1,abbr:1,code:1,br:1,i:1,cite:1,kbd:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,dfn:1,span:1}),u),f=t(e({sub:1,img:1,embed:1,object:1,sup:1,basefont:1,map:1,applet:1,font:1,big:1,small:1}),a),l=t(e({p:1}),f),c=t(e({iframe:1}),f,r),h=e({img:1,embed:1,noscript:1,br:1,kbd:1,center:1,button:1,basefont:1,h5:1,h4:1,samp:1,h6:1,ol:1,h1:1,h3:1,h2:1,form:1,font:1,"#":1,select:1,menu:1,ins:1,abbr:1,label:1,code:1,table:1,script:1,cite:1,input:1,iframe:1,strong:1,textarea:1,noframes:1,big:1,small:1,span:1,hr:1,sub:1,bdo:1,"var":1,div:1,object:1,sup:1,strike:1,dir:1,map:1,dl:1,applet:1,del:1,isindex:1,fieldset:1,ul:1,b:1,acronym:1,a:1,blockquote:1,i:1,u:1,s:1,tt:1,address:1,q:1,pre:1,p:1,em:1,dfn:1}),p=t(e({a:0}),c),d=e({tr:1}),v=e({"#":1}),m=t(e({param:1}),h),g=t(e({form:1}),n,s,o,l),y=e({li:1,ol:1,ul:1}),b=e({style:1,script:1}),w=e({base:1,link:1,meta:1,title:1}),E=t(w,b),S=e({head:1,body:1}),x=e({html:1}),T=e({address:1,blockquote:1,center:1,dir:1,div:1,dl:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,isindex:1,menu:1,noframes:1,ol:1,p:1,pre:1,table:1,ul:1}),N=e({area:1,base:1,basefont:1,br:1,col:1,command:1,dialog:1,embed:1,hr:1,img:1,input:1,isindex:1,keygen:1,link:1,meta:1,param:1,source:1,track:1,wbr:1});return e({$nonBodyContent:t(x,S,w),$block:T,$inline:p,$inlineWithA:t(e({a:1}),p),$body:t(e({script:1,style:1}),T),$cdata:e({script:1,style:1}),$empty:N,$nonChild:e({iframe:1,textarea:1}),$listItem:e({dd:1,dt:1,li:1}),$list:e({ul:1,ol:1,dl:1}),$isNotEmpty:e({table:1,ul:1,ol:1,dl:1,iframe:1,area:1,base:1,col:1,hr:1,img:1,embed:1,input:1,link:1,meta:1,param:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1}),$removeEmpty:e({a:1,abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1}),$removeEmptyBlock:e({p:1,div:1}),$tableContent:e({caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1,table:1}),$notTransContent:e({pre:1,script:1,style:1,textarea:1}),html:S,head:E,style:v,script:v,body:g,base:{},link:{},meta:{},title:v,col:{},tr:e({td:1,th:1}),img:{},embed:{},colgroup:e({thead:1,col:1,tbody:1,tr:1,tfoot:1}),noscript:g,td:g,br:{},th:g,center:g,kbd:p,button:t(l,o),basefont:{},h5:p,h4:p,samp:p,h6:p,ol:y,h1:p,h3:p,option:v,h2:p,form:t(n,s,o,l),select:e({optgroup:1,option:1}),font:p,ins:p,menu:y,abbr:p,label:p,table:e({thead:1,col:1,tbody:1,tr:1,colgroup:1,caption:1,tfoot:1}),code:p,tfoot:d,cite:p,li:g,input:{},iframe:g,strong:p,textarea:v,noframes:g,big:p,small:p,span:e({"#":1,br:1,b:1,strong:1,u:1,i:1,em:1,sub:1,sup:1,strike:1,span:1}),hr:p,dt:p,sub:p,optgroup:e({option:1}),param:{},bdo:p,"var":p,div:g,object:m,sup:p,dd:g,strike:p,area:{},dir:y,map:t(e({area:1,form:1,p:1}),n,u,o),applet:m,dl:e({dt:1,dd:1}),del:p,isindex:{},fieldset:t(e({legend:1}),h),thead:d,ul:y,acronym:p,b:p,a:t(e({a:1}),c),blockquote:t(e({td:1,tr:1,tbody:1,li:1}),g),caption:p,i:p,u:p,tbody:d,s:p,address:t(s,l),tt:p,legend:p,q:p,pre:t(a,i),p:t(e({a:1}),p),em:p,dfn:p})}(),attrFix=ie&&browser.version<9?{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder"}:{tabindex:"tabIndex",readonly:"readOnly"},styleBlock=utils.listToMap(["-webkit-box","-moz-box","block","list-item","table","table-row-group","table-header-group","table-footer-group","table-row","table-column-group","table-column","table-cell","table-caption"]),domUtils=dom.domUtils={NODE_ELEMENT:1,NODE_DOCUMENT:9,NODE_TEXT:3,NODE_COMMENT:8,NODE_DOCUMENT_FRAGMENT:11,POSITION_IDENTICAL:0,POSITION_DISCONNECTED:1,POSITION_FOLLOWING:2,POSITION_PRECEDING:4,POSITION_IS_CONTAINED:8,POSITION_CONTAINS:16,fillChar:ie&&browser.version=="6"?"\ufeff":"\u200b",keys:{8:1,46:1,16:1,17:1,18:1,37:1,38:1,39:1,40:1,13:1},breakParent:function(e,t){var n,r=e,i=e,s,o;do{r=r.parentNode,s?(n=r.cloneNode(!1
),n.appendChild(s),s=n,n=r.cloneNode(!1),n.appendChild(o),o=n):(s=r.cloneNode(!1),o=s.cloneNode(!1));while(n=i.previousSibling)s.insertBefore(n,s.firstChild);while(n=i.nextSibling)o.appendChild(n);i=r}while(t!==r);return n=t.parentNode,n.insertBefore(s,t),n.insertBefore(o,t),n.insertBefore(e,o),domUtils.remove(t),e},trimWhiteTextNode:function(e){function t(t){var n;while((n=e[t])&&n.nodeType==3&&domUtils.isWhitespace(n))e.removeChild(n)}t("firstChild"),t("lastChild")},getPosition:function(e,t){if(e===t)return 0;var n,r=[e],i=[t];n=e;while(n=n.parentNode){if(n===t)return 10;r.push(n)}n=t;while(n=n.parentNode){if(n===e)return 20;i.push(n)}r.reverse(),i.reverse();if(r[0]!==i[0])return 1;var s=-1;while(s++,r[s]===i[s]);e=r[s],t=i[s];while(e=e.nextSibling)if(e===t)return 4;return 2},getNodeIndex:function(e,t){var n=e,r=0;while(n=n.previousSibling){if(t&&n.nodeType==3){n.nodeType!=n.nextSibling.nodeType&&r++;continue}r++}return r},inDoc:function(e,t){return domUtils.getPosition(e,t)==10},findParent:function(e,t,n){if(e&&!domUtils.isBody(e)){e=n?e:e.parentNode;while(e){if(!t||t(e)||domUtils.isBody(e))return t&&!t(e)&&domUtils.isBody(e)?null:e;e=e.parentNode}}return null},findParentByTagName:function(e,t,n,r){return t=utils.listToMap(utils.isArray(t)?t:[t]),domUtils.findParent(e,function(e){return t[e.tagName]&&(!r||!r(e))},n)},findParents:function(e,t,n,r){var i=t&&(n&&n(e)||!n)?[e]:[];while(e=domUtils.findParent(e,n))i.push(e);return r?i:i.reverse()},insertAfter:function(e,t){return e.parentNode.insertBefore(t,e.nextSibling)},remove:function(e,t){var n=e.parentNode,r;if(n){if(t&&e.hasChildNodes())while(r=e.firstChild)n.insertBefore(r,e);n.removeChild(e)}return e},getNextDomNode:function(e,t,n,r){return getDomNode(e,"firstChild","nextSibling",t,n,r)},getPreDomNode:function(e,t,n,r){return getDomNode(e,"lastChild","previousSibling",t,n,r)},isBookmarkNode:function(e){return e.nodeType==1&&e.id&&/^_baidu_bookmark_/i.test(e.id)},getWindow:function(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow},getCommonAncestor:function(e,t){if(e===t)return e;var n=[e],r=[t],i=e,s=-1;while(i=i.parentNode){if(i===t)return i;n.push(i)}i=t;while(i=i.parentNode){if(i===e)return i;r.push(i)}n.reverse(),r.reverse();while(s++,n[s]===r[s]);return s==0?null:n[s-1]},clearEmptySibling:function(e,t,n){function r(e,t){var n;while(e&&!domUtils.isBookmarkNode(e)&&(domUtils.isEmptyInlineElement(e)||!(new RegExp("[^	\n\r"+domUtils.fillChar+"]")).test(e.nodeValue)))n=e[t],domUtils.remove(e),e=n}!t&&r(e.nextSibling,"nextSibling"),!n&&r(e.previousSibling,"previousSibling")},split:function(e,t){var n=e.ownerDocument;if(browser.ie&&t==e.nodeValue.length){var r=n.createTextNode("");return domUtils.insertAfter(e,r)}var i=e.splitText(t);if(browser.ie8){var s=n.createTextNode("");domUtils.insertAfter(i,s),domUtils.remove(s)}return i},isWhitespace:function(e){return!(new RegExp("[^ 	\n\r"+domUtils.fillChar+"]")).test(e.nodeValue)},getXY:function(e){var t=0,n=0;while(e.offsetParent)n+=e.offsetTop,t+=e.offsetLeft,e=e.offsetParent;return{x:t,y:n}},isEmptyInlineElement:function(e){if(e.nodeType!=1||!dtd.$removeEmpty[e.tagName])return 0;e=e.firstChild;while(e){if(domUtils.isBookmarkNode(e))return 0;if(e.nodeType==1&&!domUtils.isEmptyInlineElement(e)||e.nodeType==3&&!domUtils.isWhitespace(e))return 0;e=e.nextSibling}return 1},isBlockElm:function(e){return e.nodeType==1&&(dtd.$block[e.tagName]||styleBlock[domUtils.getComputedStyle(e,"display")])&&!dtd.$nonChild[e.tagName]},getElementsByTagName:function(e,t,n){if(n&&utils.isString(n)){var r=n;n=function(e){var t=!1;return $.each(utils.trim(r).replace(/[ ]{2,}/g," ").split(" "),function(n,r){if($(e).hasClass(r))return t=!0,!1}),t}}t=utils.trim(t).replace(/[ ]{2,}/g," ").split(" ");var i=[];for(var s=0,o;o=t[s++];){var u=e.getElementsByTagName(o);for(var a=0,f;f=u[a++];)(!n||n(f))&&i.push(f)}return i},unSelectable:ie&&browser.ie9below||browser.opera?function(e){e.onselectstart=function(){return!1},e.onclick=e.onkeyup=e.onkeydown=function(){return!1},e.unselectable="on",e.setAttribute("unselectable","on");for(var t=0,n;n=e.all[t++];)switch(n.tagName.toLowerCase()){case"iframe":case"textarea":case"input":case"select":break;default:n.unselectable="on",e.setAttribute("unselectable","on")}}:function(e){e.style.MozUserSelect=e.style.webkitUserSelect=e.style.msUserSelect=e.style.KhtmlUserSelect="none"},removeAttributes:function(e,t){t=utils.isArray(t)?t:utils.trim(t).replace(/[ ]{2,}/g," ").split(" ");for(var n=0,r;r=t[n++];){r=attrFix[r]||r;switch(r){case"className":e[r]="";break;case"style":e.style.cssText="";var i=e.getAttributeNode("style");!browser.ie&&i&&e.removeAttributeNode(i)}e.removeAttribute(r)}},createElement:function(e,t,n){return domUtils.setAttributes(e.createElement(t),n)},setAttributes:function(e,t){for(var n in t)if(t.hasOwnProperty(n)){var r=t[n];switch(n){case"class":e.className=r;break;case"style":e.style.cssText=e.style.cssText+";"+r;break;case"innerHTML":e[n]=r;break;case"value":e.value=r;break;default:e.setAttribute(attrFix[n]||n,r)}}return e},getComputedStyle:function(e,t){return utils.transUnitToPx(utils.fixColor(t,$(e).css(t)))},preventDefault:function(e){e.preventDefault?e.preventDefault():e.returnValue=!1},removeStyle:function(e,t){browser.ie?(t=="color"&&(t="(^|;)"+t),e.style.cssText=e.style.cssText.replace(new RegExp(t+"[^:]*:[^;]+;?","ig"),"")):e.style.removeProperty?e.style.removeProperty(t):e.style.removeAttribute(utils.cssStyleToDomStyle(t)),e.style.cssText||domUtils.removeAttributes(e,["style"])},getStyle:function(e,t){var n=e.style[utils.cssStyleToDomStyle(t)];return utils.fixColor(t,n)},setStyle:function(e,t,n){e.style[utils.cssStyleToDomStyle(t)]=n,utils.trim(e.style.cssText)||this.removeAttributes(e,"style")},removeDirtyAttr:function(e){for(var t=0,n,r=e.getElementsByTagName("*");n=r[t++];)n.removeAttribute("_moz_dirty");e.removeAttribute("_moz_dirty")},getChildCount:function(e,t){var n=0,r=e.firstChild;t=t||function(){return 1};while(r)t(r)&&n++,r=r.nextSibling;return n},isEmptyNode:function(e){return!e.firstChild||domUtils.getChildCount(e,function(e){return!domUtils.isBr(e)&&!domUtils.isBookmarkNode(e)&&!domUtils.isWhitespace(e)})==0},isBr:function(e){return e.nodeType==1&&e.tagName=="BR"},isFillChar:function(e,t){return e.nodeType==3&&!e.nodeValue.replace(new RegExp((t?"^":"")+domUtils.fillChar),"").length},isEmptyBlock:function(e,t){if(e.nodeType!=1)return 0;t=t||new RegExp("[ 	\r\n"+domUtils.fillChar+"]","g");if(e[browser.ie?"innerText":"textContent"].replace(t,"").length>0)return 0;for(var n in dtd.$isNotEmpty)if(e.getElementsByTagName(n).length)return 0;return 1},isCustomeNode:function(e){return e.nodeType==1&&e.getAttribute("_ue_custom_node_")},fillNode:function(e,t){var n=browser.ie?e.createTextNode(domUtils.fillChar):e.createElement("br");t.innerHTML="",t.appendChild(n)},isBoundaryNode:function(e,t){var n;while(!domUtils.isBody(e)){n=e,e=e.parentNode;if(n!==e[t])return!1}return!0},isFillChar:function(e,t){return e.nodeType==3&&!e.nodeValue.replace(new RegExp((t?"^":"")+domUtils.fillChar),"").length},isBody:function(e){return $(e).hasClass("edui-body-container")}},fillCharReg=new RegExp(domUtils.fillChar,"g");(function(){function r(e){e.collapsed=e.startContainer&&e.endContainer&&e.startContainer===e.endContainer&&e.startOffset==e.endOffset}function i(e){return!e.collapsed&&e.startContainer.nodeType==1&&e.startContainer===e.endContainer&&e.endOffset-e.startOffset==1}function s(e,t,n,i){return t.nodeType==1&&(dtd.$empty[t.tagName]||dtd.$nonChild[t.tagName])&&(n=domUtils.getNodeIndex(t)+(e?0:1),t=t.parentNode),e?(i.startContainer=t,i.startOffset=n,i.endContainer||i.collapse(!0)):(i.endContainer=t,i.endOffset=n,i.startContainer||i.collapse(!1)),r(i),i}function u(e,t){try{if(n&&domUtils.inDoc(n,e))if(!n.nodeValue.replace(fillCharReg,"").length){var r=n.parentNode;domUtils.remove(n);while(r&&domUtils.isEmptyInlineElement(r)&&(browser.safari?!(domUtils.getPosition(r,t)&domUtils.POSITION_CONTAINS):!r.contains(t)))n=r.parentNode,domUtils.remove(r),r=n}else n.nodeValue=n.nodeValue.replace(fillCharReg,"")}catch(i){}}function a(e,t){var n;e=e[t];while(e&&domUtils.isFillChar(e))n=e[t],domUtils.remove(e),e=n}function f(e,t){var n=e.startContainer,r=e.endContainer,i=e.startOffset,s=e.endOffset,o=e.document,u=o.createDocumentFragment(),a,f;n.nodeType==1&&(n=n.childNodes[i]||(a=n.appendChild(o.createTextNode("")))),r.nodeType==1&&(r=r.childNodes[s]||(f=r.appendChild(o.createTextNode(""))));if(n===r&&n.nodeType==3)return u.appendChild(o.createTextNode(n.substringData(i,s-i))),t&&(n.deleteData(i,s-i),e.collapse(!0)),u;var l,c,h=u,p=domUtils.findParents(n,!0),d=domUtils.findParents(r,!0);for(var v=0;p[v]==d[v];)v++;for(var m=v,g;g=p[m];m++){l=g.nextSibling,g==n?a||(e.startContainer.nodeType==3?(h.appendChild(o.createTextNode(n.nodeValue.slice(i))),t&&n.deleteData(i,n.nodeValue.length-i)):h.appendChild(t?n:n.cloneNode(!0))):(c=g.cloneNode(!1),h.appendChild(c));while(l){if(l===r||l===d[m])break;g=l.nextSibling,h.appendChild(t?l:l.cloneNode(!0)),l=g}h=c}h=u,p[v]||(h.appendChild(p[v-1].cloneNode(!1)),h=h.firstChild);for(var m=v,y;y=d[m];m++){l=y.previousSibling,y==r?!f&&e.endContainer.nodeType==3&&(h.appendChild(o.createTextNode(r.substringData(0,s))),t&&r.deleteData(0,s)):(c=y.cloneNode(!1),h.appendChild(c));if(m!=v||!p[v])while(l){if(l===n)break;y=l.previousSibling,h.insertBefore(t?l:l.cloneNode(!0),h.firstChild),l=y}h=c}return t&&e.setStartBefore(d[v]?p[v]?d[v]:p[v-1]:d[v-1]).collapse(!0),a&&domUtils.remove(a),f&&domUtils.remove(f),u}var e=0,t=domUtils.fillChar,n,o=dom.Range=function(e,t){var n=this;n.startContainer=n.startOffset=n.endContainer=n.endOffset=null,n.document=e,n.collapsed=!0,n.body=t};o.prototype={deleteContents:function(){var e;return this.collapsed||f(this,1),browser.webkit&&(e=this.startContainer,e.nodeType==3&&!e.nodeValue.length&&(this.setStartBefore(e).collapse(!0),domUtils.remove(e))),this},inFillChar:function(){var e=this.startContainer;return this.collapsed&&e.nodeType==3&&e.nodeValue.replace(new RegExp("^"+domUtils.fillChar),"").length+1==e.nodeValue.length?!0:!1},setStart:function(e,t){return s(!0,e,t,this)},setEnd:function(e,t){return s(!1,e,t,this)},setStartAfter:function(e){return this.setStart(e.parentNode,domUtils.getNodeIndex(e)+1)},setStartBefore:function(e){return this.setStart(e.parentNode,domUtils.getNodeIndex(e))},setEndAfter:function(e){return this.setEnd(e.parentNode,domUtils.getNodeIndex(e)+1)},setEndBefore:function(e){return this.setEnd(e.parentNode,domUtils.getNodeIndex(e))},setStartAtFirst:function(e){return this.setStart(e,0)},setStartAtLast:function(e){return this.setStart(e,e.nodeType==3?e.nodeValue.length:e.childNodes.length)},setEndAtFirst:function(e){return this.setEnd(e,0)},setEndAtLast:function(e){return this.setEnd(e,e.nodeType==3?e.nodeValue.length:e.childNodes.length)},selectNode:function(e){return this.setStartBefore(e).setEndAfter(e)},selectNodeContents:function(e){return this.setStart(e,0).setEndAtLast(e)},cloneRange:function(){var e=this;return(new o(e.document)).setStart(e.startContainer,e.startOffset).setEnd(e.endContainer,e.endOffset)},collapse:function(e){var t=this;return e?(t.endContainer=t.startContainer,t.endOffset=t.startOffset):(t.startContainer=t.endContainer,t.startOffset=t.endOffset),t.collapsed=!0,t},shrinkBoundary:function(e){function i(e){return e.nodeType==1&&!domUtils.isBookmarkNode(e)&&!dtd.$empty[e.tagName]&&!dtd.$nonChild[e.tagName]}var t=this,n,r=t.collapsed;while(t.startContainer.nodeType==1&&(n=t.startContainer.childNodes[t.startOffset])&&i(n))t.setStart(n,0);if(r)return t.collapse(!0);if(!e)while(t.endContainer.nodeType==1&&t.endOffset>0&&(n=t.endContainer.childNodes[t.endOffset-1])&&i(n))t.setEnd(n,n.childNodes.length);return t},trimBoundary:function(e){this.txtToElmBoundary();var t=this.startContainer,n=this.startOffset,r=this.collapsed,i=this.endContainer;if(t.nodeType==3){if(n==0)this.setStartBefore(t);else if(n>=t.nodeValue.length)this.setStartAfter(t);else{var s=domUtils.split(t,n);t===i?this.setEnd(s,this.endOffset-n):t.parentNode===i&&(this.endOffset+=1),this.setStartBefore(s)}if(r)return this.collapse(!0)}return e||(n=this.endOffset,i=this.endContainer,i.nodeType==3&&(n==0?this.setEndBefore(i):(n<i.nodeValue.length&&domUtils.split(i,n),this.setEndAfter(i)))),this},txtToElmBoundary:function(e){function t(e,t){var n=e[t+"Container"],r=e[t+"Offset"];n.nodeType==3&&(r?r>=n.nodeValue.length&&e["set"+t.replace(/(\w)/,function(e){return e.toUpperCase()})+"After"](n):e["set"+t.replace(/(\w)/,function(e){return e.toUpperCase()})+"Before"](n))}if(e||!this.collapsed)t(this,"start"),t(this,"end");return this},insertNode:function(e){var t=e,n=1;e.nodeType==11&&(t=e.firstChild,n=e.childNodes.length),this.trimBoundary(!0);var r=this.startContainer,i=this.startOffset,s=r.childNodes[i];return s?r.insertBefore(e,s):r.appendChild(e),t.parentNode===this.endContainer&&(this.endOffset=this.endOffset+n),this.setStartBefore(t)},setCursor:function(e,t){return this.collapse(!e).select(t)},createBookmark:function(t,n){var r,i=this.document.createElement("span");return i.style.cssText="display:none;line-height:0px;",i.appendChild(this.document.createTextNode("\u200d")),i.id="_baidu_bookmark_start_"+(n?"":e++),this.collapsed||(r=i.cloneNode(!0),r.id="_baidu_bookmark_end_"+(n?"":e++)),this.insertNode(i),r&&this.collapse().insertNode(r).setEndBefore(r),this.setStartAfter(i),{start:t?i.id:i,end:r?t?r.id:r:null,id:t}},moveToBookmark:function(e){var t=e.id?this.document.getElementById(e.start):e.start,n=e.end&&e.id?this.document.getElementById(e.end):e.end;return this.setStartBefore(t),domUtils.remove(t),n?(this.setEndBefore(n),domUtils.remove(n)):this.collapse(!0),this},adjustmentBoundary:function(){if(!this.collapsed){while(!domUtils.isBody(this.startContainer)&&this.startOffset==this.startContainer[this.startContainer.nodeType==3?"nodeValue":"childNodes"].length&&this.startContainer[this.startContainer.nodeType==3?"nodeValue":"childNodes"].length)this.setStartAfter(this.startContainer);while(!domUtils.isBody(this.endContainer)&&!this.endOffset&&this.endContainer[this.endContainer.nodeType==3?"nodeValue":"childNodes"].length)this.setEndBefore(this.endContainer)}return this},getClosedNode:function(){var e;if(!this.collapsed){var t=this.cloneRange().adjustmentBoundary().shrinkBoundary();if(i(t)){var n=t.startContainer.childNodes[t.startOffset];n&&n.nodeType==1&&(dtd.$empty[n.tagName]||dtd.$nonChild[n.tagName])&&(e=n)}}return e},select:browser.ie?function(e,r){var i;this.collapsed||this.shrinkBoundary();var s=this.getClosedNode();if(s&&!r){try{i=this.document.body.createControlRange(),i.addElement(s),i.select()}catch(o){}return this}var f=this.createBookmark(),l=f.start,c;i=this.document.body.createTextRange(),i.moveToElementText(l),i.moveStart("character",1);if(!this.collapsed){var h=this.document.body.createTextRange();c=f.end,h.moveToElementText(c),i.setEndPoint("EndToEnd",h)}else if(!e&&this.startContainer.nodeType!=3){var p=this.document.createTextNode(t),d=this.document.createElement("span");d.appendChild(this.document.createTextNode(t)),l.parentNode.insertBefore(d,l),l.parentNode.insertBefore(p,l),u(this.document,p),n=p,a(d,"previousSibling"),a(l,"nextSibling"),i.moveStart("character",-1),i.collapse(!0)}this.moveToBookmark(f),d&&domUtils.remove(d);try{i.select()}catch(o){}return this}:function(e){function r(e){function t(t,n,r){t.nodeType==3&&t.nodeValue.length<n&&(e[r+"Offset"]=t.nodeValue.length)}t(e.startContainer,e.startOffset,"start"),t(e.endContainer,e.endOffset,"end")}var i=domUtils.getWindow(this.document),s=i.getSelection(),o;browser.gecko?this.body.focus():i.focus();if(s){s.removeAllRanges();if(this.collapsed&&!e){var f=this.startContainer,l=f;f.nodeType==1&&(l=f.childNodes[this.startOffset]),(f.nodeType!=3||!this.startOffset)&&(l?!l.previousSibling||l.previousSibling.nodeType!=3:!f.lastChild||f.lastChild.nodeType!=3)&&(o=this.document.createTextNode(t),this.insertNode(o),u(this.document,o),a(o,"previousSibling"),a(o,"nextSibling"),n=o,this.setStart(o,browser.webkit?1:0).collapse(!0))}var c=this.document.createRange();if(this.collapsed&&browser.opera&&this.startContainer.nodeType==1){var l=this.startContainer.childNodes[this.startOffset];if(!l)l=this.startContainer.lastChild,l&&domUtils.isBr(l)&&this.setStartBefore(l).collapse(!0);else{while(l&&domUtils.isBlockElm(l)){if(l.nodeType!=1||!l.childNodes[0])break;l=l.childNodes[0]}l&&this.setStartBefore(l).collapse(!0)}}r(this),c.setStart(this.startContainer,this.startOffset),c.setEnd(this.endContainer,this.endOffset),s.addRange(c)}return this},createAddress:function(e,t){function i(e){var n=e?r.startContainer:r.endContainer,i=domUtils.findParents(n,!0,function(e){return!domUtils.isBody(e)}),s=[];for(var o=0,u;u=i[o++];)s.push(domUtils.getNodeIndex(u,t));var a=0;if(t)if(n.nodeType==3){var f=n.previousSibling;while(f&&f.nodeType==3)a+=f.nodeValue.replace(fillCharReg,"").length,f=f.previousSibling;a+=e?r.startOffset:r.endOffset}else{n=n.childNodes[e?r.startOffset:r.endOffset];if(n)a=domUtils.getNodeIndex(n,t);else{n=e?r.startContainer:r.endContainer;var l=n.firstChild;while(l){if(domUtils.isFillChar(l)){l=l.nextSibling;continue}a++;if(l.nodeType==3)while(l&&l.nodeType==3)l=l.nextSibling;else l=l.nextSibling}}}else a=e?domUtils.isFillChar(n)?0:r.startOffset:r.endOffset;return a<0&&(a=0),s.push(a),s}var n={},r=this;return n.startAddress=i(!0),e||(n.endAddress=r.collapsed?[].concat(n.startAddress):i()),n},moveToAddress:function(e,t){function r(e,t){var r=n.body,i,s;for(var o=0,u,a=e.length;o<a;o++){u=e[o],i=r,r=r.childNodes[u];if(!r){s=u;break}}t?r?n.setStartBefore(r):n.setStart(i,s):r?n.setEndBefore(r):n.setEnd(i,s)}var n=this;return r(e.startAddress,!0),!t&&e.endAddress&&r(e.endAddress),n},equals:function(e){for(var t in this)if(this.hasOwnProperty(t)&&this[t]!==e[t])return!1;return!0},scrollIntoView:function(){var e=$('<span style="padding:0;margin:0;display:block;border:0">&nbsp;</span>');this.cloneRange().insertNode(e.get(0));var t=$(window).scrollTop(),n=$(window).height(),r=e.offset().top;if(r<t-n||r>t+n)r>t+n?window.scrollTo(0,r-n+e.height()):window.scrollTo(0,t-r);e.remove()},getOffset:function(){var e=this.createBookmark(),t=$(e.start).css("display","inline-block").offset();return this.moveToBookmark(e),t}}})(),function(){function e(e,t){var n=domUtils.getNodeIndex;e=e.duplicate(),e.collapse(t);var r=e.parentElement();if(!r.hasChildNodes())return{container:r,offset:0};var i=r.children,s,o=e.duplicate(),u=0,a=i.length-1,f=-1,l;while(u<=a){f=Math.floor((u+a)/2),s=i[f],o.moveToElementText(s);var c=o.compareEndPoints("StartToStart",e);if(c>0)a=f-1;else{if(!(c<0))return{container:r,offset:n(s)};u=f+1}}if(f==-1){o.moveToElementText(r),o.setEndPoint("StartToStart",e),l=o.text.replace(/(\r\n|\r)/g,"\n").length,i=r.childNodes;if(!l)return s=i[i.length-1],{container:s,offset:s.nodeValue.length};var h=i.length;while(l>0)l-=i[--h].nodeValue.length;return{container:i[h],offset:-l}}o.collapse(c>0),o.setEndPoint(c>0?"StartToStart":"EndToStart",e),l=o.text.replace(/(\r\n|\r)/g,"\n").length;if(!l)return dtd.$empty[s.tagName]||dtd.$nonChild[s.tagName]?{container:r,offset:n(s)+(c>0?0:1)}:{container:s,offset:c>0?0:s.childNodes.length};while(l>0)try{var p=s;s=s[c>0?"previousSibling":"nextSibling"],l-=s.nodeValue.length}catch(d){return{container:r,offset:n(p)}}return{container:s,offset:c>0?-l:s.nodeValue.length+l}}function t(t,n){if(t.item)n.selectNode(t.item(0));else{var r=e(t,!0);n.setStart(r.container,r.offset),t.compareEndPoints("StartToEnd",t)!=0&&(r=e(t,!1),n.setEnd(r.container,r.offset))}return n}function n(e,t){var n;try{n=e.getNative(t).createRange()}catch(r){return null}var i=n.item?n.item(0):n.parentElement();return(i.ownerDocument||i)===e.document?n:null}var r=dom.Selection=function(e,t){var r=this;r.document=e,r.body=t,browser.ie9below&&$(t).on("beforedeactivate",function(){r._bakIERange=r.getIERange()}).on("activate",function(){try{var e=n(r);(!e||!r.rangeInBody(e))&&r._bakIERange&&r._bakIERange.select()}catch(t){}r._bakIERange=null})};r.prototype={hasNativeRange:function(){var e;if(!browser.ie||browser.ie9above){var t=this.getNative();if(!t.rangeCount)return!1;e=t.getRangeAt(0)}else e=n(this);return e&&this.rangeInBody(e)},getNative:function(e){var t=this.document;try{return t?browser.ie9below||e?t.selection:domUtils.getWindow(t).getSelection():null}catch(n){return null}},getIERange:function(e){var t=n(this,e);if(!t||!this.rangeInBody(t,e))if(this._bakIERange)return this._bakIERange;return t},rangeInBody:function(e,t){var n=browser.ie9below||t?e&&e.item?e.item():e.parentElement():e.startContainer;return n===this.body||domUtils.inDoc(n,this.body)},cache:function(){this.clear(),this._cachedRange=this.getRange(),this._cachedStartElement=this.getStart(),this._cachedStartElementPath=this.getStartElementPath()},getStartElementPath:function(){if(this._cachedStartElementPath)return this._cachedStartElementPath;var e=this.getStart();return e?domUtils.findParents(e,!0,null,!0):[]},clear:function(){this._cachedStartElementPath=this._cachedRange=this._cachedStartElement=null},isFocus:function(){return this.hasNativeRange()},getRange:function(){function n(t){var n=e.body.firstChild,r=t.collapsed;while(n&&n.firstChild)t.setStart(n,0),n=n.firstChild;t.startContainer||t.setStart(e.body,0),r&&t.collapse(!0)}var e=this;if(e._cachedRange!=null)return this._cachedRange;var r=new dom.Range(e.document,e.body);if(browser.ie9below){var i=e.getIERange();if(i&&this.rangeInBody(i))try{t(i,r)}catch(s){n(r)}else n(r)}else{var o=e.getNative();if(o&&o.rangeCount&&e.rangeInBody(o.getRangeAt(0))){var u=o.getRangeAt(0),a=o.getRangeAt(o.rangeCount-1);r.setStart(u.startContainer,u.startOffset).setEnd(a.endContainer,a.endOffset),r.collapsed&&domUtils.isBody(r.startContainer)&&!r.startOffset&&n(r)}else{if(this._bakRange&&(this._bakRange.startContainer===this.body||domUtils.inDoc(this._bakRange.startContainer,this.body)))return this._bakRange;n(r)}}return this._bakRange=r},getStart:function(){if(this._cachedStartElement)return this._cachedStartElement;var e=browser.ie9below?this.getIERange():this.getRange(),t,n,r,i;if(browser.ie9below){if(!e)return this.document.body.firstChild;if(e.item)return e.item(0);t=e.duplicate(),t.text.length>0&&t.moveStart("character",1),t.collapse(1),n=t.parentElement(),i=r=e.parentElement();while(r=r.parentNode)if(r==n){n=i;break}}else{n=e.startContainer,n.nodeType==1&&n.hasChildNodes()&&(n=n.childNodes[Math.min(n.childNodes.length-1,e.startOffset)]);if(n.nodeType==3)return n.parentNode}return n},getText:function(){var e,t;return this.isFocus()&&(e=this.getNative())?(t=browser.ie9below?e.createRange():e.getRangeAt(0),browser.ie9below?t.text:t.toString()):""}}}(),function(){function n(e,t){var n;if(t.textarea)if(utils.isString(t.textarea)){for(var r=0,i,s=domUtils.getElementsByTagName(e,"textarea");i=s[r++];)if(i.id=="umeditor_textarea_"+t.options.textarea){n=i;break}}else n=t.textarea;n||(e.appendChild(n=domUtils.createElement(document,"textarea",{name:t.options.textarea,id:"umeditor_textarea_"+t.options.textarea,style:"display:none"})),t.textarea=n),n.value=t.hasContents()?t.options.allHtmlEnabled?t.getAllHtml():t.getContent(null,null,!0):""}function r(e){for(var t in UM.plugins)e.options.excludePlugins.indexOf(t)==-1&&(UM.plugins[t].call(e),e.plugins[t]=1);e.langIsReady=!0,e.fireEvent("langReady")}function i(e){for(var t in e)return t}var e=0,t,s=UM.Editor=function(t){var n=this;n.uid=e++,EventBase.call(n),n.commands={},n.options=utils.extend(utils.clone(t||{}),UMEDITOR_CONFIG,!0),n.shortcutkeys={},n.inputRules=[],n.outputRules=[],n.setOpt({isShow:!0,initialContent:"",initialStyle:"",autoClearinitialContent:!1,textarea:"editorValue",focus:!1,focusInEnd:!0,autoClearEmptyNode:!0,fullscreen:!1,readonly:!1,zIndex:999,enterTag:"p",lang:"zh-cn",langPath:n.options.UMEDITOR_HOME_URL+"lang/",theme:"default",themePath:n.options.UMEDITOR_HOME_URL+"themes/",allHtmlEnabled:!1,autoSyncData:!0,autoHeightEnabled:!0,excludePlugins:""}),n.plugins={},utils.isEmptyObject(UM.I18N)?r(n):(n.options.lang=i(UM.I18N),r(n))};s.prototype={ready:function(e){var t=this;e&&(t.isReady?e.apply(t):t.addListener("ready",e))},setOpt:function(e,t){var n={};utils.isString(e)?n[e]=t:n=e,utils.extend(this.options,n,!0)},getOpt:function(e){return this.options[e]||""},destroy:function(){var e=this;e.fireEvent("destroy");var t=e.container.parentNode;t===document.body&&(t=e.container);var n=e.textarea;n?n.style.display="":(n=document.createElement("textarea"),t.parentNode.insertBefore(n,t)),n.style.width=e.body.offsetWidth+"px",n.style.height=e.body.offsetHeight+"px",n.value=e.getContent(),n.id=e.key,t.contains(n)&&$(n).insertBefore(t),t.innerHTML="",domUtils.remove(t),UM.clearCache(e.id);for(var r in e)e.hasOwnProperty(r)&&delete this[r]},initialCont:function(e){if(e){e.getAttribute("name")&&(this.options.textarea=e.getAttribute("name"));if(e&&/script|textarea/ig.test(e.tagName)){var t=document.createElement("div");e.parentNode.insertBefore(t,e),this.options.initialContent=UM.htmlparser(e.value||e.innerHTML||this.options.initialContent).toHtml(),e.className&&(t.className=e.className),e.style.cssText&&(t.style.cssText=e.style.cssText),/textarea/i.test(e.tagName)?(this.textarea=e,this.textarea.style.display="none"):(e.parentNode.removeChild(e),e.id&&(t.id=e.id)),e=t,e.innerHTML=""}return e}return null},render:function(e){var t=this,n=t.options,r=function(t){return parseInt($(e).css(t))};utils.isString(e)&&(e=document.getElementById(e));if(e){this.id=e.getAttribute("id"),UM.setEditor(this),utils.cssRule("edui-style-body",t.options.initialStyle,document),e=this.initialCont(e),e.className+=" edui-body-container",n.initialFrameWidth?n.minFrameWidth=n.initialFrameWidth:n.minFrameWidth=n.initialFrameWidth=$(e).width()||UM.defaultWidth,n.initialFrameHeight?n.minFrameHeight=n.initialFrameHeight:n.initialFrameHeight=n.minFrameHeight=$(e).height()||UM.defaultHeight,e.style.width=/%$/.test(n.initialFrameWidth)?"100%":n.initialFrameWidth-r("padding-left")-r("padding-right")+"px";var i=/%$/.test(n.initialFrameHeight)?"100%":n.initialFrameHeight-r("padding-top")-r("padding-bottom");this.options.autoHeightEnabled?(e.style.minHeight=i+"px",e.style.height="",browser.ie&&browser.version<=6&&(e.style.height=i,e.style.setExpression("height","this.scrollHeight <= "+i+' ? "'+i+'px" : "auto"'))):$(e).height(i),e.style.zIndex=n.zIndex,this._setup(e)}},_setup:function(e){var t=this,r=t.options;e.contentEditable=!0,document.body.spellcheck=!1,t.document=document,t.window=document.defaultView||document.parentWindow,t.body=e,t.$body=$(e),t.selection=new dom.Selection(document,t.body),t._isEnabled=!1;var i;browser.gecko&&(i=this.selection.getNative())&&i.removeAllRanges(),this._initEvents();for(var s=e.parentNode;s&&!domUtils.isBody(s);s=s.parentNode)if(s.tagName=="FORM"){t.form=s,t.options.autoSyncData?$(e).on("blur",function(){n(s,t)}):$(s).on("submit",function(){n(this,t)});break}if(r.initialContent)if(r.autoClearinitialContent){var o=t.execCommand;t.execCommand=function(){return t.fireEvent("firstBeforeExecCommand"),o.apply(t,arguments)},this._setDefaultContent(r.initialContent)}else this.setContent(r.initialContent,!1,!0);domUtils.isEmptyNode(t.body)&&(t.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>"),r.focus&&setTimeout(function(){t.focus(t.options.focusInEnd),!t.options.autoClearinitialContent&&t._selectionChange()},0),t.container||(t.container=e.parentNode),t._bindshortcutKeys(),t.isReady=1,t.fireEvent("ready"),r.onready&&r.onready.call(t),(!browser.ie||browser.ie9above)&&$(t.body).on("blur focus",function(e){var n=t.selection.getNative();if(e.type=="blur")n.rangeCount>0&&(t._bakRange=n.getRangeAt(0));else{try{setTimeout(function(){t._bakRange&&n.addRange(t._bakRange)},50)}catch(e){}t._bakRange=null}}),!r.isShow&&t.setHide(),r.readonly&&t.setDisabled()},sync:function(e){var t=this,r=e?document.getElementById(e):domUtils.findParent(t.body.parentNode,function(e){return e.tagName=="FORM"},!0);r&&n(r,t)},setHeight:function(e,t){!t&&(this.options.initialFrameHeight=e),this.options.autoHeightEnabled?($(this.body).css({"min-height":e+"px"}),browser.ie&&browser.version<=6&&this.container&&(this.container.style.height=e,this.container.style.setExpression("height","this.scrollHeight <= "+e+' ? "'+e+'px" : "auto"'))):$(this.body).height(e),this.fireEvent("resize")},setWidth:function(e){this.$container&&this.$container.width(e),$(this.body).width(e-$(this.body).css("padding-left").replace("px","")*1-$(this.body).css("padding-right").replace("px","")*1),this.fireEvent("resize")},addshortcutkey:function(e,t){var n={};t?n[e]=t:n=e,utils.extend(this.shortcutkeys,n)},_bindshortcutKeys:function(){var e=this,t=this.shortcutkeys;e.addListener("keydown",function(n,r){var i=r.keyCode||r.which;for(var s in t){var o=t[s].split(",");for(var u=0,a;a=o[u++];){a=a.split(":");var f=a[0],l=a[1];if(/^(ctrl)(\+shift)?\+(\d+)$/.test(f.toLowerCase())||/^(\d+)$/.test(f))if((RegExp.$1=="ctrl"?r.ctrlKey||r.metaKey:0)&&(RegExp.$2!=""?r[RegExp.$2.slice(1)+"Key"]:1)&&i==RegExp.$3||i==RegExp.$1)e.queryCommandState(s,l)!=-1&&e.execCommand(s,l),domUtils.preventDefault(r)}}})},getContent:function(e,t,n,r,i){var s=this;e&&utils.isFunction(e)&&(t=e,e="");if(t?!t():!this.hasContents())return"";s.fireEvent("beforegetcontent");var o=UM.htmlparser(s.body.innerHTML,r);return s.filterOutputRule(o),s.fireEvent("aftergetcontent",o),o.toHtml(i)},getAllHtml:function(){var e=this,t=[],n="";e.fireEvent("getAllHtml",t);if(browser.ie&&browser.version>8){var r="";utils.each(e.document.styleSheets,function(e){r+=e.href?'<link rel="stylesheet" type="text/css" href="'+e.href+'" />':"<style>"+e.cssText+"</style>"}),utils.each(e.document.getElementsByTagName("script"),function(e){r+=e.outerHTML})}return"<html><head>"+(e.options.charset?'<meta http-equiv="Content-Type" content="text/html; charset='+e.options.charset+'"/>':"")+(r||e.document.getElementsByTagName("head")[0].innerHTML)+t.join("\n")+"</head>"+"<body "+(ie&&browser.version<9?'class="view"':"")+">"+e.getContent(null,null,!0)+"</body></html>"},getPlainTxt:function(){var e=new RegExp(domUtils.fillChar,"g"),t=this.body.innerHTML.replace(/[\n\r]/g,"");return t=t.replace(/<(p|div)[^>]*>(<br\/?>|&nbsp;)<\/\1>/gi,"\n").replace(/<br\/?>/gi,"\n").replace(/<[^>/]+>/g,"").replace(/(\n)?<\/([^>]+)>/g,function(e,t,n){return dtd.$block[n]?"\n":t?t:""}),t.replace(e,"").replace(/\u00a0/g," ").replace(/&nbsp;/g," ")},getContentTxt:function(){var e=new RegExp(domUtils.fillChar,"g");return this.body[browser.ie?"innerText":"textContent"].replace(e,"").replace(/\u00a0/g," ")},setContent:function(e,t,r){function o(e){return e.tagName=="DIV"&&e.getAttribute("cdata_tag")}var i=this;i.fireEvent("beforesetcontent",e);var s=UM.htmlparser(e);i.filterInputRule(s),e=s.toHtml(),i.body.innerHTML=(t?i.body.innerHTML:"")+e;if(i.options.enterTag=="p"){var u=this.body.firstChild,a;if(!u||u.nodeType==1&&(dtd.$cdata[u.tagName]||o(u)||domUtils.isCustomeNode(u))&&u===this.body.lastChild)this.body.innerHTML="<p>"+(browser.ie?"&nbsp;":"<br/>")+"</p>"+this.body.innerHTML;else{var f=i.document.createElement("p");while(u){while(u&&(u.nodeType==3||u.nodeType==1&&dtd.p[u.tagName]&&!dtd.$cdata[u.tagName]))a=u.nextSibling,f.appendChild(u),u=a;if(f.firstChild){if(!u){i.body.appendChild(f);break}u.parentNode.insertBefore(f,u),f=i.document.createElement("p")}u=u.nextSibling}}}i.fireEvent("aftersetcontent"),i.fireEvent("contentchange"),!r&&i._selectionChange(),i._bakRange=i._bakIERange=i._bakNativeRange=null;var l;browser.gecko&&(l=this.selection.getNative())&&l.removeAllRanges(),i.options.autoSyncData&&i.form&&n(i.form,i)},focus:function(e){try{var t=this,n=t.selection.getRange();e?n.setStartAtLast(t.body.lastChild).setCursor(!1,!0):n.select(!0),this.fireEvent("focus")}catch(r){}},blur:function(){var e=this.selection.getNative();e.empty?e.empty():e.removeAllRanges(),this.fireEvent("blur")},isFocus:function(){return this.fireEvent("isfocus")===!0?!0:this.selection.isFocus()},_initEvents:function(){var e=this,t=e.body,n=function(){e._proxyDomEvent.apply(e,arguments)};$(t).on("click contextmenu mousedown keydown keyup keypress mouseup mouseover mouseout selectstart",n).on("focus blur",n).on("mouseup keydown",function(t){if(t.type=="keydown"&&(t.ctrlKey||t.metaKey||t.shiftKey||t.altKey))return;if(t.button==2)return;e._selectionChange(250,t)})},_proxyDomEvent:function(e){return this.fireEvent(e.type.replace(/^on/,""),e)},_selectionChange:function(e,n){var r=this,i=!1,s,o;if(browser.ie&&browser.version<9&&n&&n.type=="mouseup"){var u=this.selection.getRange();u.collapsed||(i=!0,s=n.clientX,o=n.clientY)}clearTimeout(t),t=setTimeout(function(){if(!r.selection.getNative())return;var e;if(i&&r.selection.getNative().type=="None"
){e=r.document.body.createTextRange();try{e.moveToPoint(s,o)}catch(t){e=null}}var u;e&&(u=r.selection.getIERange,r.selection.getIERange=function(){return e}),r.selection.cache(),u&&(r.selection.getIERange=u),r.selection._cachedRange&&r.selection._cachedStartElement&&(r.fireEvent("beforeselectionchange"),r.fireEvent("selectionchange",!!n),r.fireEvent("afterselectionchange"),r.selection.clear())},e||50)},_callCmdFn:function(e,t){t=Array.prototype.slice.call(t,0);var n=t.shift().toLowerCase(),r,i;r=this.commands[n]||UM.commands[n],i=r&&r[e];if((!r||!i)&&e=="queryCommandState")return 0;if(i)return i.apply(this,[n].concat(t))},execCommand:function(e){if(!this.isFocus()){var t=this.selection._bakRange;t?t.select():this.focus()}e=e.toLowerCase();var n=this,r,i=n.commands[e]||UM.commands[e];return!i||!i.execCommand?null:(!i.notNeedUndo&&!n.__hasEnterExecCommand?(n.__hasEnterExecCommand=!0,n.queryCommandState.apply(n,arguments)!=-1&&(n.fireEvent("saveScene"),n.fireEvent("beforeexeccommand",e),r=this._callCmdFn("execCommand",arguments),!i.ignoreContentChange&&!n._ignoreContentChange&&n.fireEvent("contentchange"),n.fireEvent("afterexeccommand",e),n.fireEvent("saveScene")),n.__hasEnterExecCommand=!1):(r=this._callCmdFn("execCommand",arguments),!n.__hasEnterExecCommand&&!i.ignoreContentChange&&!n._ignoreContentChange&&n.fireEvent("contentchange")),!n.__hasEnterExecCommand&&!i.ignoreContentChange&&!n._ignoreContentChange&&n._selectionChange(),r)},queryCommandState:function(e){try{return this._callCmdFn("queryCommandState",arguments)}catch(t){return 0}},queryCommandValue:function(e){try{return this._callCmdFn("queryCommandValue",arguments)}catch(t){return null}},hasContents:function(e){if(e)for(var t=0,n;n=e[t++];)if(this.body.getElementsByTagName(n).length>0)return!0;if(!domUtils.isEmptyBlock(this.body))return!0;e=["div"];for(t=0;n=e[t++];){var r=domUtils.getElementsByTagName(this.body,n);for(var i=0,s;s=r[i++];)if(domUtils.isCustomeNode(s))return!0}return!1},reset:function(){this.fireEvent("reset")},isEnabled:function(){return this._isEnabled!=1},setEnabled:function(){var e=this,t;e.body.contentEditable=!0;if(e.lastBk){t=e.selection.getRange();try{t.moveToBookmark(e.lastBk),delete e.lastBk}catch(n){t.setStartAtFirst(e.body).collapse(!0)}t.select(!0)}e.bkqueryCommandState&&(e.queryCommandState=e.bkqueryCommandState,delete e.bkqueryCommandState),e._bkproxyDomEvent&&(e._proxyDomEvent=e._bkproxyDomEvent,delete e._bkproxyDomEvent),e.fireEvent("setEnabled")},enable:function(){return this.setEnabled()},setDisabled:function(e,t){var n=this;n.body.contentEditable=!1,n._except=e?utils.isArray(e)?e:[e]:[],n.lastBk||(n.lastBk=n.selection.getRange().createBookmark(!0)),n.bkqueryCommandState||(n.bkqueryCommandState=n.queryCommandState,n.queryCommandState=function(e){return utils.indexOf(n._except,e)!=-1?n.bkqueryCommandState.apply(n,arguments):-1}),!t&&!n._bkproxyDomEvent&&(n._bkproxyDomEvent=n._proxyDomEvent,n._proxyDomEvent=function(){}),n.fireEvent("selectionchange"),n.fireEvent("setDisabled",n._except)},disable:function(e){return this.setDisabled(e)},_setDefaultContent:function(){function e(){var t=this;t.document.getElementById("initContent")&&(t.body.innerHTML="<p>"+(ie?"":"<br/>")+"</p>",t.removeListener("firstBeforeExecCommand focus",e),setTimeout(function(){t.focus(),t._selectionChange()},0))}return function(t){var n=this;n.body.innerHTML='<p id="initContent">'+t+"</p>",n.addListener("firstBeforeExecCommand focus",e)}}(),setShow:function(){var e=this,t=e.selection.getRange();if(e.container.style.display=="none"){try{t.moveToBookmark(e.lastBk),delete e.lastBk}catch(n){t.setStartAtFirst(e.body).collapse(!0)}setTimeout(function(){t.select(!0)},100),e.container.style.display=""}},show:function(){return this.setShow()},setHide:function(){var e=this;e.lastBk||(e.lastBk=e.selection.getRange().createBookmark(!0)),e.container.style.display="none"},hide:function(){return this.setHide()},getLang:function(e){var t=UM.I18N[this.options.lang];if(!t)throw Error("not import language file");e=(e||"").split(".");for(var n=0,r;r=e[n++];){t=t[r];if(!t)break}return t},getContentLength:function(e,t){var n=this.getContent(!1,!1,!0).length;if(e){t=(t||[]).concat(["hr","img","iframe"]),n=this.getContentTxt().replace(/[\t\r\n]+/g,"").length;for(var r=0,i;i=t[r++];)n+=this.body.getElementsByTagName(i).length}return n},addInputRule:function(e,t){e.ignoreUndo=t,this.inputRules.push(e)},filterInputRule:function(e,t){for(var n=0,r;r=this.inputRules[n++];){if(t&&r.ignoreUndo)continue;r.call(this,e)}},addOutputRule:function(e,t){e.ignoreUndo=t,this.outputRules.push(e)},filterOutputRule:function(e,t){for(var n=0,r;r=this.outputRules[n++];){if(t&&r.ignoreUndo)continue;r.call(this,e)}}},utils.inherits(s,EventBase)}();var filterWord=UM.filterWord=function(){function e(e){return/(class="?Mso|style="[^"]*\bmso\-|w:WordDocument|<(v|o):|lang=)/ig.test(e)}function t(e){return e=e.replace(/[\d.]+\w+/g,function(e){return utils.transUnitToPx(e)}),e}function n(e){return e.replace(/[\t\r\n]+/g," ").replace(/<!--[\s\S]*?-->/ig,"").replace(/<v:shape [^>]*>[\s\S]*?.<\/v:shape>/gi,function(e){if(browser.opera)return"";try{if(/Bitmap/i.test(e))return"";var n=e.match(/width:([ \d.]*p[tx])/i)[1],r=e.match(/height:([ \d.]*p[tx])/i)[1],i=e.match(/src=\s*"([^"]*)"/i)[1];return'<img width="'+t(n)+'" height="'+t(r)+'" src="'+i+'" />'}catch(s){return""}}).replace(/<\/?div[^>]*>/g,"").replace(/v:\w+=(["']?)[^'"]+\1/g,"").replace(/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|xml|meta|link|style|\w+:\w+)(?=[\s\/>]))[^>]*>/gi,"").replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1</strong></p>").replace(/\s+(class|lang|align)\s*=\s*(['"]?)([\w-]+)\2/ig,function(e,t,n,r){return t=="class"&&r=="MsoListParagraph"?e:""}).replace(/<(font|span)[^>]*>(\s*)<\/\1>/gi,function(e,t,n){return n.replace(/[\t\r\n ]+/g," ")}).replace(/(<[a-z][^>]*)\sstyle=(["'])([^\2]*?)\2/gi,function(e,n,r,i){var s=[],o=i.replace(/^\s+|\s+$/,"").replace(/&#39;/g,"'").replace(/&quot;/gi,"'").split(/;\s*/g);for(var u=0,a;a=o[u];u++){var f,l,c=a.split(":");if(c.length==2){f=c[0].toLowerCase(),l=c[1].toLowerCase();if(/^(background)\w*/.test(f)&&l.replace(/(initial|\s)/g,"").length==0||/^(margin)\w*/.test(f)&&/^0\w+$/.test(l))continue;switch(f){case"mso-padding-alt":case"mso-padding-top-alt":case"mso-padding-right-alt":case"mso-padding-bottom-alt":case"mso-padding-left-alt":case"mso-margin-alt":case"mso-margin-top-alt":case"mso-margin-right-alt":case"mso-margin-bottom-alt":case"mso-margin-left-alt":case"mso-height":case"mso-width":case"mso-vertical-align-alt":/<table/.test(n)||(s[u]=f.replace(/^mso-|-alt$/g,"")+":"+t(l));continue;case"horiz-align":s[u]="text-align:"+l;continue;case"vert-align":s[u]="vertical-align:"+l;continue;case"font-color":case"mso-foreground":s[u]="color:"+l;continue;case"mso-background":case"mso-highlight":s[u]="background:"+l;continue;case"mso-default-height":s[u]="min-height:"+t(l);continue;case"mso-default-width":s[u]="min-width:"+t(l);continue;case"mso-padding-between-alt":s[u]="border-collapse:separate;border-spacing:"+t(l);continue;case"text-line-through":if(l=="single"||l=="double")s[u]="text-decoration:line-through";continue;case"mso-zero-height":l=="yes"&&(s[u]="display:none");continue;case"margin":if(!/[1-9]/.test(l))continue}if(/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?:decor|trans)|top-bar|version|vnd|word-break)/.test(f)||/text\-indent|padding|margin/.test(f)&&/\-[\d.]+/.test(l))continue;s[u]=f+":"+c[1]}}return n+(s.length?' style="'+s.join(";").replace(/;{2,}/g,";")+'"':"")}).replace(/[\d.]+(cm|pt)/g,function(e){return utils.transUnitToPx(e)})}return function(t){return e(t)?n(t):t}}();(function(){function s(e,t,n){return e.push(i),t+(n?1:-1)}function o(e,t){for(var n=0;n<t;n++)e.push(r)}function u(e,t,n,r){switch(e.type){case"root":for(var i=0,c;c=e.children[i++];)n&&c.type=="element"&&!dtd.$inlineWithA[c.tagName]&&i>1&&(s(t,r,!0),o(t,r)),u(c,t,n,r);break;case"text":a(e,t);break;case"element":f(e,t,n,r);break;case"comment":l(e,t,n)}return t}function a(e,t){e.parentNode.tagName=="pre"?t.push(e.data):t.push(n[e.parentNode.tagName]?utils.html(e.data):e.data.replace(/[ ]{2}/g," &nbsp;"))}function f(e,n,r,i){var a="";if(e.attrs){a=[];var f=e.attrs;for(var l in f)a.push(l+(f[l]!==undefined?'="'+(t[l]?utils.html(f[l]).replace(/["]/g,function(e){return"&quot;"}):utils.unhtml(f[l]))+'"':""));a=a.join(" ")}n.push("<"+e.tagName+(a?" "+a:"")+(dtd.$empty[e.tagName]?"/":"")+">"),r&&!dtd.$inlineWithA[e.tagName]&&e.tagName!="pre"&&e.children&&e.children.length&&(i=s(n,i,!0),o(n,i));if(e.children&&e.children.length)for(var c=0,h;h=e.children[c++];)r&&h.type=="element"&&!dtd.$inlineWithA[h.tagName]&&c>1&&(s(n,i),o(n,i)),u(h,n,r,i);dtd.$empty[e.tagName]||(r&&!dtd.$inlineWithA[e.tagName]&&e.tagName!="pre"&&e.children&&e.children.length&&(i=s(n,i),o(n,i)),n.push("</"+e.tagName+">"))}function l(e,t){t.push("<!--"+e.data+"-->")}function c(e,t){var n;if(e.type=="element"&&e.getAttr("id")==t)return e;if(e.children&&e.children.length)for(var r=0,i;i=e.children[r++];)if(n=c(i,t))return n}function h(e,t,n){e.type=="element"&&e.tagName==t&&n.push(e);if(e.children&&e.children.length)for(var r=0,i;i=e.children[r++];)h(i,t,n)}function p(e,t){if(e.children&&e.children.length)for(var n=0,r;r=e.children[n];)p(r,t),r.parentNode&&(r.children&&r.children.length&&t(r),r.parentNode&&n++);else t(e)}var e=UM.uNode=function(e){this.type=e.type,this.data=e.data,this.tagName=e.tagName,this.parentNode=e.parentNode,this.attrs=e.attrs||{},this.children=e.children},t={href:1,src:1,_src:1,_href:1,cdata_data:1},n={style:1,script:1},r="    ",i="\n";e.createElement=function(t){return/[<>]/.test(t)?UM.htmlparser(t).children[0]:new e({type:"element",children:[],tagName:t})},e.createText=function(e,t){return new UM.uNode({type:"text",data:t?e:utils.unhtml(e||"")})},e.prototype={toHtml:function(e){var t=[];return u(this,t,e,0),t.join("")},innerHTML:function(e){if(this.type!="element"||dtd.$empty[this.tagName])return this;if(utils.isString(e)){if(this.children)for(var t=0,n;n=this.children[t++];)n.parentNode=null;this.children=[];var r=UM.htmlparser(e);for(var t=0,n;n=r.children[t++];)this.children.push(n),n.parentNode=this;return this}var r=new UM.uNode({type:"root",children:this.children});return r.toHtml()},innerText:function(t,n){if(this.type!="element"||dtd.$empty[this.tagName])return this;if(t){if(this.children)for(var r=0,i;i=this.children[r++];)i.parentNode=null;return this.children=[],this.appendChild(e.createText(t,n)),this}return this.toHtml().replace(/<[^>]+>/g,"")},getData:function(){return this.type=="element"?"":this.data},firstChild:function(){return this.children?this.children[0]:null},lastChild:function(){return this.children?this.children[this.children.length-1]:null},previousSibling:function(){var e=this.parentNode;for(var t=0,n;n=e.children[t];t++)if(n===this)return t==0?null:e.children[t-1]},nextSibling:function(){var e=this.parentNode;for(var t=0,n;n=e.children[t++];)if(n===this)return e.children[t]},replaceChild:function(e,t){if(this.children){e.parentNode&&e.parentNode.removeChild(e);for(var n=0,r;r=this.children[n];n++)if(r===t)return this.children.splice(n,1,e),t.parentNode=null,e.parentNode=this,e}},appendChild:function(e){if(this.type=="root"||this.type=="element"&&!dtd.$empty[this.tagName]){this.children||(this.children=[]),e.parentNode&&e.parentNode.removeChild(e);for(var t=0,n;n=this.children[t];t++)if(n===e){this.children.splice(t,1);break}return this.children.push(e),e.parentNode=this,e}},insertBefore:function(e,t){if(this.children){e.parentNode&&e.parentNode.removeChild(e);for(var n=0,r;r=this.children[n];n++)if(r===t)return this.children.splice(n,0,e),e.parentNode=this,e}},insertAfter:function(e,t){if(this.children){e.parentNode&&e.parentNode.removeChild(e);for(var n=0,r;r=this.children[n];n++)if(r===t)return this.children.splice(n+1,0,e),e.parentNode=this,e}},removeChild:function(e,t){if(this.children)for(var n=0,r;r=this.children[n];n++)if(r===e){this.children.splice(n,1),r.parentNode=null;if(t&&r.children&&r.children.length)for(var i=0,s;s=r.children[i];i++)this.children.splice(n+i,0,s),s.parentNode=this;return r}},getAttr:function(e){return this.attrs&&this.attrs[e.toLowerCase()]},setAttr:function(e,t){if(!e){delete this.attrs;return}this.attrs||(this.attrs={});if(utils.isObject(e))for(var n in e)e[n]?this.attrs[n.toLowerCase()]=e[n]:delete this.attrs[n];else t?this.attrs[e.toLowerCase()]=t:delete this.attrs[e]},hasAttr:function(e){var t=this.getAttr(e);return t!==null&&t!==undefined},getIndex:function(){var e=this.parentNode;for(var t=0,n;n=e.children[t];t++)if(n===this)return t;return-1},getNodeById:function(e){var t;if(this.children&&this.children.length)for(var n=0,r;r=this.children[n++];)if(t=c(r,e))return t},getNodesByTagName:function(e){e=utils.trim(e).replace(/[ ]{2,}/g," ").split(" ");var t=[],n=this;return utils.each(e,function(e){if(n.children&&n.children.length)for(var r=0,i;i=n.children[r++];)h(i,e,t)}),t},getStyle:function(e){var t=this.getAttr("style");if(!t)return"";var n=new RegExp("(^|;)\\s*"+e+":([^;]+)","i"),r=t.match(n);return r&&r[0]?r[2]:""},setStyle:function(e,t){function n(e,t){var n=new RegExp("(^|;)\\s*"+e+":([^;]+;?)","gi");r=r.replace(n,"$1"),t&&(r=e+":"+utils.unhtml(t)+";"+r)}var r=this.getAttr("style");r||(r="");if(utils.isObject(e))for(var i in e)n(i,e[i]);else n(e,t);this.setAttr("style",utils.trim(r))},hasClass:function(e){if(this.hasAttr("class")){var t=this.getAttr("class").split(/\s+/),n=!1;return $.each(t,function(t,r){r===e&&(n=!0)}),n}return!1},addClass:function(e){var t=null,n=!1;this.hasAttr("class")?(t=this.getAttr("class"),t=t.split(/\s+/),t.forEach(function(t){if(t===e){n=!0;return}}),!n&&t.push(e),this.setAttr("class",t.join(" "))):this.setAttr("class",e)},removeClass:function(e){if(this.hasAttr("class")){var t=this.getAttr("class");t=t.replace(new RegExp("\\b"+e+"\\b","g"),""),this.setAttr("class",utils.trim(t).replace(/[ ]{2,}/g," "))}},traversal:function(e){return this.children&&this.children.length&&p(this,e),this}}})();var htmlparser=UM.htmlparser=function(e,t){function f(e,t){if(a[e.tagName]){var n=o.createElement(a[e.tagName]);e.appendChild(n),n.appendChild(o.createText(t)),e=n}else e.appendChild(o.createText(t))}function l(e,t,n){var i;if(i=u[t]){var a=e,f;while(a.type!="root"){if(utils.isArray(i)?utils.indexOf(i,a.tagName)!=-1:i==a.tagName){e=a,f=!0;break}a=a.parentNode}f||(e=l(e,utils.isArray(i)?i[0]:i))}var c=new o({parentNode:e,type:"element",tagName:t.toLowerCase(),children:dtd.$empty[t]?null:[]});if(n){var h={},p;while(p=r.exec(n))h[p[1].toLowerCase()]=s[p[1].toLowerCase()]?p[2]||p[3]||p[4]:utils.unhtml(p[2]||p[3]||p[4]);c.attrs=h}return e.children.push(c),dtd.$empty[t]?e:c}function c(e,t){e.children.push(new o({type:"comment",data:t,parentNode:e}))}var n=/<(?:(?:\/([^>]+)>)|(?:!--([\S|\s]*?)-->)|(?:([^\s\/>]+)\s*((?:(?:"[^"]*")|(?:'[^']*')|[^"'<>])*)\/?>))/g,r=/([\w\-:.]+)(?:(?:\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|([^\s>]+)))|(?=\s|$))/g,i={b:1,code:1,i:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,span:1,sub:1,img:1,sup:1,font:1,big:1,small:1,iframe:1,a:1,br:1,pre:1};e=e.replace(new RegExp(domUtils.fillChar,"g"),""),t||(e=e.replace(new RegExp("[\\r\\t\\n"+(t?"":" ")+"]*</?(\\w+)\\s*(?:[^>]*)>[\\r\\t\\n"+(t?"":" ")+"]*","g"),function(e,n){return n&&i[n.toLowerCase()]?e.replace(/(^[\n\r]+)|([\n\r]+$)/g,""):e.replace(new RegExp("^[\\r\\n"+(t?"":" ")+"]+"),"").replace(new RegExp("[\\r\\n"+(t?"":" ")+"]+$"),"")}));var s={href:1,src:1},o=UM.uNode,u={td:"tr",tr:["tbody","thead","tfoot"],tbody:"table",th:"tr",thead:"table",tfoot:"table",caption:"table",li:["ul","ol"],dt:"dl",dd:"dl",option:"select"},a={ol:"li",ul:"li"},h,p=0,d=0,v=new o({type:"root",children:[]}),m=v;while(h=n.exec(e)){p=h.index;try{p>d&&f(m,e.slice(d,p));if(h[3])dtd.$cdata[m.tagName]?f(m,h[0]):m=l(m,h[3].toLowerCase(),h[4]);else if(h[1]){if(m.type!="root")if(dtd.$cdata[m.tagName]&&!dtd.$cdata[h[1]])f(m,h[0]);else{var g=m;while(m.type=="element"&&m.tagName!=h[1].toLowerCase()){m=m.parentNode;if(m.type=="root")throw m=g,"break"}m=m.parentNode}}else h[2]&&c(m,h[2])}catch(y){}d=n.lastIndex}return d<e.length&&f(m,e.slice(d)),v},filterNode=UM.filterNode=function(){function e(t,n){switch(t.type){case"text":break;case"element":var r;if(r=n[t.tagName])if(r==="-")t.parentNode.removeChild(t);else if(utils.isFunction(r)){var i=t.parentNode,s=t.getIndex();r(t);if(t.parentNode){if(t.children)for(var o=0,u;u=t.children[o];)e(u,n),u.parentNode&&o++}else for(var o=s,u;u=i.children[o];)e(u,n),u.parentNode&&o++}else{var a=r.$;if(a&&t.attrs){var f={},l;for(var c in a){l=t.getAttr(c);if(c=="style"&&utils.isArray(a[c])){var h=[];utils.each(a[c],function(e){var n;(n=t.getStyle(e))&&h.push(e+":"+n)}),l=h.join(";")}l&&(f[c]=l)}t.attrs=f}if(t.children)for(var o=0,u;u=t.children[o];)e(u,n),u.parentNode&&o++}else if(dtd.$cdata[t.tagName])t.parentNode.removeChild(t);else{var i=t.parentNode,s=t.getIndex();t.parentNode.removeChild(t,!0);for(var o=s,u;u=i.children[o];)e(u,n),u.parentNode&&o++}break;case"comment":t.parentNode.removeChild(t)}}return function(t,n){if(utils.isEmptyObject(n))return t;var r;(r=n["-"])&&utils.each(r.split(" "),function(e){n[e]="-"});for(var i=0,s;s=t.children[i];)e(s,n),s.parentNode&&i++;return t}}();UM.plugins.paste=function(){function e(e){var t=this.document;if(t.getElementById("baidu_pastebin"))return;var n=this.selection.getRange(),r=n.createBookmark(),i=t.createElement("div");i.id="baidu_pastebin",browser.webkit&&i.appendChild(t.createTextNode(domUtils.fillChar+domUtils.fillChar)),this.body.appendChild(i),r.start.style.display="",i.style.cssText="position:absolute;width:1px;height:1px;overflow:hidden;left:-1000px;white-space:nowrap;top:"+$(r.start).position().top+"px",n.selectNodeContents(i).select(!0),setTimeout(function(){if(browser.webkit)for(var s=0,o=t.querySelectorAll("#baidu_pastebin"),u;u=o[s++];){if(!domUtils.isEmptyNode(u)){i=u;break}domUtils.remove(u)}try{i.parentNode.removeChild(i)}catch(a){}n.moveToBookmark(r).select(!0),e(i)},0)}function n(e){var n;if(e.firstChild){var r=domUtils.getElementsByTagName(e,"span");for(var i=0,s;s=r[i++];)(s.id=="_baidu_cut_start"||s.id=="_baidu_cut_end")&&domUtils.remove(s);if(browser.webkit){var o=e.querySelectorAll("div br");for(var i=0,u;u=o[i++];){var a=u.parentNode;a.tagName=="DIV"&&a.childNodes.length==1&&(a.innerHTML="<p><br/></p>",domUtils.remove(a))}var f=e.querySelectorAll("#baidu_pastebin");for(var i=0,l;l=f[i++];){var c=t.document.createElement("p");l.parentNode.insertBefore(c,l);while(l.firstChild)c.appendChild(l.firstChild);domUtils.remove(l)}var h=e.querySelectorAll("meta");for(var i=0,p;p=h[i++];)domUtils.remove(p);var o=e.querySelectorAll("br");for(i=0;p=o[i++];)/^apple-/i.test(p.className)&&domUtils.remove(p)}if(browser.gecko){var d=e.querySelectorAll("[_moz_dirty]");for(i=0;p=d[i++];)p.removeAttribute("_moz_dirty")}if(!browser.ie){var v=e.querySelectorAll("span.Apple-style-span");for(var i=0,p;p=v[i++];)domUtils.remove(p,!0)}n=e.innerHTML,n=UM.filterWord(n);var m=UM.htmlparser(n);t.options.pasteFilterRules&&UM.filterNode(m,t.options.pasteFilterRules),t.filterInputRule(m);if(browser.webkit){var g=m.lastChild();g&&g.type=="element"&&g.tagName=="br"&&m.removeChild(g),utils.each(t.body.querySelectorAll("div"),function(e){domUtils.isEmptyBlock(e)&&domUtils.remove(e)})}n={html:m.toHtml()},t.fireEvent("beforepaste",n,m);if(!n.html)return;t.execCommand("insertHtml",n.html,!0),t.fireEvent("afterpaste",n)}}var t=this;t.addListener("ready",function(){$(t.body).on("cut",function(){var e=t.selection.getRange();!e.collapsed&&t.undoManger&&t.undoManger.save()}).on(browser.ie||browser.opera?"keydown":"paste",function(r){if((browser.ie||browser.opera)&&(!r.ctrlKey&&!r.metaKey||r.keyCode!="86"))return;e.call(t,function(e){n(e)})})})},UM.plugins.autouploadimg=function(){function n(e){return e.clipboardData&&e.clipboardData.items&&e.clipboardData.items.length==1&&/^image\//.test(e.clipboardData.items[0].type)?e.clipboardData.items:null}var e=this,t=Wenda.UMeditor;e.setOpt("pasteImageEnabled",!0),e.addListener("ready",function(){if(window.FormData&&window.FileReader){var r=function(r){var i=n(r.originalEvent);if(i){var s=i.length,o;while(s--)o=i[s],o.getAsFile&&(o=o.getAsFile()),t.autoUpload(t.get(e.id),{},o)}};e.getOpt("pasteImageEnabled")&&e.$body.on("paste",r)}})},UM.commands.inserthtml={execCommand:function(e,t,n){var r=this,i,s;if(!t)return;if(r.fireEvent("beforeinserthtml",t)===!0)return;i=r.selection.getRange(),s=i.document.createElement("div"),s.style.display="inline";if(!n){var o=UM.htmlparser(t);r.options.filterRules&&UM.filterNode(o,r.options.filterRules),r.filterInputRule(o),t=o.toHtml()}s.innerHTML=utils.trim(t);if(!i.collapsed){var u=i.startContainer;domUtils.isFillChar(u)&&i.setStartBefore(u),u=i.endContainer,domUtils.isFillChar(u)&&i.setEndAfter(u),i.txtToElmBoundary(),i.endContainer&&i.endContainer.nodeType==1&&(u=i.endContainer.childNodes[i.endOffset],u&&domUtils.isBr(u)&&i.setEndAfter(u)),i.startOffset==0&&(u=i.startContainer,domUtils.isBoundaryNode(u,"firstChild")&&(u=i.endContainer,i.endOffset==(u.nodeType==3?u.nodeValue.length:u.childNodes.length)&&domUtils.isBoundaryNode(u,"lastChild")&&(r.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>",i.setStart(r.body.firstChild,0).collapse(!0)))),!i.collapsed&&i.deleteContents();if(i.startContainer.nodeType==1){var a=i.startContainer.childNodes[i.startOffset],f;if(a&&domUtils.isBlockElm(a)&&(f=a.previousSibling)&&domUtils.isBlockElm(f)){i.setEnd(f,f.childNodes.length).collapse();while(a.firstChild)f.appendChild(a.firstChild);domUtils.remove(a)}}}var a,l,f,c,h=0,p;i.inFillChar()&&(a=i.startContainer,domUtils.isFillChar(a)?(i.setStartBefore(a).collapse(!0),domUtils.remove(a)):domUtils.isFillChar(a,!0)&&(a.nodeValue=a.nodeValue.replace(fillCharReg,""),i.startOffset--,i.collapsed&&i.collapse(!0)));while(a=s.firstChild){if(h){var d=r.document.createElement("p");while(a&&(a.nodeType==3||!dtd.$block[a.tagName]))p=a.nextSibling,d.appendChild(a),a=p;d.firstChild&&(a=d)}i.insertNode(a),p=a.nextSibling;if(!h&&a.nodeType==domUtils.NODE_ELEMENT&&domUtils.isBlockElm(a)){l=domUtils.findParent(a,function(e){return domUtils.isBlockElm(e)});if(l&&l.tagName.toLowerCase()!="body"&&(!dtd[l.tagName][a.nodeName]||a.parentNode!==l)){if(!dtd[l.tagName][a.nodeName])f=l;else{c=a.parentNode;while(c!==l)f=c,c=c.parentNode}domUtils.breakParent(a,f||c);var f=a.previousSibling;domUtils.trimWhiteTextNode(f),f.childNodes.length||domUtils.remove(f),!browser.ie&&(v=a.nextSibling)&&domUtils.isBlockElm(v)&&v.lastChild&&!domUtils.isBr(v.lastChild)&&v.appendChild(r.document.createElement("br")),h=1}}var v=a.nextSibling;if(!s.firstChild&&v&&domUtils.isBlockElm(v)){i.setStart(v,0).collapse(!0);break}i.setEndAfter(a).collapse()}a=i.startContainer,p&&domUtils.isBr(p)&&domUtils.remove(p);if(domUtils.isBlockElm(a)&&domUtils.isEmptyNode(a))if(p=a.nextSibling)domUtils.remove(a),p.nodeType==1&&dtd.$block[p.tagName]&&i.setStart(p,0).collapse(!0).shrinkBoundary();else try{a.innerHTML=browser.ie?domUtils.fillChar:"<br/>"}catch(m){i.setStartBefore(a),domUtils.remove(a)}try{if(browser.ie9below&&i.startContainer.nodeType==1&&!i.startContainer.childNodes[i.startOffset]){var g=i.startContainer,f=g.childNodes[i.startOffset-1];if(f&&f.nodeType==1&&dtd.$empty[f.tagName]){var y=this.document.createTextNode(domUtils.fillChar);i.insertNode(y).setStart(y,0).collapse(!0)}}setTimeout(function(){i.select(!0)})}catch(m){}setTimeout(function(){i=r.selection.getRange(),i.scrollIntoView(),r.fireEvent("afterinserthtml")},200)}},UM.plugins.undo=function(){function u(e,t){if(e.length!=t.length)return 0;for(var n=0,r=e.length;n<r;n++)if(e[n]!=t[n])return 0;return 1}function a(e,t){return e.collapsed!=t.collapsed?0:!u(e.startAddress,t.startAddress)||!u(e.endAddress,t.endAddress)?0:1}function f(){this.list=[],this.index=0,this.hasUndo=!1,this.hasRedo=!1,this.undo=function(){if(this.hasUndo){if(!this.list[this.index-1]&&this.list.length==1){this.reset();return}while(this.list[this.index].content==this.list[this.index-1].content){this.index--;if(this.index==0)return this.restore(0)}this.restore(--this.index)}},this.redo=function(){if(this.hasRedo){while(this.list[this.index].content==this.list[this.index+1].content){this.index++;if(this.index==this.list.length-1)return this.restore(this.index)}this.restore(++this.index)}},this.restore=function(){var e=this.editor,t=this.list[this.index],n=UM.htmlparser(t.content.replace(i,""));e.options.autoClearEmptyNode=!1,e.filterInputRule(n,!0),e.options.autoClearEmptyNode=o,e.body.innerHTML=n.toHtml(),e.fireEvent("afterscencerestore"),browser.ie&&utils.each(domUtils.getElementsByTagName(e.document,"td th caption p"),function(t){domUtils.isEmptyNode(t)&&domUtils.fillNode(e.document,t)});try{var r=(new dom.Range(e.document,e.body)).moveToAddress(t.address);if(browser.ie&&r.collapsed&&r.startContainer.nodeType==1){var u=r.startContainer.childNodes[r.startOffset];(!u||u.nodeType==1&&dtd.$empty[u])&&r.insertNode(e.document.createTextNode(" ")).collapse(!0)}r.select(s[r.startContainer.nodeName.toLowerCase()])}catch(a){}this.update(),this.clearKey(),e.fireEvent("reset",!0)},this.getScene=function(){var e=this.editor,t=e.selection.getRange(),n=t.createAddress(!1,!0);e.fireEvent("beforegetscene");var r=UM.htmlparser(e.body.innerHTML,!0);e.options.autoClearEmptyNode=!1,e.filterOutputRule(r,!0),e.options.autoClearEmptyNode=o;var i=r.toHtml();return browser.ie&&(i=i.replace(/>&nbsp;</g,"><").replace(/\s*</g,"<").replace(/>\s*/g,">")),e.fireEvent("aftergetscene"),{address:n,content:i}},this.save=function(t,r){clearTimeout(e);var i=this.getScene(r),s=this.list[this.index];if(s&&s.content==i.content&&(t?1:a(s.address,i.address)))return;this.list=this.list.slice(0,this.index+1),this.list.push(i),this.list.length>n&&this.list.shift(),this.index=this.list.length-1,this.clearKey(),this.update()},this.update=function(){this.hasRedo=!!this.list[this.index+1],this.hasUndo=!!this.list[this.index-1]},this.reset=function(){this.list=[],this.index=0,this.hasUndo=!1,this.hasRedo=!1,this.clearKey()},this.clearKey=function(){h=0,p=null}}function l(){this.undoManger.save()}var e,t=this,n=t.options.maxUndoCount||20,r=t.options.maxInputCount||20,i=new RegExp(domUtils.fillChar+"|</hr>","gi"),s={ol:1,ul:1,table:1,tbody:1,tr:1,body:1},o=t.options.autoClearEmptyNode;t.undoManger=new f,t.undoManger.editor=t,t.addListener("saveScene",function(){var e=Array.prototype.splice.call(arguments,1);this.undoManger.save.apply(this.undoManger,e)}),t.addListener("beforeexeccommand",l),t.addListener("afterexeccommand",l),t.addListener("reset",function(e,t){t||this.undoManger.reset()}),t.commands.redo=t.commands.undo={execCommand:function(e){this.undoManger[e]()},queryCommandState:function(e){return this.undoManger["has"+(e.toLowerCase()=="undo"?"Undo":"Redo")]?0:-1},notNeedUndo:1};var c={16:1,17:1,18:1,37:1,38:1,39:1,40:1},h=0,p,d=!1;t.addListener("ready",function(){$(this.body).on("compositionstart",function(){d=!0}).on("compositionend",function(){d=!1})}),t.addshortcutkey({Undo:"ctrl+90",Redo:"ctrl+89,shift+ctrl+z"});var v=!0;t.addListener("keydown",function(t,n){var i=this,s=n.keyCode||n.which;if(!c[s]&&!n.ctrlKey&&!n.metaKey&&!n.shiftKey&&!n.altKey){if(d)return;if(!i.selection.getRange().collapsed){i.undoManger.save(!1,!0),v=!1;return}i.undoManger.list.length==0&&i.undoManger.save(!0),clearTimeout(e);function o(e){e.selection.getRange().collapsed&&e.fireEvent("contentchange"),e.undoManger.save(!1,!0),e.fireEvent("selectionchange")}e=setTimeout(function(){if(d){var e=setInterval(function(){d||(o(i),clearInterval(e))},300);return}o(i)},200),p=s,h++,h>=r&&o(i)}}),t.addListener("keyup",function(e,t){var n=t.keyCode||t.which;if(!c[n]&&!t.ctrlKey&&!t.metaKey&&!t.shiftKey&&!t.altKey){if(d)return;v||(this.undoManger.save(!1,!0),v=!0)}})},UM.plugins.list=function(){var e=Wenda.Log,t=this;t.setOpt({insertorderedlist:{decimal:"","lower-alpha":"","lower-roman":"","upper-alpha":"","upper-roman":""},insertunorderedlist:{circle:"",disc:"",square:""}}),this.addInputRule(function(e){utils.each(e.getNodesByTagName("li"),function(e){e.children.length==0&&e.parentNode.removeChild(e)})}),t.commands.insertorderedlist=t.commands.insertunorderedlist={execCommand:function(t){t=="insertorderedlist"?e.send("\u56de\u7b54\u8f93\u5165\u6846\u2014\u201c\u9879\u76ee\u7f16\u53f7\u201d\u70b9\u51fb"):e.send("\u56de\u7b54\u8f93\u5165\u6846\u2014\u201c\u9879\u76ee\u7b26\u53f7\u201d\u70b9\u51fb"),this.document.execCommand(t);var n=this.selection.getRange(),r=n.createBookmark(!0);return this.$body.find("ol,ul").each(function(e,t){var n=t.parentNode;n.tagName=="P"&&n.lastChild===n.firstChild&&($(t).children().each(function(e,t){var r=n.cloneNode(!1);$(r).append(t.innerHTML),$(t).html("").append(r)}),$(t).insertBefore(n),$(n).remove()),dtd.$inline[n.tagName]&&(n.tagName=="SPAN"&&$(t).children().each(function(e,t){var r=n.cloneNode(!1);if(t.firstChild.nodeName!="P"){while(t.firstChild)r.appendChild(t.firstChild);$("<p></p>").appendTo(t).append(r)}else{while(t.firstChild)r.appendChild(t.firstChild);$(t.firstChild).append(r)}}),domUtils.remove(n,!0))}),n.moveToBookmark(r).select(),!0},queryCommandState:function(e){var n=t.selection.getStartElementPath(),r=!1;return $.each(n,function(e,t){if(t.nodeName=="H3")return r=-1,!1}),r==-1?r:this.document.queryCommandState(e)}}},UM.plugins.basestyle=function(){var e=["bold","underline","superscript","subscript","italic","strikethrough"],t=this,n=Wenda.Log;t.addshortcutkey({Bold:"ctrl+66"}),t.addOutputRule(function(e){$.each(e.getNodesByTagName("b i u strike s"),function(e,t){switch(t.tagName){case"b":t.tagName="strong";break;case"i":t.tagName="em";break;case"u":t.tagName="span",t.setStyle("text-decoration","underline");break;case"s":case"strike":t.tagName="span",t.setStyle("text-decoration","line-through")}})}),$.each(e,function(e,r){t.commands[r]={execCommand:function(e){n.send("\u56de\u7b54\u8f93\u5165\u6846\u2014\u201c\u52a0\u7c97\u201d\u70b9\u51fb");var t,r=this.selection.getRange();if(!r.collapsed)return this.document.execCommand(e);if(this.queryCommandState(e)==1)return t=this.document.createElement("span"),t.appendChild(this.document.createTextNode(domUtils.fillChar)),r.insertNode(t),r.selectNode(t).select(),this.document.execCommand(e),!0;if(this.queryCommandState(e)!=1)return t=this.document.createElement({bold:"strong",underline:"u",superscript:"sup",subscript:"sub",italic:"em",strikethrough:"strike"}[e]),r.insertNode(t).setStart(t,0).setCursor(!1),!0},queryCommandState:function(e){var t=this.selection.getStartElementPath(),n=!1;return $.each(t,function(t,r){switch(e){case"bold":if(r.nodeName=="STRONG"||r.nodeName=="B")n=1;else if(r.nodeName=="H3")return n=-1,!1;break;case"underline":if(r.nodeName=="U"||r.nodeName=="SPAN"&&$(r).css("text-decoration")=="underline")return n=1,!1;break;case"superscript":if(r.nodeName=="SUP")return n=1,!1;break;case"subscript":if(r.nodeName=="SUB")return n=1,!1;break;case"italic":if(r.nodeName=="EM"||r.nodeName=="I")return n=1,!1;break;case"strikethrough":if(r.nodeName=="S"||r.nodeName=="STRIKE"||r.nodeName=="SPAN"&&$(r).css("text-decoration")=="line-through")return n=1,!1}}),n}}})},UM.plugins.settitle=function(){var e=Wenda.Log,t=this;t.commands.settitle={execCommand:function(){e.send("\u56de\u7b54\u8f93\u5165\u6846\u2014\u201c\u6807\u9898\u201d\u70b9\u51fb");var n=this.document.queryCommandValue("formatBlock");return n=="h3"||n=="\u6807\u9898 3"?t.document.execCommand("formatBlock",!1,"<p>"):t.document.execCommand("formatBlock",!1,"<h3>")},queryCommandState:function(){var e=t.selection.getStartElementPath(),n=!1;return $.each(e,function(e,t){if(t.nodeName=="H3")return n=1,!1;if(t.nodeName=="LI")return n=-1,!1}),n}}},UM.commands.uploadimg={execCommand:function(e){},queryCommandState:function(){var e=this.selection.getStartElementPath(),t=!1;return $.each(e,function(e,n){if(n.nodeName=="H3")return t=-1,!1}),t}},UM.plugins.uploadimg=function(){function f(e){e.preventDefault();if($(this).hasClass("disabled"))return!1;$(this).addClass("disabled"),a.report("message","wendaCallback")}function l(e){var r='<iframe data-pid="'+(e.query.pid||"")+'" data-type="'+e.type+'"  class="mod-so-map-ifr js-so-map-ifr" width="98%" height="350" frameborder="no" border="0" name="editor-so-map" src="'+e.url+' "></iframe>';i.execCommand("inserthtml",r),i.focus(),n.hasInsertMap=1,$("#map_info").val(JSON.stringify(e)),o||(o=!0,$(i.body).on("keydown.somap",function(e){var n=this;t.undelay("so-map"),t.delay("so-map",100,function(){$(".js-so-map-ifr",n).length==0&&c()})}))}function c(){$(i.body).off("keydown.somap"),$("#map_info").val(""),o=!1,n.hasInsertMap=0}if(!Pigeon
)return;var e=Wenda.Panel,t=Wenda.Timer,n=Wenda.Info,r=Wenda.Log,i=this,s=null,o=!1,u='<div class="boxs"><h3><img src="http://p1.qhmsg.com/d/inn/312e88ae/ditu_logo.png"></h3><iframe frameborder="no" border="0" class="so-map-ifr" name="so-map-ifr" src="http://map.'+n.root_domain+"/wenda/?k="+$("#js-ask-title").val()+'"></iframe>'+'<p><a class="js-map-insert" href="#insert" text="<\u7f51\u7ad9>\u95ee\u7b54\u8be6\u60c5\u9875-\u5730\u56fe\u6d6e\u5c42\u6dfb\u52a0\u5230\u7b54\u6848\u3010\u70b9\u51fb\u3011">\u6dfb\u52a0\u5230\u7b54\u6848</a></p>'+"</div>",a=new Pigeon({iframeName:"so-map-ifr"});a.receive("message",function(e){var t=e.data;if(o)return;if(t&&t.url!=""){if(!t.url.match(/^https?:\/\/map\.(?:haosou|so)\.com/ig))return;s.close(),l(t)}else Wenda.Panel.steam({msg:"\u4eb2\uff0c\u60a8\u8fd8\u6ca1\u6709\u9009\u62e9\u5730\u70b9\u6216\u8def\u7ebf\u54e6",width:350});$(".js-map-insert").removeClass("disabled")}),i.commands["360map"]={execCommand:function(){s?s.showModal():s=e.show({skin:"mod-map-panel",content:u,onready:function(){$(".js-map-insert").click(f)}}),r.send("\u56de\u7b54\u8f93\u5165\u6846\u2014\u201c\u63d2\u5165\u5730\u56fe\u201d\u70b9\u51fb")},queryCommandState:function(){var e=this.selection.getStartElementPath(),t=!1;return $.each(e,function(e,n){if(n.nodeName=="H3")return t=-1,!1}),$(this.body).find(".js-so-map-ifr").length&&(t=-1),t}}},UM.plugins.enterkey=function(){var e,t=this,n=t.options.enterTag;t.addListener("keyup",function(n,r){var i=r.keyCode||r.which;if(i==13){var s=t.selection.getRange(),o=s.startContainer,u;if(!browser.ie){if(/h\d/i.test(e)){if(browser.gecko){var a=domUtils.findParentByTagName(o,["h1","h2","h3","h4","h5","h6","blockquote","caption","table"],!0);a||(t.document.execCommand("formatBlock",!1,"<p>"),u=1)}else if(o.nodeType==1){var f=t.document.createTextNode(""),l;s.insertNode(f),l=domUtils.findParentByTagName(f,"div",!0);if(l){var c=t.document.createElement("p");while(l.firstChild)c.appendChild(l.firstChild);l.parentNode.insertBefore(c,l),domUtils.remove(l),s.setStartBefore(f).setCursor(),u=1}domUtils.remove(f)}t.undoManger&&u&&t.undoManger.save()}browser.opera&&s.select()}else t.fireEvent("saveScene",!0,!0)}}),t.addListener("keydown",function(r,i){var s=i.keyCode||i.which;if(s==13){if(t.fireEvent("beforeenterkeydown")){domUtils.preventDefault(i);return}t.fireEvent("saveScene",!0,!0),e="";var o=t.selection.getRange();if(!o.collapsed){var u=o.startContainer,a=o.endContainer,f=domUtils.findParentByTagName(u,"td",!0),l=domUtils.findParentByTagName(a,"td",!0);if(f&&l&&f!==l||!f&&l||f&&!l){i.preventDefault?i.preventDefault():i.returnValue=!1;return}}n=="p"&&(browser.ie||(u=domUtils.findParentByTagName(o.startContainer,["ol","ul","p","h1","h2","h3","h4","h5","h6","blockquote","caption"],!0),!u&&!browser.opera?(t.document.execCommand("formatBlock",!1,"<p>"),browser.gecko&&(o=t.selection.getRange(),u=domUtils.findParentByTagName(o.startContainer,"p",!0),u&&domUtils.removeDirtyAttr(u))):(e=u.tagName,u.tagName.toLowerCase()=="p"&&browser.gecko&&domUtils.removeDirtyAttr(u))))}}),browser.ie&&t.addListener("setDisabled",function(){$(t.body).find("p").each(function(e,t){domUtils.isEmptyBlock(t)&&(t.innerHTML="&nbsp;")})})},UM.plugins.keystrokes=function(){var e=this,t=!0;e.addListener("keydown",function(n,r){var i=r.keyCode||r.which,s=e.selection.getRange();if(!s.collapsed&&!(r.ctrlKey||r.shiftKey||r.altKey||r.metaKey)&&(i>=65&&i<=90||i>=48&&i<=57||i>=96&&i<=111||{13:1,8:1,46:1}[i])){var o=s.startContainer;domUtils.isFillChar(o)&&s.setStartBefore(o),o=s.endContainer,domUtils.isFillChar(o)&&s.setEndAfter(o),s.txtToElmBoundary(),s.endContainer&&s.endContainer.nodeType==1&&(o=s.endContainer.childNodes[s.endOffset],o&&domUtils.isBr(o)&&s.setEndAfter(o));if(s.startOffset==0){o=s.startContainer;if(domUtils.isBoundaryNode(o,"firstChild")){o=s.endContainer;if(s.endOffset==(o.nodeType==3?o.nodeValue.length:o.childNodes.length)&&domUtils.isBoundaryNode(o,"lastChild")){e.fireEvent("saveScene"),e.body.innerHTML="<p>"+(browser.ie?"":"<br/>")+"</p>",s.setStart(e.body.firstChild,0).setCursor(!1,!0),e._selectionChange();return}}}}if(i==8){s=e.selection.getRange(),t=s.collapsed;if(e.fireEvent("delkeydown",r))return;var u,a;s.collapsed&&s.inFillChar()&&(u=s.startContainer,domUtils.isFillChar(u)?(s.setStartBefore(u).shrinkBoundary(!0).collapse(!0),domUtils.remove(u)):(u.nodeValue=u.nodeValue.replace(new RegExp("^"+domUtils.fillChar),""),s.startOffset--,s.collapse(!0).select(!0)));if(u=s.getClosedNode()){e.fireEvent("saveScene"),s.setStartBefore(u),domUtils.remove(u),s.setCursor(),e.fireEvent("saveScene"),domUtils.preventDefault(r);return}if(!browser.ie){u=domUtils.findParentByTagName(s.startContainer,"table",!0),a=domUtils.findParentByTagName(s.endContainer,"table",!0);if(u&&!a||!u&&a||u!==a){r.preventDefault();return}}u=s.startContainer;if(s.collapsed&&u.nodeType==1){var f=u.childNodes[s.startOffset-1];f&&f.nodeType==1&&f.tagName=="BR"&&(e.fireEvent("saveScene"),s.setStartBefore(f).collapse(!0),domUtils.remove(f),s.select(),e.fireEvent("saveScene"))}if(browser.chrome&&s.collapsed){while(s.startOffset==0&&!domUtils.isEmptyBlock(s.startContainer))s.setStartBefore(s.startContainer);var l=s.startContainer.childNodes[s.startOffset-1];l&&l.nodeName=="BR"&&(s.setStartBefore(l),e.fireEvent("saveScene"),$(l).remove(),s.setCursor(),e.fireEvent("saveScene"))}}if(browser.gecko&&i==46){var c=e.selection.getRange();if(c.collapsed){u=c.startContainer;if(domUtils.isEmptyBlock(u)){var h=u.parentNode;while(domUtils.getChildCount(h)==1&&!domUtils.isBody(h))u=h,h=h.parentNode;u===h.lastChild&&r.preventDefault();return}}}}),e.addListener("keyup",function(e,n){var r=n.keyCode||n.which,i,s=this;if(r==8){if(s.fireEvent("delkeyup"))return;i=s.selection.getRange();if(i.collapsed){var o,u=["h1","h2","h3","h4","h5","h6"];if(o=domUtils.findParentByTagName(i.startContainer,u,!0))if(domUtils.isEmptyBlock(o)){var a=o.previousSibling;if(a&&a.nodeName!="TABLE"){domUtils.remove(o),i.setStartAtLast(a).setCursor(!1,!0);return}var f=o.nextSibling;if(f&&f.nodeName!="TABLE"){domUtils.remove(o),i.setStartAtFirst(f).setCursor(!1,!0);return}}if(domUtils.isBody(i.startContainer)){var o=domUtils.createElement(s.document,"p",{innerHTML:browser.ie?domUtils.fillChar:"<br/>"});i.insertNode(o).setStart(o,0).setCursor(!1,!0)}}if(!t&&(i.startContainer.nodeType==3||i.startContainer.nodeType==1&&domUtils.isEmptyBlock(i.startContainer)))if(browser.ie){var l=i.document.createElement("span");i.insertNode(l).setStartBefore(l).collapse(!0),i.select(),domUtils.remove(l)}else i.select()}})},UM.plugins.autosubmit=function(){var e=Wenda.Log,t=this;t.addshortcutkey({autosubmit:"ctrl+13"}),t.commands.autosubmit={execCommand:function(){if(t.form){if(t.fireEvent("beforesubmit")===!1)return;t.sync(),t._edui_fullscreen_status?e.send("\u8be6\u60c5\u9875\u56de\u7b54\u8f93\u5165\u6846\u5168\u5c4f\u63d0\u4ea4-\u5feb\u6377\u65b9\u5f0f"):e.send("\u8be6\u60c5\u9875\u56de\u7b54\u8f93\u5165\u6846\u63d0\u4ea4-\u5feb\u6377\u65b9\u5f0f"),$(t.form).trigger("submit")}}}},function(e){function i(t,r,i){t.prototype=e.extend2(e.extend({},r),(UM.ui[i]||n).prototype,!0),t.prototype.supper=(UM.ui[i]||n).prototype;if(UM.ui[i]&&UM.ui[i].prototype.defaultOpt){var s=UM.ui[i].prototype.defaultOpt,o=t.prototype.defaultOpt;t.prototype.defaultOpt=e.extend({},s,o||{})}return t}function o(t,n){e[r+n]=t,e.fn[r+n]=function(n){var r,i=Array.prototype.slice.call(arguments,1);return this.each(function(s,o){var u=e(o),a=u.edui();a||(t(!n||!e.isPlainObject(n)?{}:n,u),u.edui(a));if(e.type(n)=="string")if(n=="this")r=a;else{r=a[n].apply(a,i);if(r!==a&&r!==undefined)return!1;r=null}}),r!==null?r:this}}e.parseTmpl=function(t,n){var r="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+t.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(/<%=([\s\S]+?)%>/g,function(e,t){return"',"+t.replace(/\\'/g,"'")+",'"}).replace(/<%([\s\S]+?)%>/g,function(e,t){return"');"+t.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+"__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');",i=new Function("obj",r);return n?i(n):i},e.extend2=function(t,n){var r=arguments,i=e.type(r[r.length-1])=="boolean"?r[r.length-1]:!1,s=e.type(r[r.length-1])=="boolean"?r.length-1:r.length;for(var o=1;o<s;o++){var u=r[o];for(var a in u)if(!i||!t.hasOwnProperty(a))t[a]=u[a]}return t},e.IE6=!!window.ActiveXObject&&parseFloat(navigator.userAgent.match(/msie (\d+)/i)[1])==6;var t=[],n=function(){},r="edui";n.prototype={on:function(t,n){return this.root().on(t,e.proxy(n,this)),this},off:function(t,n){return this.root().off(t,e.proxy(n,this)),this},trigger:function(e,t){return this.root().trigger(e,t)===!1?!1:this},root:function(e){return this._$el||(this._$el=e)},destroy:function(){},data:function(e,t){return t!==undefined?(this.root().data(r+e,t),this):this.root().data(r+e)},register:function(n,r,i){t.push({evtname:n,$els:e.isArray(r)?r:[r],handler:e.proxy(i,r)})}},e.fn.edui=function(e){return e?this.data("eduiwidget",e):this.data("eduiwidget")};var s=1;UM.ui={define:function(t,n,u){var a=UM.ui[t]=i(function(n,i){var o=function(){};e.extend(o.prototype,a.prototype,{guid:t+s++,widgetName:t});var u=new o;if(e.type(n)=="string")return u.init&&u.init({}),u.root().edui(u),u.root().find("a").click(function(e){e.preventDefault()}),u.root()[r+t].apply(u.root(),arguments);i&&u.root(i),u.init&&u.init(!n||e.isPlainObject(n)?e.extend2(n||{},u.defaultOpt||{},!0):n);try{u.root().find("a").click(function(e){e.preventDefault()})}catch(f){}return u.root().edui(u)},n,u);o(a,t)}},e(function(){e(document).on("click mouseup mousedown dblclick mouseover",function(n){e.each(t,function(t,r){r.evtname==n.type&&e.each(r.$els,function(t,i){i[0]!==n.target&&!e.contains(i[0],n.target)&&r.handler(n)})})})})}(jQuery),function(){UM.ui.define("toolbar",{tpl:'<div class="edui-toolbar"  ><div class="edui-btn-toolbar" unselectable="on" onmousedown="return false"  ></div></div>',init:function(){var e=this.root($(this.tpl));this.data("$btnToolbar",e.find(".edui-btn-toolbar"))},appendToBtnmenu:function(e){var t=this.data("$btnToolbar");e=$.isArray(e)?e:[e],$.each(e,function(e,n){t.append(n)})}})}(),UM.ui.define("tooltip",{tpl:'<div class="edui-tooltip" unselectable="on" onmousedown="return false"><div class="edui-tooltip-arrow" unselectable="on" onmousedown="return false"></div><div class="edui-tooltip-inner" unselectable="on" onmousedown="return false"></div></div>',init:function(e){var t=this;t.root($($.parseTmpl(t.tpl,e||{})))},content:function(e){var t=this,n=$(e.currentTarget).attr("data-original-title");t.root().find(".edui-tooltip-inner").text(n)},position:function(e){var t=this,n=$(e.currentTarget);t.root().css($.extend({display:"block"},n?{top:n.outerHeight(),left:(n.outerWidth()-t.root().outerWidth())/2}:{}))},show:function(e){if($(e.currentTarget).hasClass("edui-disabled"))return;var t=this;t.content(e),t.root().appendTo($(e.currentTarget)),t.position(e),t.root().css("display","block")},hide:function(){var e=this;e.root().css("display","none")},attachTo:function(e){function n(e){var t=this;$.contains(document.body,t.root()[0])||t.root().appendTo(e),t.data("tooltip",t.root()),e.each(function(){$(this).attr("data-original-title")&&$(this).on("mouseenter",$.proxy(t.show,t)).on("mouseleave click",$.proxy(t.hide,t))})}var t=this;$.type(e)==="undefined"?$("[data-original-title]").each(function(e,r){n.call(t,$(r))}):e.data("tooltip")||n.call(t,e)}}),UM.ui.define("button",{tpl:'<<%if(!texttype){%>div class="edui-btn edui-btn-<%=icon%> <%if(name){%>edui-btn-name-<%=name%><%}%>" unselectable="on" onmousedown="return false" <%}else{%>a class="edui-text-btn"<%}%><% if(title) {%> data-original-title="<%=title%>" <%};%>> <% if(icon) {%><div unselectable="on" class="edui-icon-<%=icon%> edui-icon"></div><% }; %><%if(text) {%><span unselectable="on" onmousedown="return false" class="edui-button-label"><%=text%></span><%}%><%if(caret && text){%><span class="edui-button-spacing"></span><%}%><% if(caret) {%><span unselectable="on" onmousedown="return false" class="edui-caret"></span><% };%></<%if(!texttype){%>div<%}else{%>a<%}%>>',defaultOpt:{text:"",title:"",icon:"",width:"",caret:!1,texttype:!1,click:function(){}},init:function(e){var t=this;return t.root($($.parseTmpl(t.tpl,e))).click(function(n){t.wrapclick(e.click,n)}),t.root().hover(function(){t.root().hasClass("edui-disabled")||t.root().toggleClass("edui-hover")}),t},wrapclick:function(e,t){return this.disabled()||(this.root().trigger("wrapclick"),$.proxy(e,this,t)()),this},label:function(e){return e===undefined?this.root().find(".edui-button-label").text():(this.root().find(".edui-button-label").text(e),this)},disabled:function(e){return e===undefined?this.root().hasClass("edui-disabled"):(this.root().toggleClass("edui-disabled",e),this.root().hasClass("edui-disabled")&&this.root().removeClass("edui-hover"),this)},active:function(e){return e===undefined?this.root().hasClass("edui-active"):(this.root().toggleClass("edui-active",e),this)},mergeWith:function(e){var t=this;t.data("$mergeObj",e),e.edui().data("$mergeObj",t.root()),$.contains(document.body,e[0])||e.appendTo(t.root()),t.on("click",function(){t.wrapclick(function(){e.edui().show()})}).register("click",t.root(),function(t){e.hide()})}}),function(){var e={},t={},n=[],r=null,i={},s={},o={},u=null;utils.extend(UM,{defaultWidth:500,defaultHeight:500,registerUI:function(t,n){utils.each(t.split(/\s+/),function(t){e[t]=n})},setEditor:function(e){!t[e.id]&&(t[e.id]=e)},registerWidget:function(e,t,n){i[e]=$.extend2(t,{$root:"",_preventDefault:!1,root:function(e){return this.$root||(this.$root=e)},preventDefault:function(){this._preventDefault=!0},clear:!1}),n&&(s[e]=n)},getWidgetData:function(e){return i[e]},setWidgetBody:function(e,t,n){n._widgetData||utils.extend(n,{_widgetData:{},getWidgetData:function(e){return this._widgetData[e]},getWidgetCallback:function(e){var n=this;return function(){return s[e].apply(n,[n,t].concat(Array.prototype.slice.call(arguments,0)))}}});var r=i[e];if(!r)return null;r=n._widgetData[e],r||(r=i[e],r=n._widgetData[e]=$.type(r)=="function"?r:utils.clone(r)),r.root(t.edui().getBodyContainer()),r.initContent(n,t),r._preventDefault||r.initEvent(n,t),r.width&&t.width(r.width)},setActiveWidget:function(e){r=e},getEditor:function(e,n){var r=t[e]||(t[e]=this.createEditor(e,n));return u=u?Math.max(r.getOpt("zIndex"),u):r.getOpt("zIndex"),r},setTopEditor:function(e){$.each(t,function(t,n){e==n?e.$container&&e.$container.css("zIndex",u+1):n.$container&&n.$container.css("zIndex",n.getOpt("zIndex"))})},clearCache:function(e){t[e]&&delete t[e]},delEditor:function(e){var n;(n=t[e])&&n.destroy()},ready:function(e){n.push(e)},createEditor:function(e,t){function s(){var t=this.createUI("#"+e,r);r.key=e,r.ready(function(){$.each(n,function(e,t){$.proxy(t,r)()})});var i=r.options;if(i.initialFrameWidth)i.minFrameWidth=i.initialFrameWidth;else{i.minFrameWidth=i.initialFrameWidth=r.$body.width()||UM.defaultWidth;var s=r.$body[0].style.width;s.match(/%$/)&&(i.initialFrameWidth=s)}t.css({width:i.initialFrameWidth,zIndex:r.getOpt("zIndex")}),UM.browser.ie&&UM.browser.version===6&&document.execCommand("BackgroundImageCache",!1,!0),r.render(e),$.eduitooltip&&$.eduitooltip("attachTo",$("[data-original-title]",t)).css("z-index",r.getOpt("zIndex")+1),t.find("a").click(function(e){e.preventDefault()}),r.fireEvent("afteruiready")}var r=new UM.Editor(t),i=this;return r.langIsReady?$.proxy(s,i)():r.addListener("langReady",$.proxy(s,i)),r},createUI:function(t,n){var r=$(t),i=$('<div class="edui-container"><div class="edui-editor-body"></div></div>').insertBefore(r);n.$container=i,n.container=i[0],n.$body=r;if(browser.ie&&browser.ie9above){var s=$('<span style="padding:0;margin:0;height:0;width:0"></span>');s.insertAfter(i)}return $.each(e,function(e,t){var r=t.call(n,e);r&&(o[e]=r)}),i.find(".edui-editor-body").append(r).before(this.createToolbar(n.options,n)),i.find(".edui-toolbar").append($('<div class="edui-dialog-container"></div>')),i},createToolbar:function(e,t){var n=$.eduitoolbar(),r=n.edui();if(e.toolbar&&e.toolbar.length){var i=[];$.each(e.toolbar,function(e,t){$.each(t.split(/\s+/),function(e,t){if(t=="|")$.eduiseparator&&i.push($.eduiseparator());else{var n=o[t];t=="fullscreen"?n&&i.unshift(n):n&&i.push(n)}}),i.length&&r.appendToBtnmenu(i)})}else n.find(".edui-btn-toolbar").remove();return n}})}(),UM.registerUI("bold italic redo undo underline strikethrough superscript subscript insertorderedlist insertunorderedlist cleardoc selectall link unlink print preview justifyleft justifycenter justifyright justifyfull removeformat horizontal drafts settitle uploadimg 360map",function(e){var t=this,n=$.eduibutton({icon:e,click:function(){t.execCommand(e)},title:this.getLang("labelMap")[e]||""});return this.addListener("selectionchange",function(){var t=this.queryCommandState(e);n.edui().disabled(t==-1).active(t==1)}),n}),function(){function i(e){var t=this;if(!e)throw new Error("invalid params, notfound editor");t.editor=e,FULLSCREENS[e.uid]=this,e.addListener("destroy",function(){delete FULLSCREENS[e.uid],t.editor=null})}var e={},t={},n=0;STATUS_LIST=["width","height","minHeight","position","top","left","margin","padding","overflowX","overflowY"],CONTENT_AREA_STATUS={},DOCUMENT_STATUS={},DOCUMENT_ELEMENT_STATUS={},FULLSCREENS={};var r=Wenda.Info;UM.registerUI("fullscreen",function(e){var t=this,n=$.eduibutton({icon:"fullscreen",title:t.options.labelMap&&t.options.labelMap[e]||t.getLang("labelMap."+e),click:function(){t.execCommand(e),UM.setTopEditor(t)}});return t.addshortcutkey({fullscreen:"27:true"}),t.addListener("selectionchange",function(){var t=this.queryCommandState(e);n.edui().disabled(t==-1).active(t==1)}),t.addListener("ready",function(){t.options.fullscreen&&i.getInstance(t).toggle()}),n}),UM.commands.fullscreen={execCommand:function(e,t){var n=i.getInstance(this);t?n.isFullState()&&n.toggle():n.toggle()},queryCommandState:function(e){return this._edui_fullscreen_status},notNeedUndo:1},i.prototype={toggle:function(){var e=this.editor,t=this.isFullState();e.fireEvent("beforefullscreenchange",!t),this.update(!t),t?this.revert():this.enlarge(),e.focus(),e.fireEvent("afterfullscreenchange",!t),e.body.contentEditable==="true"&&e.fireEvent("fullscreenchanged",!t),e.fireEvent("selectionchange")},enlarge:function(){var e=this.editor,t=$(window);this.saveScrollTop(),this.saveWrapSataus(),this.saveSataus(),this.setDocumentStatus(),$(".js-umeditor-fullscreen").addClass("um-fullscreen");if(!$(".js-um-fullscreen-head").length){var n='<div class="um-fullscreen-head clearfix js-um-fullscreen-head"><div class="um-fullscreen-title g-ellipsis">'+r.askTitle+"</div>"+'<span class="btn btn-2">'+'<button type="button" class="js-added-submit" text="\u5168\u5c4f\u63d0\u4ea4'+r.askId+"-"+r.qid+'">\u63d0\u4ea4\u56de\u7b54</button>'+"</span>"+'<a href="#quit" text="\u56de\u7b54\u8f93\u5165\u6846\u2014\u201d\u9000\u51fa\u201c\u5168\u5c4f\u70b9\u51fb" class="quit-fullscreen-btn js-quit-fullscreen-btn"></a>'+"</div>";e.$container.parent().prepend(n)}$(".js-um-fullscreen-head").show(),$("#wenda-content-wrap").css({overflow:"hidden",height:0}),this.resize()},revert:function(){$(".js-umeditor-fullscreen").removeClass("um-fullscreen"),$(".js-um-fullscreen-head").hide();var e=this.editor,t=e.options,n=/%$/.test(t.initialFrameHeight)?"100%":t.initialFrameHeight-this.getStyleValue("padding-top")-this.getStyleValue("padding-bottom")-this.getStyleValue("border-width");$.IE6&&this.getEditorHolder().style.setExpression("height","this.scrollHeight <= "+n+' ? "'+n+'px" : "auto"'),$(".js-um-fullscreen-head").removeClass("fixed"),$(".edui-toolbar",e.container).removeAttr("style"),this.revertContainerWrapStatus(),this.revertContainerStatus(),this.revertContentAreaStatus(),this.revertDocumentStatus(),this.revertWindowScrollTop()},update:function(e){this.editor._edui_fullscreen_status=e},resize:function(){var e=null,t=0,n=0,r=0,i=0,s=0,o=this.editor,u=this,a=null,f=null;if(!this.isFullState())return;e=$(window),wrapWidth=e.width(),wrapHeight=e.height(),n=900,t=e.height()-10-$(".js-um-fullscreen-head").height()-$(".edui-toolbar",o.container).height(),f=this.getEditorHolder(),r=parseInt(domUtils.getComputedStyle(f,"border-width"),10)||0,r+=parseInt(domUtils.getComputedStyle(o.container,"border-width"),10)||0,i+=parseInt(domUtils.getComputedStyle(f,"padding-left"),10)+parseInt(domUtils.getComputedStyle(f,"padding-right"),10)||0,s+=parseInt(domUtils.getComputedStyle(f,"padding-top"),10)+parseInt(domUtils.getComputedStyle(f,"padding-bottom"),10)||0,$.IE6&&f.style.setExpression("height",null),a=this.getBound(),$(o.container).parents(".js-umeditor-wrap").css({width:wrapWidth+"px",position:"absolute",top:0,left:0,margin:0,padding:0,border:0,background:"#f6f7f7","z-index":100}),$(o.container).css({width:n+"px",minHeight:t+"px",margin:"0 auto",padding:"110px 0 0 0"}),$(f).css({width:n-2*r-i+"px",minHeight:t-2*r-$(".edui-bottombar",o.container).outerHeight()-s+"px"})},scroll:function(){if(!this.isFullState())return;var e=this.editor,t=$(window);t.scrollTop()>0?($(".js-um-fullscreen-head").css({top:0}),$(".edui-toolbar",e.container).css({top:"80px"})):($(".js-um-fullscreen-head").css({top:"5px"}),$(".edui-toolbar",e.container).css({top:"85px"}))},saveScrollTop:function(){var e=$(window).scrollTop();n=e},saveWrapSataus:function(){var e=this.editor,n=$(e.container).parents(".js-umeditor-wrap").attr("style");t[this.editor.uid]=n},saveSataus:function(){var t=this.editor.container.style,n=null,r={};for(var i=0,s=STATUS_LIST.length;i<s;i++)n=STATUS_LIST[i],r[n]=t[n];e[this.editor.uid]=r,this.saveContentAreaStatus(),this.saveDocumentStatus()},saveContentAreaStatus:function(){var e=$(this.getEditorHolder());CONTENT_AREA_STATUS[this.editor.uid]={width:e.css("width"),"min-height":e.css("height")}},saveDocumentStatus:function(){var e=$(this.getEditorDocumentBody());DOCUMENT_STATUS[this.editor.uid]={overflowX:e.css("overflowX"),overflowY:e.css("overflowY")},DOCUMENT_ELEMENT_STATUS[this.editor.uid]={overflowX:$(this.getEditorDocumentElement()).css("overflowX"),overflowY:$(this.getEditorDocumentElement()).css("overflowY")}},revertWindowScrollTop:function(){$(window).scrollTop(n)},revertContainerWrapStatus:function(){$(this.editor.container).parents(".js-umeditor-wrap").attr("style",this.getEditorWrapStatus()),$("#wenda-content-wrap").removeAttr("style")},revertContainerStatus:function(){$(this.editor.container).css(this.getEditorStatus())},revertContentAreaStatus:function(){var e=this.getEditorHolder(),t=this.getContentAreaStatus();this.supportMin()&&(delete t.height,e.style.height=null),$(e).css(t)},revertDocumentStatus:function(){var e=this.getDocumentStatus();$(this.getEditorDocumentBody()).css("overflowX",e.body.overflowX),$(this.getEditorDocumentElement()).css("overflowY",e.html.overflowY)},setDocumentStatus:function(){$(this.getEditorDocumentBody()).css({overflowX:"hidden"}),$(this.getEditorDocumentElement()).css({overflowX:"hidden"})},isFullState:function(){return!!this.editor._edui_fullscreen_status},getEditorWrapStatus:function(){return t[this.editor.uid]},getEditorStatus:function(){return e[this.editor.uid]},getContentAreaStatus:function(){return CONTENT_AREA_STATUS[this.editor.uid]},getEditorDocumentElement:function(){return this.editor.container.ownerDocument.documentElement},getEditorDocumentBody:function(){return this.editor.container.ownerDocument.body},getEditorHolder:function(){return this.editor.body},getDocumentStatus:function(){return{body:DOCUMENT_STATUS[this.editor.uid],html:DOCUMENT_ELEMENT_STATUS[this.editor.uid]}},supportMin:function(){var e=null;return this._support||(e=document.createElement("div"),this._support="minWidth"in e.style,e=null),this._support},getBound:function(){var e={html:!0,body:!0},t={top:0,left:0},n=null;return $.IE6?(n=this.editor.container.offsetParent,n&&!e[n.nodeName.toLowerCase()]&&(e=n.getBoundingClientRect(),t.top=-e.top,t.left=-e.left),t):t},getStyleValue:function(e){return parseInt(domUtils.getComputedStyle(this.getEditorHolder(),e))}},$.extend(i,{listen:function(){var e=null,t=null;if(i._hasFullscreenListener)return;i._hasFullscreenListener=!0;var n=$(window);n.on("resize",function(){e!==null&&(window.clearTimeout(e),e=null),e=window.setTimeout(function(){for(var t in FULLSCREENS)FULLSCREENS[t].resize();e=null},50)}),n.on("scroll",function(e){t||(clearTimeout(t),t=null),t=setTimeout(function(){for(var e in FULLSCREENS)FULLSCREENS[e].scroll()},50)})},getInstance:function(e){return FULLSCREENS[e.uid]||new i(e),FULLSCREENS[e.uid]}}),i.listen()}(),$.extend(namespace("Wenda.UMeditor"),function(){function f(){Cookie.get("WDUMFULLSCREEN")||Cookie.set("WDUMFULLSCREEN",1,{expires:31536e6,path:"/"}),$(".js-fullscreen-tips").length&&$(".js-fullscreen-tips").hide()}function c(e){e.onready(function(){var t=$("#js-um-uploadimg-tpl").html();e.UM.$container.find(".edui-toolbar").append(t);var n=new l(e),i={uploadStarted:function(e){n.insert(e.id)},uploadSuccess:function(e,t){n.finish(t.id,e)}},s=$.extend(!0,{},e.uploadImgOpt,i);setTimeout(function(){r.init(s)},0),$(".js-um-uploadimg").hover(function(e){$(".edui-btn-uploadimg").trigger("mouseenter"),u&&clearTimeout(u)},function(e){u=setTimeout(function(){$(".edui-btn-uploadimg").trigger("mouseleave"),$.Browser.ie&&$(".edui-btn-uploadimg").removeClass("edui-hover")},20)})})}function h(e,t,n){if(!e||!n)return;var s=new l(e),o={uploadStarted:function(e){s.insert(e.id)},uploadSuccess:function(e,t){s.finish(t.id,e)},uploadError:function(e,t){i.alert(t||"\u4e0a\u4f20\u5931\u8d25",e)}},u=$.extend(!0,{},o,t||{});r.autoLoadImg(u,n)}function p(e,t){if(!$("#"+e).length)return;return new a(e,t)}function d(e){return t[e]}var e={},t={},n={min:5,max:1e4,umeditorOpt:{initialContent:"\u6b22\u8fce\u4f7f\u7528\u7f16\u8f91\u5668",definedToolbar:["search fullscreen help"],autoClearinitialContent:!0,zIndex:0},uploadImgOpt:{}},r=Wenda.UploadImg,i=Wenda.Panel,s=Wenda.Info,o=Wenda.Log,u=null,a=function(){function e(e,t){this.container=e,this.options=$.extend(!0,{},n,t||{}),this._init()}return e.prototype={_init:function(){var e=this;e.UM=UM.getEditor(e.container,e.options.umeditorOpt),t[e.UM.id]=e,e.options.umeditorOpt.toolbar[0].indexOf("uploadimg")>-1&&c(e),!e.options.umeditorOpt.definedToolbar[0]||e.onready(function(){e._definedToolbarUI()})},UM:function(){return me.UM},getAllHtml:function(){return this.UM.getAllHtml()},getContent:function(){return this.UM.getContent()},getContentTxt:function(){return this.UM.getContentTxt()},getPlainTxt:function(){return this.UM.getPlainTxt()},getContentLength:function(e){var t=0;return this.getContentTxt()!=this.options.umeditorOpt.initialContent&&(t=this.UM.getContentLength(!0,e)),t},isLimit:function(e){return this.getContentLength(e)>=this.options.min&&this.getContentLength(e)<=this.options.max?!0:!1},insertHtml:function(e,t){this.UM.execCommand("inserthtml",e,t)},setContent:function(e,t){return this.UM.setContent(e,t)},hasContents:function(e){var t=this,n=!1,r=t.UM.getContent(),i=t.UM.getContentTxt();return e&&e.length&&$.each(e,function(e,r){if($(t.UM.body).find(r).length>0)return n=!0,!0}),$.trim(i).length>0&&i!=t.options.umeditorOpt.initialContent&&(n=!0),n},verify:function(e){return this.hasContents(e)&&this.isLimit(e)},setFocus:function(e){this.UM.focus(e)},isFocus:function(){return this.UM.isFocus()},doBlur:function(){this.UM.blur()},setEnabled:function(){this.UM.setEnabled()},setDisabled:function(e,t){this.UM.setDisabled(e,t)},setHide:function(){this.UM.setHide()},setShow:function(){this.UM.setShow()},isFullState:function(){return this.UM._edui_fullscreen_status||!1},setFullScreen:function(){this.UM.execCommand("fullscreen")},onready:function(e){$.isFunction(e)&&this.UM.ready(e)},_definedToolbarUI:function(){var e=this,t=e.options.umeditorOpt.definedToolbar[0].split(" "),n='<div class="d-um-opt js-um-opt">';$.each(t,function(t,r){switch(r){case"search":var i="http://www."+s.root_domain+"/s?q="+encodeURIComponent(s.askTitle)+"&src=wenda_detail_toolbar";n+='<div class="d-um-opt-btn topbar-search-btn"><a target="_blank" text="\u56de\u7b54\u8f93\u5165\u6846\u2014\u201c\u641c\u8d44\u6599\u201d\u70b9\u51fb" href="'+i+'">\u641c\u8d44\u6599</a></div>';break;case"fullscreen":$.Browser.msie!="6.0"&&$.Browser.msie!="7.0"&&(n+='<div class="d-um-opt-btn topbar-fullscreen-btn js-um-fullscreen-btn"><a href="#fullscreen" text="\u56de\u7b54\u8f93\u5165\u6846\u2014\u201d\u5168\u5c4f\u201c\u70b9\u51fb">\u5168\u5c4f</a></div>',e._bindFullScreenEvent());break;case"help":n+='<div class="d-um-opt-btn topbar-help-btn js-um-help-btn"><a href="#help" text="\u56de\u7b54\u8f93\u5165\u6846\u2014\u201d\u5e2e\u52a9\u201c\u70b9\u51fb">\u5e2e\u52a9</a></div>',e._bindHelpEvent();default:}}),n+="</div>",e.UM.$container.find(".edui-toolbar").append(n)},_bindFullScreenEvent:function(){var e=this;$(".js-umeditor-wrap").on("click",".js-um-fullscreen-btn, .js-quit-fullscreen-btn",function(t){t.preventDefault(),f(),e.setFullScreen()}),$(".js-fullscreen-tips").click(function(e){e.preventDefault(),$(".js-um-fullscreen-btn").trigger("click"),o.sendShowLog("\u56de\u7b54\u8f93\u5165\u6846\u2014\u201d\u5168\u5c4f\u201c\u70b9\u51fb")}),$(".edui-body-container").focus(function(e){f()})},_bindHelpEvent:function(){$(".js-umeditor-wrap").on("click",".js-um-help-btn",function(e){e.preventDefault(),e.stopImmediatePropagation();if(!$(".js-um-help").length){var t='<div class="um-help js-um-help"><span class="border-arrow"><i></i></span><dl><dt>\u8fd9\u6837\u56de\u7b54\u66f4\u5bb9\u6613\u88ab\u91c7\u7eb3\u54e6~</dt><dd><ul><li>\u2460&nbsp;\u5185\u5bb9\u4f18\u8d28\uff1a\u76f4\u63a5\u56de\u7b54\u95ee\u9898\u5e76\u8be6\u7ec6\u8bf4\u660e\u539f\u56e0\uff1b</li><li>\u2461&nbsp;\u6392\u7248\u6574\u6d01\uff1a\u6807\u9898\u3001\u6b65\u9aa4\u6e05\u6670\uff1b</li><li>\u2462&nbsp;\u56fe\u6587\u5e76\u8302\uff1a\u6839\u636e\u9700\u8981\u6dfb\u52a0\u56fe\u7247\uff0c\u56fe\u7247\u5185\u5bb9\u7d27\u6263\u95ee\u9898\u3002</li></ul></dd></dl></div>';$(".js-um-help-btn").append(t)}$(".js-um-help").toggle()}),$(".js-umeditor-wrap").on("click",function(){$(".js-um-help").length&&$(".js-um-help").hide()})}},e}(),l=function(){function e(e){this.umeditor=e}return e.prototype={insert:function(e){this.umeditor.insertHtml('<img id="'+e+'" src="http://p6.qhmsg.com/t01798cd1a6b1065192.gif"/>')},finish:function(e,t){var n=this._getLoadingImg(e);if(!n.length)return;t.errno==0?(n.remove(),this.umeditor.insertHtml('<img src="'+t.data.url+'" data-size="'+t.data.size+'"/>'),this.umeditor.setFocus()):this.failed(e)},failed:function(e){var t=this._getLoadingImg(e);if(!t.length)return;t.remove(),this.umeditor.insertHtml('<img src="http://p1.qhmsg.com/t01383134a68d72f138.png"/>')},_getLoadingImg:function(e){return $(this.umeditor.UM.body).find("#"+e)}},e}();return e.create=p,e.get=d,e.autoUpload=h,e}());var QRCode;(function(){function e(e){this.mode=n.MODE_8BIT_BYTE,this.data=e,this.parsedData=[];for(var t=0,r=this.data.length;t<r;t++){var i=[],s=this.data.charCodeAt(t);s>65536?(i[0]=240|(s&1835008)>>>18,i[1]=128|(s&258048)>>>12,i[2]=128|(s&4032)>>>6,i[3]=128|s&63):s>2048?(i[0]=224|(s&61440)>>>12,i[1]=128|(s&4032)>>>6,i[2]=128|s&63):s>128?(i[0]=192|(s&1984)>>>6,i[1]=128|s&63):i[0]=s,this.parsedData.push(i)}this.parsedData=Array.prototype.concat.apply([],this.parsedData),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}function t(e,t){this.typeNumber=e,this.errorCorrectLevel=t,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}function a(e,t){if(e.length==undefined)throw new Error(e.length+"/"+t);var n=0;while(n<e.length&&e[n]==0)n++;this.num=new Array(e.length-n+t);for(var r=0;r<e.length-n;r++)this.num[r]=e[r+n]}function f(e,t){this.totalCount=e,this.dataCount=t}function l(){this.buffer=[],this.length=0}function h(){return typeof CanvasRenderingContext2D!="undefined"}function p(){var e=!1,t=navigator.userAgent;return/android/i.test(t)&&(e=!0,aMat=t.toString().match(/android ([0-9]\.[0-9])/i),aMat&&aMat[1]&&(e=parseFloat(aMat[1]))),e}function g(e,t){var n=1,i=y(e);for(var s=0,o=c.length;s<=o;s++){var u=0;switch(t){case r.L:u=c[s][0];break;case r.M:u=c[s][1];break;case r.Q:u=c[s][2];break;case r.H:u=c[s][3]}if(i<=u)break;n++}if(n>c.length)throw new Error("Too long data");return n}function y(e){var t=encodeURI(e).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return t.length+(t.length!=e?3:0)}e.prototype={getLength:function(e){return this.parsedData.length},write:function(e){for(var t=0,n=this.parsedData.length;t<n;t++)e.put(this.parsedData[t],8)}},t.prototype={addData:function(t){var n=new e(t);this.dataList.push(n),this.dataCache=null},isDark:function(e,t){if(e<0||this.moduleCount<=e||t<0||this
.moduleCount<=t)throw new Error(e+","+t);return this.modules[e][t]},getModuleCount:function(){return this.moduleCount},make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(e,n){this.moduleCount=this.typeNumber*4+17,this.modules=new Array(this.moduleCount);for(var r=0;r<this.moduleCount;r++){this.modules[r]=new Array(this.moduleCount);for(var i=0;i<this.moduleCount;i++)this.modules[r][i]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(e,n),this.typeNumber>=7&&this.setupTypeNumber(e),this.dataCache==null&&(this.dataCache=t.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,n)},setupPositionProbePattern:function(e,t){for(var n=-1;n<=7;n++){if(e+n<=-1||this.moduleCount<=e+n)continue;for(var r=-1;r<=7;r++){if(t+r<=-1||this.moduleCount<=t+r)continue;0<=n&&n<=6&&(r==0||r==6)||0<=r&&r<=6&&(n==0||n==6)||2<=n&&n<=4&&2<=r&&r<=4?this.modules[e+n][t+r]=!0:this.modules[e+n][t+r]=!1}}},getBestMaskPattern:function(){var e=0,t=0;for(var n=0;n<8;n++){this.makeImpl(!0,n);var r=s.getLostPoint(this);if(n==0||e>r)e=r,t=n}return t},createMovieClip:function(e,t,n){var r=e.createEmptyMovieClip(t,n),i=1;this.make();for(var s=0;s<this.modules.length;s++){var o=s*i;for(var u=0;u<this.modules[s].length;u++){var a=u*i,f=this.modules[s][u];f&&(r.beginFill(0,100),r.moveTo(a,o),r.lineTo(a+i,o),r.lineTo(a+i,o+i),r.lineTo(a,o+i),r.endFill())}}return r},setupTimingPattern:function(){for(var e=8;e<this.moduleCount-8;e++){if(this.modules[e][6]!=null)continue;this.modules[e][6]=e%2==0}for(var t=8;t<this.moduleCount-8;t++){if(this.modules[6][t]!=null)continue;this.modules[6][t]=t%2==0}},setupPositionAdjustPattern:function(){var e=s.getPatternPosition(this.typeNumber);for(var t=0;t<e.length;t++)for(var n=0;n<e.length;n++){var r=e[t],i=e[n];if(this.modules[r][i]!=null)continue;for(var o=-2;o<=2;o++)for(var u=-2;u<=2;u++)o==-2||o==2||u==-2||u==2||o==0&&u==0?this.modules[r+o][i+u]=!0:this.modules[r+o][i+u]=!1}},setupTypeNumber:function(e){var t=s.getBCHTypeNumber(this.typeNumber);for(var n=0;n<18;n++){var r=!e&&(t>>n&1)==1;this.modules[Math.floor(n/3)][n%3+this.moduleCount-8-3]=r}for(var n=0;n<18;n++){var r=!e&&(t>>n&1)==1;this.modules[n%3+this.moduleCount-8-3][Math.floor(n/3)]=r}},setupTypeInfo:function(e,t){var n=this.errorCorrectLevel<<3|t,r=s.getBCHTypeInfo(n);for(var i=0;i<15;i++){var o=!e&&(r>>i&1)==1;i<6?this.modules[i][8]=o:i<8?this.modules[i+1][8]=o:this.modules[this.moduleCount-15+i][8]=o}for(var i=0;i<15;i++){var o=!e&&(r>>i&1)==1;i<8?this.modules[8][this.moduleCount-i-1]=o:i<9?this.modules[8][15-i-1+1]=o:this.modules[8][15-i-1]=o}this.modules[this.moduleCount-8][8]=!e},mapData:function(e,t){var n=-1,r=this.moduleCount-1,i=7,o=0;for(var u=this.moduleCount-1;u>0;u-=2){u==6&&u--;for(;;){for(var a=0;a<2;a++)if(this.modules[r][u-a]==null){var f=!1;o<e.length&&(f=(e[o]>>>i&1)==1);var l=s.getMask(t,r,u-a);l&&(f=!f),this.modules[r][u-a]=f,i--,i==-1&&(o++,i=7)}r+=n;if(r<0||this.moduleCount<=r){r-=n,n=-n;break}}}}},t.PAD0=236,t.PAD1=17,t.createData=function(e,n,r){var i=f.getRSBlocks(e,n),o=new l;for(var u=0;u<r.length;u++){var a=r[u];o.put(a.mode,4),o.put(a.getLength(),s.getLengthInBits(a.mode,e)),a.write(o)}var c=0;for(var u=0;u<i.length;u++)c+=i[u].dataCount;if(o.getLengthInBits()>c*8)throw new Error("code length overflow. ("+o.getLengthInBits()+">"+c*8+")");o.getLengthInBits()+4<=c*8&&o.put(0,4);while(o.getLengthInBits()%8!=0)o.putBit(!1);for(;;){if(o.getLengthInBits()>=c*8)break;o.put(t.PAD0,8);if(o.getLengthInBits()>=c*8)break;o.put(t.PAD1,8)}return t.createBytes(o,i)},t.createBytes=function(e,t){var n=0,r=0,i=0,o=new Array(t.length),u=new Array(t.length);for(var f=0;f<t.length;f++){var l=t[f].dataCount,c=t[f].totalCount-l;r=Math.max(r,l),i=Math.max(i,c),o[f]=new Array(l);for(var h=0;h<o[f].length;h++)o[f][h]=255&e.buffer[h+n];n+=l;var p=s.getErrorCorrectPolynomial(c),d=new a(o[f],p.getLength()-1),v=d.mod(p);u[f]=new Array(p.getLength()-1);for(var h=0;h<u[f].length;h++){var m=h+v.getLength()-u[f].length;u[f][h]=m>=0?v.get(m):0}}var g=0;for(var h=0;h<t.length;h++)g+=t[h].totalCount;var y=new Array(g),b=0;for(var h=0;h<r;h++)for(var f=0;f<t.length;f++)h<o[f].length&&(y[b++]=o[f][h]);for(var h=0;h<i;h++)for(var f=0;f<t.length;f++)h<u[f].length&&(y[b++]=u[f][h]);return y};var n={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},r={L:1,M:0,Q:3,H:2},i={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},s={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(e){var t=e<<10;while(s.getBCHDigit(t)-s.getBCHDigit(s.G15)>=0)t^=s.G15<<s.getBCHDigit(t)-s.getBCHDigit(s.G15);return(e<<10|t)^s.G15_MASK},getBCHTypeNumber:function(e){var t=e<<12;while(s.getBCHDigit(t)-s.getBCHDigit(s.G18)>=0)t^=s.G18<<s.getBCHDigit(t)-s.getBCHDigit(s.G18);return e<<12|t},getBCHDigit:function(e){var t=0;while(e!=0)t++,e>>>=1;return t},getPatternPosition:function(e){return s.PATTERN_POSITION_TABLE[e-1]},getMask:function(e,t,n){switch(e){case i.PATTERN000:return(t+n)%2==0;case i.PATTERN001:return t%2==0;case i.PATTERN010:return n%3==0;case i.PATTERN011:return(t+n)%3==0;case i.PATTERN100:return(Math.floor(t/2)+Math.floor(n/3))%2==0;case i.PATTERN101:return t*n%2+t*n%3==0;case i.PATTERN110:return(t*n%2+t*n%3)%2==0;case i.PATTERN111:return(t*n%3+(t+n)%2)%2==0;default:throw new Error("bad maskPattern:"+e)}},getErrorCorrectPolynomial:function(e){var t=new a([1],0);for(var n=0;n<e;n++)t=t.multiply(new a([1,o.gexp(n)],0));return t},getLengthInBits:function(e,t){if(1<=t&&t<10)switch(e){case n.MODE_NUMBER:return 10;case n.MODE_ALPHA_NUM:return 9;case n.MODE_8BIT_BYTE:return 8;case n.MODE_KANJI:return 8;default:throw new Error("mode:"+e)}else if(t<27)switch(e){case n.MODE_NUMBER:return 12;case n.MODE_ALPHA_NUM:return 11;case n.MODE_8BIT_BYTE:return 16;case n.MODE_KANJI:return 10;default:throw new Error("mode:"+e)}else{if(!(t<41))throw new Error("type:"+t);switch(e){case n.MODE_NUMBER:return 14;case n.MODE_ALPHA_NUM:return 13;case n.MODE_8BIT_BYTE:return 16;case n.MODE_KANJI:return 12;default:throw new Error("mode:"+e)}}},getLostPoint:function(e){var t=e.getModuleCount(),n=0;for(var r=0;r<t;r++)for(var i=0;i<t;i++){var s=0,o=e.isDark(r,i);for(var u=-1;u<=1;u++){if(r+u<0||t<=r+u)continue;for(var a=-1;a<=1;a++){if(i+a<0||t<=i+a)continue;if(u==0&&a==0)continue;o==e.isDark(r+u,i+a)&&s++}}s>5&&(n+=3+s-5)}for(var r=0;r<t-1;r++)for(var i=0;i<t-1;i++){var f=0;e.isDark(r,i)&&f++,e.isDark(r+1,i)&&f++,e.isDark(r,i+1)&&f++,e.isDark(r+1,i+1)&&f++;if(f==0||f==4)n+=3}for(var r=0;r<t;r++)for(var i=0;i<t-6;i++)e.isDark(r,i)&&!e.isDark(r,i+1)&&e.isDark(r,i+2)&&e.isDark(r,i+3)&&e.isDark(r,i+4)&&!e.isDark(r,i+5)&&e.isDark(r,i+6)&&(n+=40);for(var i=0;i<t;i++)for(var r=0;r<t-6;r++)e.isDark(r,i)&&!e.isDark(r+1,i)&&e.isDark(r+2,i)&&e.isDark(r+3,i)&&e.isDark(r+4,i)&&!e.isDark(r+5,i)&&e.isDark(r+6,i)&&(n+=40);var l=0;for(var i=0;i<t;i++)for(var r=0;r<t;r++)e.isDark(r,i)&&l++;var c=Math.abs(100*l/t/t-50)/5;return n+=c*10,n}},o={glog:function(e){if(e<1)throw new Error("glog("+e+")");return o.LOG_TABLE[e]},gexp:function(e){while(e<0)e+=255;while(e>=256)e-=255;return o.EXP_TABLE[e]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)};for(var u=0;u<8;u++)o.EXP_TABLE[u]=1<<u;for(var u=8;u<256;u++)o.EXP_TABLE[u]=o.EXP_TABLE[u-4]^o.EXP_TABLE[u-5]^o.EXP_TABLE[u-6]^o.EXP_TABLE[u-8];for(var u=0;u<255;u++)o.LOG_TABLE[o.EXP_TABLE[u]]=u;a.prototype={get:function(e){return this.num[e]},getLength:function(){return this.num.length},multiply:function(e){var t=new Array(this.getLength()+e.getLength()-1);for(var n=0;n<this.getLength();n++)for(var r=0;r<e.getLength();r++)t[n+r]^=o.gexp(o.glog(this.get(n))+o.glog(e.get(r)));return new a(t,0)},mod:function(e){if(this.getLength()-e.getLength()<0)return this;var t=o.glog(this.get(0))-o.glog(e.get(0)),n=new Array(this.getLength());for(var r=0;r<this.getLength();r++)n[r]=this.get(r);for(var r=0;r<e.getLength();r++)n[r]^=o.gexp(o.glog(e.get(r))+t);return(new a(n,0)).mod(e)}},f.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],f.getRSBlocks=function(e,t){var n=f.getRsBlockTable(e,t);if(n==undefined)throw new Error("bad rs block @ typeNumber:"+e+"/errorCorrectLevel:"+t);var r=n.length/3,i=[];for(var s=0;s<r;s++){var o=n[s*3+0],u=n[s*3+1],a=n[s*3+2];for(var l=0;l<o;l++)i.push(new f(u,a))}return i},f.getRsBlockTable=function(e,t){switch(t){case r.L:return f.RS_BLOCK_TABLE[(e-1)*4+0];case r.M:return f.RS_BLOCK_TABLE[(e-1)*4+1];case r.Q:return f.RS_BLOCK_TABLE[(e-1)*4+2];case r.H:return f.RS_BLOCK_TABLE[(e-1)*4+3];default:return undefined}},l.prototype={get:function(e){var t=Math.floor(e/8);return(this.buffer[t]>>>7-e%8&1)==1},put:function(e,t){for(var n=0;n<t;n++)this.putBit((e>>>t-n-1&1)==1)},getLengthInBits:function(){return this.length},putBit:function(e){var t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}};var c=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]],d=function(){var e=function(e,t){this._el=e,this._htOption=t};return e.prototype.draw=function(e){function o(e,t){var n=document.createElementNS("http://www.w3.org/2000/svg",e);for(var r in t)t.hasOwnProperty(r)&&n.setAttribute(r,t[r]);return n}var t=this._htOption,n=this._el,r=e.getModuleCount(),i=Math.floor(t.width/r),s=Math.floor(t.height/r);this.clear();var u=o("svg",{viewBox:"0 0 "+String(r)+" "+String(r),width:"100%",height:"100%",fill:t.colorLight});u.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),n.appendChild(u),u.appendChild(o("rect",{fill:t.colorDark,width:"1",height:"1",id:"template"}));for(var a=0;a<r;a++)for(var f=0;f<r;f++)if(e.isDark(a,f)){var l=o("use",{x:String(a),y:String(f)});l.setAttributeNS("http://www.w3.org/1999/xlink","href","#template"),u.appendChild(l)}},e.prototype.clear=function(){while(this._el.hasChildNodes())this._el.removeChild(this._el.lastChild)},e}(),v=document.documentElement.tagName.toLowerCase()==="svg",m=v?d:h()?function(){function e(){this._elImage.src=this._elCanvas.toDataURL("image/png"),this._elImage.style.display="block",this._elCanvas.style.display="none"}function r(e,t){var n=this;n._fFail=t,n._fSuccess=e;if(n._bSupportDataURI===null){var r=document.createElement("img"),i=function(){n._bSupportDataURI=!1,n._fFail&&_fFail.call(n)},s=function(){n._bSupportDataURI=!0,n._fSuccess&&n._fSuccess.call(n)};r.onabort=i,r.onerror=i,r.onload=s,r.src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==";return}n._bSupportDataURI===!0&&n._fSuccess?n._fSuccess.call(n):n._bSupportDataURI===!1&&n._fFail&&n._fFail.call(n)}if(this._android&&this._android<=2.1){var t=1/window.devicePixelRatio,n=CanvasRenderingContext2D.prototype.drawImage;CanvasRenderingContext2D.prototype.drawImage=function(e,r,i,s,o,u,a,f,l){if("nodeName"in e&&/img/i.test(e.nodeName))for(var c=arguments.length-1;c>=1;c--)arguments[c]=arguments[c]*t;else typeof f=="undefined"&&(arguments[1]*=t,arguments[2]*=t,arguments[3]*=t,arguments[4]*=t);n.apply(this,arguments)}}var i=function(e,t){this._bIsPainted=!1,this._android=p(),this._htOption=t,this._elCanvas=document.createElement("canvas"),this._elCanvas.width=t.width,this._elCanvas.height=t.height,e.appendChild(this._elCanvas),this._el=e,this._oContext=this._elCanvas.getContext("2d"),this._bIsPainted=!1,this._elImage=document.createElement("img"),this._elImage.alt="Scan me!",this._elImage.style.display="none",this._el.appendChild(this._elImage),this._bSupportDataURI=null};return i.prototype.draw=function(e){var t=this._elImage,n=this._oContext,r=this._htOption,i=e.getModuleCount(),s=r.width/i,o=r.height/i,u=Math.round(s),a=Math.round(o);t.style.display="none",this.clear();for(var f=0;f<i;f++)for(var l=0;l<i;l++){var c=e.isDark(f,l),h=l*s,p=f*o;n.strokeStyle=c?r.colorDark:r.colorLight,n.lineWidth=1,n.fillStyle=c?r.colorDark:r.colorLight,n.fillRect(h,p,s,o),n.strokeRect(Math.floor(h)+.5,Math.floor(p)+.5,u,a),n.strokeRect(Math.ceil(h)-.5,Math.ceil(p)-.5,u,a)}this._bIsPainted=!0},i.prototype.makeImage=function(){this._bIsPainted&&r.call(this,e)},i.prototype.isPainted=function(){return this._bIsPainted},i.prototype.clear=function(){this._oContext.clearRect(0,0,this._elCanvas.width,this._elCanvas.height),this._bIsPainted=!1},i.prototype.round=function(e){return e?Math.floor(e*1e3)/1e3:e},i}():function(){var e=function(e,t){this._el=e,this._htOption=t};return e.prototype.draw=function(e){var t=this._htOption,n=this._el,r=e.getModuleCount(),i=Math.floor(t.width/r),s=Math.floor(t.height/r),o=['<table style="border:0;border-collapse:collapse;">'];for(var u=0;u<r;u++){o.push("<tr>");for(var a=0;a<r;a++)o.push('<td style="border:0;border-collapse:collapse;padding:0;margin:0;width:'+i+"px;height:"+s+"px;background-color:"+(e.isDark(u,a)?t.colorDark:t.colorLight)+';"></td>');o.push("</tr>")}o.push("</table>"),n.innerHTML=o.join("");var f=n.childNodes[0],l=(t.width-f.offsetWidth)/2,c=(t.height-f.offsetHeight)/2;l>0&&c>0&&(f.style.margin=c+"px "+l+"px")},e.prototype.clear=function(){this._el.innerHTML=""},e}();QRCode=function(e,t){this._htOption={width:256,height:256,typeNumber:4,colorDark:"#000000",colorLight:"#ffffff",correctLevel:r.H},typeof t=="string"&&(t={text:t});if(t)for(var n in t)this._htOption[n]=t[n];typeof e=="string"&&(e=document.getElementById(e)),this._android=p(),this._el=e,this._oQRCode=null,this._oDrawing=new m(this._el,this._htOption),this._htOption.text&&this.makeCode(this._htOption.text)},QRCode.prototype.makeCode=function(e){this._oQRCode=new t(g(e,this._htOption.correctLevel),this._htOption.correctLevel),this._oQRCode.addData(e),this._oQRCode.make(),this._oDrawing.draw(this._oQRCode),this.makeImage()},QRCode.prototype.makeImage=function(){typeof this._oDrawing.makeImage=="function"&&(!this._android||this._android>=3)&&this._oDrawing.makeImage()},QRCode.prototype.clear=function(){this._oDrawing.clear()},QRCode.CorrectLevel=r})(),Object.mix(namespace("Wenda.Detail.Panel"),function(){var e=Wenda.Panel,t={accept:function(t,n,r,i,s,o,u){t=t||"Ta";var a={fixed:!0,skin:"panel-02 pannel-accept-a",content:"<h3>\u60a8\u91c7\u7eb3\u4e86<b>"+t+"</b>\u7684\u56de\u7b54</h3>"+"<p>"+u+"</p>"+'<div><span class="btn btn-2"><button id="'+o+'">'+s+'</button></span><a id="thanks_btn" href="javascript:;" style="color:#3fb20e">\u4e0d\uff0c\u8c22\u8c22</a></div>',header:"<h3>\u91c7\u7eb3\u6210\u529f</h3>"},f={fixed:!0,skin:"panel-02 pannel-send-gift",content:'<h3>\u4eb2\uff0c\u60a8\u7684\u80af\u5b9a\u662fTa\u7ee7\u7eed\u52aa\u529b\u7684\u6700\u5f3a\u52a8\u529b\u54e6\uff01</h3><div class="gift-list"><ul class="clearfix" id="gift_list"><li><a href="javascript:;" gifttype="1" class="pic" word="\u725b\u4ec1\uff0c\u60a8\u7684\u56de\u7b54\u771f\u662f\u592a\u68d2\u4e86\uff0c\u4f5c\u4e3a\u7c89\u4e1d\u6211\u9876\u60a8~"><img src="http://p1.qhmsg.com/t010ee53a1c3d8297d8.png"></a><p>\u9876\u725b\u4ec1</p></li><li><a href="javascript:;" gifttype="2" class="pic on" word="\u597d\u5e05\u7684\u56de\u7b54\uff0c\u697c\u4e3b\u9001\u4e0a\u9999\u543b\u4e00\u679a\uff0c\u4ee5\u8868\u8bda\u631a\u8c22\u610f\uff01"><img src="http://p4.qhmsg.com/t0169190f5618ad4c78.png"></a><p>\u9001\u9999\u543b</p></li><li><a href="javascript:;" gifttype="3"  class="pic" word="\u4eb2\uff0c\u611f\u8c22\u60a8\u5e2e\u4e86\u6211\u5927\u5fd9\uff0c\u4e3a\u60a8\u4e0b\u4e00\u573a\u9c9c\u82b1\u96e8\uff01"><img src="http://p3.qhmsg.com/t017e3aee6dd181489f.png"></a><p>\u9c9c\u82b1\u96e8</p></li></ul></div><div class="ipt" ><span style="color:#888">\u8d60\u8a00\uff1a</span><span id="gift_word">\u597d\u5e05\u7684\u56de\u7b54\uff0c\u697c\u4e3b\u9001\u4e0a\u9999\u543b\u4e00\u679a\uff0c\u4ee5\u8868\u8bda\u631a\u8c22\u610f\uff01</span></div>',header:"<h3>\u9001TA\u793c\u7269</h3>",footer:'<span class="btn btn-2"><button id="thanks_submit_btn">\u63d0\u4ea4</button></span>'},l=e.show(a,450);return l.onremove=function(){location.reload()},W(".pannel-accept-a").query(".close").click(function(){l.remove()}),W("#thanks_btn").click(function(){l.close().remove()}),W("#gift_btn").click(function(){l.close();var t=e.show(f,450);t.onremove=function(){location.reload()},W("#gift_list").delegate(".pic","click",function(){var e=W(this);W("#gift_list").query(".pic").removeClass("on"),e.addClass("on"),W("#gift_word").html(e.attr("word"))}),W("#thanks_submit_btn").click(function(){var e=W("#gift_list").query(".on").attr("gifttype");if(!e)return Wenda.Panel.alert("\u8bf7\u9009\u62e9\u793c\u7269\uff01"),!1;Wenda.Net.connect("sendgift",{gifttype:e,ask_id:n,ans_id:r},function(){t.close(),setTimeout(function(){t.remove()},1e3),Wenda.Panel.steam({msg:"\u60a8\u7684\u793c\u7269\u5df2\u7ecf\u9001\u51fa",width:250,stayMs:3e3})})})}),W("#register_btn").click(function(){QHPass.signUp(function(){l.close().remove(),location.reload(!0)})}),l}};return t}()),$(function(){function i(t){var n=Wenda.Ask.Panel.cateSelect("\u8f6c\u79fb\u5230\u5206\u7c7b:",!1,function(n){var r=n.value,i=r.pop();Wenda.Net.connect("changecata",{ask_id:t,dcid:i},function(){e.steam({msg:"\u8f6c\u79fb\u6210\u529f",width:300},function(){location.reload()})})},"remove")}function s(){if($("#shenhe").length>0){Wenda.Log.send("detail-q-status",$("#shenhe").attr("data-status")),Wenda.Timer.countdown(5,function(e){$("#countdowntime").html(e)},function(){location="/"});return}}function o(t){t.preventDefault();var n=Wenda.Info.askId;Wenda.Net.connect("addHide",{ask_id:n},function(){e.steam({msg:"\u8ffd\u52a0\u533f\u540d\u6210\u529f",width:300},function(){location.reload()})})}function u(){var e=$(".js-mod-recom-q"),t=e.data("tag-id")||"",n=e.data("cid")||"",i=e.data("tag")||"",s="<\u7f51\u7ad9>\u3010\u8be6\u60c5\u9875\u53f3\u4fa7\u63a8\u8350\u95ee\u9898\u3011",o=!1;if(!n&&!t)return!1;Wenda.Info.qid?s+="<\u5df2\u767b\u5f55>":s+="<\u672a\u767b\u5f55>",Wenda.Info.isResolved?s+="<\u5df2\u89e3\u51b3>":s+="<\u672a\u89e3\u51b3>",t?s+="<\u6807\u7b7e>":n&&(s+="<\u5206\u7c7b>");var u={cid:n,tid:t,tag:i,ask_id:Wenda.Info.askId,pn:r,tpl:"ajax/detail/aside_rec_qus"},a={"-471":function(e){Wenda.Log.send(s+e.errmsg)}};Wenda.Ajax.get("asideQlist",u,function(t){var n="",i=s+"\u70b9\u51fb",u=o?"1000206":"1000201",a=s+"\u6210\u529f\u5c55\u73b0";t.result.detaillist.forEach(function(e){var t="";n+='<li><div class="q-content"><span class="wen">\u95ee\uff1a</span><a title="'+e.title+'" href="/q/'+e.ask_id+'" target="_blank" class="js-q" text="'+i+'_\u53f3\u4fa7" data-cid-pre="'+u+'">'+e.title.subByte(38,"...")+"</a>"+'<span class="time">'+e.answer_cnt+" \u56de\u7b54</span>"+"</div>"+"</li>"}),e.find(".q-l").html(n),r==0&&($(".js-recom-q-change").attr("text","\u8be6\u60c5\u9875\u201c\u7b54\u9898\u4e2d\u5927\u5956\u201c\u6362\u4e00\u6362\u70b9\u51fb-\u53f3\u4fa7"),$(".js-recom-q-more").attr("text","\u8be6\u60c5\u9875\u201c\u7b54\u9898\u4e2d\u5927\u5956\u201c\u67e5\u770b\u66f4\u591a\u70b9\u51fb-\u53f3\u4fa7")),e.show(),Wenda.Log.send(a)},a)}function a(e,t){function s(e){window.location="/q/"+e.data.ask_id}var n=e=="aside_ask_btn"?"aside_ask_con":"bottom_ask_con",r=$("#"+n),i=r.val().trim();if(i=="")r.focus();else if(t){var o="/home/ask?q="+encodeURIComponent(i)+"&ref=datail"+(n=="aside_ask_con"?1:2);setTimeout(function(){location.href=o},500)}else{var u=$(".panel-ask-layer #layer_ask_cid").val();$(".panel-ask-layer").length?Wenda.Asklayer.showOnlineDarens(u,i):Wenda.Asklayer.createAsklayerPanel(function(){Wenda.Asklayer.showOnlineDarens(u,i)},s)}}function f(){function e(e){var t=document.documentElement.scrollTop||document.body.scrollTop,n=document.documentElement.clientHeight,r=document.documentElement.scrollHeight,i=$("#bottom_ask");if(t+n>r-50){$("#bottom_ask:hidden").length>0&&Wenda.Log.send("js-detail","detail-ba-show"),$("#bottom_ask").show();var s=$("#js-mod-fixed-float"),o=$(".g-mod-fixed");s.length>0&&(s.data("bottom")||s.data("bottom",s.css("bottom").replace("px","")),s.css("bottom",parseInt(s.data("bottom"))+parseInt(i.height()))),o.length>0&&(o.data("bottom")||o.data("bottom",o.css("bottom").replace("px","")),o.css("bottom",parseInt(o.data("bottom"))+parseInt(i.height())))}}!Browser.ie6&&!Wenda.Info.asknum&&!Wenda.Info.ansnum&&Wenda.Info.isResolved&&($(window).on("scroll",e),$(".bottom-close").click(function(){$(window).unbind("scroll",e),$("#bottom_ask").hide()}))}function l(){Wenda.Menu.popup({id:"usercard",nav:$(".js-usercard"),aPanel:$(".card-steam"),delay:500,showFunc:function(e,t,n){n.aPanel&&n.aPanel.hide();var r=e.offset(),i=e.attr("index");return n.aPanel=$('.card-steam[index="'+i+'"]'),n.aPanel.css({left:r.left+"px",top:r.top+26+"px"}),n.aPanel.show(),!0}});var e=$("#usercard_box"),t='<div class="g-point g-point-top"><ins class="bg"></ins><ins class="border"></ins></div><div class="box"><div class="clearfix"><div class="info"><a text="\u8d44\u6599\u5361\u5934\u50cf\u70b9\u51fb\u91cf" target="_blank" href="/u/{$qid}" class="pic"><img src="{$logo}" /></a><i class="i-online" style="display:{$isOnline};">\u5728\u7ebf</i></div><div class="text {$warp}"><p class="name"><a text="\u8d44\u6599\u5361\u7528\u6237\u540d\u70b9\u51fb\u91cf" target="_blank" href="/u/{$qid}">{$name}</a>{$icon}</p><p>\u91c7\u7eb3\u7387\uff1a<em>{$sucessNum}%</em>&nbsp;&nbsp;\u7b49\u7ea7\uff1a<em>{$level}</em></p><p text="\u8d44\u6599\u5361\u95ee\u9898\u5e93\u5206\u7c7b\u70b9\u51fb\u91cf">\u64c5\u957f\u9886\u57df\uff1a{$cate}</p><p>\u5df2\u5e2e\u52a9\uff1a{$helpNum}\u4eba</p></div></div><div class="toolbar"><a href="#msg" data-toqid="{$qid}" data-username="{$username}" class="button button-2 js-send-message" style="margin-right:20px" text="\u79c1\u4fe1\u6d88\u606f_\u7528\u6237\u540d\u7247_\u79c1\u4fe1TA\u70b9\u51fb">\u79c1\u4fe1TA</a><a href="/home/ask?qid={$qid}" class="button button-2" data-cid-pre="1000201" text="\u8d44\u6599\u5361\u5b9a\u5411\u63d0\u95ee\u70b9\u51fb\u91cf">\u5411TA\u63d0\u95ee</a></div></div>',n={name:"getUserCard",opts:{url:"/home/getuserinfo",method:"get"}},r=function(r,i){var s=$('.card-steam[index="'+r+'"]',e);s.length==0&&(s=$('<div class="user-vcard card-steam card-ordinary" index="'+r+'"><p class="loading"><img src="http://p2.qhmsg.com/t010cb2cd69f5bc97ec.gif" />\u6b63\u5728\u52a0\u8f7d\uff0c\u8bf7\u7a0d\u540e...</p></div>').appendTo(e).hover(function(){Wenda.Timer.undelay("ordinaryCard")},function(){$(this).hide()})),s.find(".loading").length>0&&Wenda.Net.connect(n.name,{qid:r},function(e){e=e.data;var n=[],i=[],o=[];$.each(e.g_at_names||[],function(e,t){i.push('<a target="_blank" href="/c/'+e+'">'+t.name+"</a>"),o.push(t.name)}),e.is_qiye>0&&n.push('<i class="i-qy" title="\u5b98\u65b9\u8ba4\u8bc1"></i>'),e.is_daren>0&&n.push('<i class="i-daren" title="\u8fbe\u4eba"></i>'),e.role>0&&n.push('<i class="i-admin" title="\u7ba1\u7406\u5458"></i>'),e.has_education==1&&n.push('<i class="i-education" title="\u5b66\u5386"></i>'),s.html(t.tmpl({qid:r,logo:e.quc_info.imageUrl,name:e.quc_info.userName.subByte(16,"\u2026"),username:e.quc_info.userName,sucessNum:e.adoption,helpNum:e.rev_count,level:e.level_info.current_level,isOnline:e.is_online>0?"block":"none",icon:n.join(""),cate:i.length>0?i.join("\u3001"):"\u6682\u672a\u8bbe\u7f6e",warp:o.length>0&&("\u64c5\u957f\u9886\u57df\uff1a"+o.join("\u3001")).byteLen()>29?"warp":""})),Wenda.Log.send("\u79c1\u4fe1\u6d88\u606f_\u7528\u6237\u540d\u7247_\u540d\u7247\u5c55\u793a\u91cf")}),i(s)};Wenda.Net.add(n.name,n.opts),Wenda.Menu.popup({id:"ordinaryCard",nav:$(".js-ordinary-card"),aPanel:$(".card-steam"),delay:500,showFunc:function(e,t,n){n.aPanel&&n.aPanel.hide();var i=e.offset(),s=e.attr("index");return r(s,function(e){n.aPanel=e,n.aPanel.css({left:i.left+"px",top:i.top+26+"px"}),n.aPanel.show()}),!0}})}function c(){var e=$("#back_top"),t=location.href.queryUrl("cqid");$("#feedback_detail").click(function(e){e.preventDefault(),Wenda.Global.Panel.userFeedBack()}),e.click(function(e){return document.body.scrollIntoView(),e.preventDefault(),!1}),$(window).on("scroll",function(t){var n=document.documentElement.scrollTop||document.body.scrollTop;n>=300&&e.css("visibility")=="hidden"&&e.css("visibility","visible"),n<300&&e.css("visibility")=="visible"&&e.css("visibility","hidden");var r=0;$("#editform").length&&$("#editform").height()&&(r=parseInt($("#editform").offset().top+$("#editform").height()))});if(t){var n=$(".mod-other-ans li[qid="+t+"]");n.length&&setTimeout(function(){$("html,body").animate({scrollTop:n.offset().top-40},600,function(){n.css("background","#FEFFF0")})},500)}}function h(e){var t=e.attr("data").evalExp(),n=$(".js-panels").find("#"+t.nodeName).html(),r=e.closest(".console").find(".js-form-area"),i=r.find("."+t.nodeName),s=t.type,o;r.find(">div").each(function(e,n){$(n).hasClass(t.nodeName)||$(n).hide()}),e.closest(".console").find(".active").removeClass("active"),i.length>0?i.filter(":visible").length>0?(i.hide(),e.removeClass("active")):(i.show(),e.addClass("active")):(o=n.replace(/[\n\r\t]*/g,"").tmpl(t),r.append($(o).show()),e.addClass("active"),t.type&&(t.type==1||t.type==2||t.type==3)&&p(r,s))}function p(r,i){var s=3,o="js-html5-upload"+n,u="js-add-flash-img"+n,a={1:"\u8865\u5145\u63d0\u95ee\u2014\u201c\u6dfb\u52a0\u201d\u56fe\u7247\u70b9\u51fb",2:"\u8ffd\u95ee\u2014\u201c\u6dfb\u52a0\u201d\u56fe\u7247\u70b9\u51fb",3:"\u8ffd\u7b54\u2014\u201c\u6dfb\u52a0\u201d\u56fe\u7247\u70b9\u51fb"},f=r.find(".js-preview-upload"),l='<span class="preview-img js-preview-img"><img id="{$id}" src="{$src}" width="{$width}" height="{$height}"/><i class="delete-img"></i></span>';n++,r.find(".js-add-html5-img input").attr("id",o),r.find(".js-add-flash-img span").attr("id",u),i&&a[i]&&f.attr("text",a[i]),t.init({html5Input:o,flashInput:u,maxfiles:s,loadingImg:"http://p2.qhmsg.com/d/inn/072e8c30/loading.gif",errorImg:"http://p2.qhmsg.com/d/inn/8c2343ae/error.png",buttonWidth:30,buttonHeight:30,handlerOptions:{context:r.find(".js-upload-img-wrap"),tpl:l,tplData:{width:38,height:30}},beforeUpload:function(t){return r.find(".js-preview-img").length+t.length>s?(e.alert("\u4e0a\u4f20\u5931\u8d25","\u6700\u591a\u4e0a\u4f20"+s+"\u5f20\u56fe\u7247\u3002"),!1):(r.find(".js-preview-img").length+t.length==s&&this.fileQueueComplete(),!0)},progressUpdated:function(){r.find(".js-preview-img").length>0&&!f.hasClass("add-icon")&&f.addClass("add-icon")},fileQueueComplete:function(){f.addClass("dis-none"),r.find(".js-upload-tips").addClass("dis-block")}}),r.on("click",".delete-img",function(e){var t=$(this);t.parent().hide("fast",function(){$(this).remove(),r.find(".js-preview-img").length<s&&(r.find(".js-preview-img").length==0&&f.hasClass("add-icon")&&f.removeClass("add-icon"),f.removeClass("dis-none"),r.find(".js-upload-tips").removeClass("dis-block"))})})}function d(e){var t=$(this),n=t.parents(".mod-share").attr("data-con")||document.title,r="http://p2.qhmsg.com/t01dfe622dc593cfb65.png",i=[],s="",o={},u,a,f;t.hasClass("weixin")?(u=t.siblings(".weixin-box").show().find(".qrcode"),u.attr("data-make")!="1"&&(a=new QRCode(u[0],{width:83,height:83,colorDark:"#008000"}),setTimeout(function(){a.makeCode("http://m."+Wenda.Info.wenda_domain+"/q/"+Wenda.Info.askId+"?ref=wenda_detail_share_weixin")},0),u.attr("data-make",1))):t.hasClass("close")?(e.preventDefault(),t.parents(".weixin-box").hide()):(i=[{sina:"\u8fd9\u4e2a\u95ee\u9898\u6709\u610f\u601d\u54c8\uff0c\u8c01\u6765\u56de\u7b54\u4e0b\uff1f\u2192_\u2192\u3010{$title}\u3011\uff08\u5206\u4eab\u81ea@"+Wenda.Info.wenda_name+" \uff09",qzone:"\u8fd9\u4e2a\u95ee\u9898\u6709\u610f\u601d\u54c8\uff0c\u8c01\u6765\u56de\u7b54\u4e0b\uff1f\u2192_\u2192"},{sina:"\u3010{$title}\u3011\uff08\u5206\u4eab\u81ea@"+Wenda.Info.wenda_name+" \uff09",qzone:"\u3010{$title}\u3011\uff08\u6765\u81ea"+Wenda.Info.wenda_name+"\uff09"}],f=t.parents(".mod-resolved-ans").attr("ans_id"),f&&(o.ans_id=f,o.ask_id=Wenda.Info.askId,o.pic=r),t.hasClass("sina")&&(s="sina",o.title=i[~~Wenda.Info.isResolved][s].tmpl({title:n}),o.autoPic=!1),t.hasClass("qzone")&&(s="qzone",o.title=n,o.content=i[~~Wenda.Info.isResolved][s].tmpl({title:n}),o.pic=r),o.url="http://"+location.host+"/q/"+Wenda.Info.askId+"?ref=wenda_detail_share_"+s,Wenda.share.publish.apply(this,[s,o]))}function v(){var e=$("#mod-onebox-vote"),t=$("#mod-onebox-map");Wenda.Timer.delay("onebox",1e3,function(){$.ajax({url:"http://open.onebox."+Wenda.Info.root_domain+"/ui/?osrc=answer_vote&query="+encodeURIComponent(t.attr("data-title")),type:"get",dataType:"jsonp"}).done(function(n){n&&n[0]&&n[0].data&&$.getScript("http://s0.qhres.com/!827a72ed/_360so_ob_loader.js",function(){switch(n[0].type){case"map_new":n[0].
data.indexOf("mohe-map_bus")!=-1&&!$.fn.live&&($.fn.live=$.noop),$(".box",t).html(n[0].data.replace(/<h3[^>]*>.*?<\/h3>/gi,"").replace(/"cont"/gi,'"cont clearfix"').replace(/gclearfix/gi,"clearfix")),t.show(),setTimeout(function(){t.css({zoom:1})},0),Wenda.Log.send("detail-map-onebox","<\u7f51\u9875>\u3010\u8be6\u60c5\u9875\u51fa\u73b0\u5730\u56feonebox\u3011\u5c55\u73b0");break;case"answer_vote":Wenda.Info.isResolved=="1"&&e.html(n[0].data).show()}})})})}function m(){var e=location.href.queryUrl("ref");(e=="desktopicon"||e=="360safepop")&&!Wenda.User.hasLogin()&&Wenda.Log.send("js-detail","\u8be6\u60c5\u9875\u53ec\u56de\u672a\u767b\u5f55\u7528\u6237")}function g(){$.ajax({url:"http://t."+Wenda.Info.root_domain+"/openapi/istotantan",type:"get",dataType:"jsonp",jsonp:"callback",data:{q:$("#js-ask-title").val(),token:"gLJ1kQ8Wxx9k"}}).done(function(e){e.status=="ok"&&(e.data.toTantan==1?$(".detail-tantan").show():$(".detail-tantan").hide())}).fail(function(e){})}function y(){function t(e){var t=$("#js-detail .js-entans-monitor"),n=t.length;return n&&t.each(function(t,r){var i=$(this).attr("text");if(i)try{var s=i.evalExp();typeof s=="object"&&$.ObjectH.map(s,function(t,r){n>1&&(r=="ename"||r=="qid")&&(t=e[r]?e[r]+String.fromCharCode(1)+t:t),e[r]=t})}catch(o){e.con=i}}),e}var e=monitor.data.getTrack;monitor.data.getTrack=function(){var n=e();return n=t(n),n},window.monitorTrackDisabled&&(monitor.getTrack(),typeof QIHOO_MONITOR!="undefined"&&QIHOO_MONITOR.getTrack())}function b(e){var t=$(this).attr("data-id");if(t!=="link-to-so")return e.preventDefault(),!1}function w(){$(".js-wenda-src-moniter").each(function(e,t){Wenda.Log.send(t.value)})}function E(e){function c(e){Wenda.Detail.Panel.accept(s,n,r,i,f,u,a),$("#user_info").attr("qid")?Wenda.Log.send("detail_adopt","\u767b\u5f55\u91c7\u7eb3\u6ee1\u610f\u7b54\u6848"):Wenda.Log.send("detail_adopt","\u4e0d\u767b\u5f55\u91c7\u7eb3\u6ee1\u610f\u7b54\u6848"),Wenda.ReferEnum.sendLog("accept",Wenda.ReferEnum.getAcceptCode())}var t=$(e).closest(".js-form"),n=Wenda.Info.askId,r=t.attr("ans_id"),i=t.attr("qid"),s=t.find(".ask-author").html(),o=Wenda.Asklayer.getMID.IE()||Wenda.Asklayer.getMID.SE(),u="",a="",f="",l={};l.ask_id=n,l.ans_id=r,l.mid=o,$("#user_info").attr("qid")?(u="gift_btn",f="\u9001TA\u4e00\u4efd\u793c\u7269",a='\u83b7\u5f97 <span class="strong">2</span> \u91d1\u5e01\uff0c<span class="strong">2</span> \u7ecf\u9a8c\u503c'):(u="register_btn",f="\u53bb\u767b\u5f55",a='<span style="font-weight:bold;">\u767b\u5f55\u540e\u53ef\u4ee5\u66f4\u65b9\u4fbf\u7684\u63d0\u95ee\u548c\u91c7\u7eb3\u54e6~</span>'),Wenda.Net.connect("chosebest",l,c)}function S(){var e=$.trim($("#js-sh-ipt").val()).replace(/\s+/g,"+");if(e){var t={query:e,url:location.href};Wenda.Ajax.get("getDetailRecommdLink",t,function(e){if(e.result&&e.result.queries&&e.result.queries.length){var t="",n=e.result.queries;for(var r=0;r<n.length;r++){var i=encodeURIComponent(n[r].replace(/\s+/g,"+"));t+='<a href="https://www.so.com/s?q='+i+'&src=wenda_inline" target="_blank">'+n[r]+"</a>"}var s=$("#mod-recommond-text");$(".mod-recommond-text-inn",s).append($(t)),s.show(),Wenda.Log.sendShowLog("\u95ee\u7b54\u8be6\u60c5\u9875_\u4e3a\u60a8\u63a8\u8350_\u6a21\u5757\u5c55\u73b0")}})}}function x(){y(),m(),s(),f(),l(),c(),v(),S(),u(),w(),Wenda.Info.realViews<=1&&(Wenda.Log.send("","<\u7f51\u9875>\u3010\u63d0\u95ee\u6210\u529f\u9875\u6210\u529f\u5339\u914d\u81f3\u8c08\u8c08\u3011\u5c55\u73b0"),g()),Cookie.get("zhishi_mall_access")?$(".access").hide():$(".access").show(),$(".mod-detail").on("click",".js-append-form",function(e){e.preventDefault();var t=$(this);h(t)}).on("click",".js-choce-best",function(e){e.preventDefault();var t=$(this);E(t)}).on("mouseenter",".js-choce-best",function(e){var t=$(this).parent();$(".js-append-form",t).hide(),$(".js-entrance-tip",t).addClass("entrance-tip-show")}).on("mouseleave",".js-choce-best",function(e){var t=$(this).parent();$(".js-append-form",t).show(),$(".js-entrance-tip",t).removeClass("entrance-tip-show")}).on("click",".js-change-cate",function(e){i(Wenda.Info.askId)}).on("click",".js-access-close",function(e){$(this).parent().hide(),Cookie.set("zhishi_mall_access",1,{expires:2592e6,path:"/"}),Wenda.Log.send("","\u5546\u57ce\u63a8\u5e7f\u5165\u53e3\u5173\u95ed\u6309\u94ae\u70b9\u51fb\u91cf")}).on("click",".mod-share a",d).on("click",".js-add-hide",o).on("click",".resolved-cnt a",b),$("#ask-relate").length&&Wenda.Log.send("ask-relate","ask-relate-show"),Browser.ie6&&Wenda.Menu.hover("#hd-crumb .ico-caret","ico-caret-on"),$(".js-ask-student").click(function(e){e.preventDefault(),$(".js-ask-area").toggle().siblings().hide()}),$(".js-ask-area .js-ask-btn").click(function(e){e.preventDefault();var t=$(this),n=t.data("qid"),r=Wenda.Info.askId,i=t.data("code");Wenda.User.checkLogin(function(e){if(t.hasClass("off"))return;Wenda.Ajax.get("askStudent",{askid:r,toqid:n,inviteCode:i},function(e){t.addClass("off").text("\u5df2\u9080\u8bf7")})})}),$("#aside_ask_btn").click(function(e){e.preventDefault();var t=W(this).attr("id");a(t,!1)}),$("#bottom_ask_btn").click(function(e){e.preventDefault();var t=W(this).attr("id");a(t,!0)}),$(".js-recom-q-change").click(function(e){e.preventDefault(),r++,u()}),$(".js-login").click(function(){Wenda.User.checkLogin(function(){window.location.reload()})}),$("#e_idea_wenda_detail_rightBox").length>0&&Wenda.Log.send("\u8be6\u60c5\u9875\u53f3\u4fa7\u5e7f\u544aPV"),$("#e_idea_wenda_detail_left_wrap").length>0&&Wenda.Log.send("\u8be6\u60c5\u9875\u5de6\u4fa7\u5e7f\u544aPV"),$(".busi-det-l-xueersi").length>0&&(Wenda.Log.sendShowLog("\u8be6\u60c5\u9875\u5de6\u4fa7_\u5b66\u800c\u601d\u5e7f\u544a\u5c55\u793a"),$(".busi-det-l-xueersi li a").click(function(){Wenda.Log.send("\u8be6\u60c5\u9875\u5de6\u4fa7_\u5b66\u800c\u601d\u5e7f\u544a_\u5217\u8868\u9879\u70b9\u51fb")})),$(".busi-det-r-xueersi").length>0&&(Wenda.Log.sendShowLog("\u8be6\u60c5\u9875\u53f3\u4fa7_\u5b66\u800c\u601d\u5e7f\u544a\u5c55\u793a"),$(".busi-det-r-xueersi img").click(function(){Wenda.Log.send("\u8be6\u60c5\u9875\u53f3\u4fa7_\u5b66\u800c\u601d\u5e7f\u544a_\u56fe\u7247\u70b9\u51fb")}),$(".busi-det-r-xueersi p a").click(function(){Wenda.Log.send("\u8be6\u60c5\u9875\u53f3\u4fa7_\u5b66\u800c\u601d\u5e7f\u544a_\u94fe\u63a5\u6587\u5b57\u70b9\u51fb")}));var e=$(".js-team"),t=e.length;t>0&&e.each(function(){var e=$(this).data("type"),t=e=="best"?"[\u4e50\u5e2e\u56e2][web\u95ee\u9898\u8be6\u60c5\u9875][\u91c7\u7eb3/\u63a8\u8350\u56de\u7b54\u5c0f\u5c3e\u5df4\u5c55\u793a]":"[\u4e50\u5e2e\u56e2][web\u95ee\u9898\u8be6\u60c5\u9875][\u666e\u901a\u56de\u7b54\u5c0f\u5c3e\u5df4\u5c55\u793a]";Wenda.Log.send(t)}),($(".mod-wechat-qrcode").length||$(".mod-wechat-qrcode-mini").length)&&Wenda.Log.send("[\u8be6\u60c5\u9875][\u4e8c\u7ef4\u7801-\u5c55\u793a]")}var e=Wenda.Panel,t=Wenda.UploadImg,n=0,r=0;(function(e){e.on("click",".close-tip",function(){e.remove()})})($("#js-mod-fixed-float")),Wenda.share.onbefore=function(e,t){return t.ans_id&&t.ans_id>0&&(t.appUrl=e.url,e.url="/other/shareloading"),!0},x(),Wenda.Log.sendClose(),function(e){e.each(function(){var e=$(this).data("text");e&&Wenda.Log.send("",e)})}($(".js-show-data")),function(e){e.length>0&&Wenda.Log.sendShowLog("\u95ee\u8bca_\u8be6\u60c5\u9875\u5165\u53e3_\u5c55\u793a\u6b21\u6570")}($(".js-mod-doctor")),function(e){e.length>0&&Wenda.Log.sendShowLog("\u56de\u7b54\u7f16\u8f91\u6846_pv")}($("#editform")),$(".det-rt-chest").length&&Wenda.Log.sendShowLog("\u8be6\u60c5\u9875_\u51fa\u5b9d\u7bb1\u8fdb\u5ea6_\u5c55\u793a"),Wenda.Info.isResolved||Wenda.Log.sendShowLog("\u672a\u89e3\u51b3\u95ee\u9898\u8be6\u60c5\u9875_pv")}),$.extend(namespace("Wenda.Reply"),function(){function a(e){function l(e){$("body").on("mouseenter",f.list,function(e){c($(this),"show")}).on("mouseleave",f.list,function(e){c($(this),"hide")}),$("body").on("click",f.btn,function(e){e.preventDefault();var t=$(this),n=t.parents(f.list);t.toggleClass("selected"),h(n)}),$("body").on("keydown",".js-quick-answer-wrap textarea",d),$("body").on("click",".js-quick-ans-btn",v)}function c(e,n){var r=e.find(f.btn);if(r.hasClass("selected")||e.hasClass("set-gray"))return;t.delay("quickAnsId",50,function(){n=="show"?e.removeClass("hide-btn"):e.addClass("hide-btn")})}function h(e){var t=e.find(".js-quick-answer-wrap");t.length>0?t.slideToggle(200):(p(e),r.initErrorTip(e)),e.siblings().find(".js-quick-answer-wrap").slideUp(200).parents(f.list).addClass("hide-btn").find(f.btn).removeClass("selected")}function p(e){var t='<div class="quick-answer-wrap js-quick-answer-wrap"><textarea name="answer" cols="30" rows="10" placeholder="\u5982\u9700\u63d2\u5165\u56fe\u7247\uff0c\u8bf7\u70b9\u51fb\u6807\u9898\u5230\u95ee\u9898\u8be6\u60c5\u9875"></textarea><div class="quick-answer-opt"><div class="error-tip js-error-tip"></div><div class="captcha"><span class="captcha-error js-captcha-error" data-empty="\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801" data-wrong="\u9a8c\u8bc1\u7801\u9519\u8bef"></span><input class="js-captcha-input" type="text" name="captcha" maxlength="4" autocomplete="off" placeholder="\u9a8c\u8bc1\u7801"><img class="js-captcha-btn"/></div><button class="btn btn-2 quick-ans-btn js-quick-ans-btn" text="'+f.btnText+'">\u63d0\u4ea4\u56de\u7b54</button>'+"</div>"+"</div>";e.append(t).find(".js-quick-answer-wrap").slideDown(200)}function d(e){e.ctrlKey&&e.keyCode==13&&$(this).parent().find(".js-quick-ans-btn").trigger("click")}function v(e){var t=$(this),a=t.parents(f.list),l=$(f.btn,a),c=$(".js-quick-answer-wrap",a),h=$("textarea",c),p=$(".js-quick-ans-btn",c),d=$(".js-captcha-input",c),v=$(".js-error-tip",c);if(m(c)&&!t.hasClass("sending")){t.addClass("sending").text("\u63d0\u4ea4\u4e2d...");var g={quick:"1",ze_ans:a.data("ans"),ask_id:a.data("askid"),content:h.val(),captcha:d.val()},y={"-10001":function(e){s.login(function(){p.trigger("click")})},"-107":b,"-110":function(e){r.showErrorTip(c,"wrong"),r.need(c),r.change(c,!0)},"-123":function(e){u.send(f.answeredText),e.errmsg&&v.html(e.errmsg)},normal:function(e){e.errmsg&&v.html(e.errmsg)},end:function(e){t.removeClass("sending"),p.text("\u63d0\u4ea4\u56de\u7b54"),e.errno!="-110"&&r.hideCaptcha(c)}};function b(e){f.callback?f.callback(a):(a.addClass("set-gray"),c.slideUp(200),l.hide(),$(".js-answer-tips",a).show());var t="",n=e.data.user_info||{},r=n.coin_frequency_info||"";r&&r.score_add_ans>0&&(t+=" \u7ecf\u9a8c<span>+"+r.score_add_ans+"</span>"),r&&r.coin_add_ans>0&&(t+=" \u91d1\u5e01<span>+"+r.coin_add_ans+"</span>"),t||(t=""),i.steam({msg:t,width:240}),o.sendLog("answer",l.data("cid-pre"))}n.post("answer",g,b,y)}}function m(e){var t=$("textarea",e),n=$(".js-error-tip",e),i=t.val();return i.length?r.verify(e):(n.html("\u8bf7\u8f93\u5165\u56de\u7b54\u5185\u5bb9"),!1)}var a={list:".question-list li",btn:".js-quick-ans",btnText:"\u3010\u95ee\u9898\u5e93\u5feb\u901f\u56de\u7b54\u201c\u63d0\u4ea4\u56de\u7b54\u201d\u3011\u70b9\u51fb",answeredText:"\u201c\u95ee\u9898\u5df2\u56de\u7b54\u8fc7\u201d\u9519\u8bef\u63d0\u793a",callback:null},f=$.extend(!0,{},a,e||{});l()}var e={},t=Wenda.Timer,n=Wenda.Ajax,r=Wenda.Captcha,i=Wenda.Panel,s=Wenda.User,o=Wenda.ReferEnum,u=Wenda.Log;return e.quickAnswer=a,e}()),$(function(){function v(){m(),u.showWeiboDaren({selector:{checkbox:".js-weiboAuthCheck",vlist:".js-vAuthlist"},getTags:!0,ask_title:$(".js-ask-title").text()}),a.quickAnswer({list:"#succ_qlist li",btnText:"\u3010\u8be6\u60c5\u9875\u518d\u6765\u4e00\u9898\u5feb\u901f\u56de\u7b54\u201c\u63d0\u4ea4\u56de\u7b54\u201d\u3011\u70b9\u51fb"}),$("#editform").on("submit",y),$(".js-form-area").on("keydown",".js-added-con",function(e){(e.ctrlKey||e.metaKey)&&e.keyCode==13&&$(".js-added-submit").trigger("click")}),$(".mod-detail").on("click",".js-added-submit",g),$("#doc4").on("click","#succ_change_btn",O),$(window).bind("beforeunload",function(){if(d&&h&&h.hasContents(["img","iframe"]))return"\u4eb2\uff0c\u60a8\u6b63\u5728\u7f16\u8f91\u7684\u5185\u5bb9\u8fd8\u6ca1\u6709\u63d0\u4ea4\uff01"})}function m(){var e="detailUmeditor",n={umeditorOpt:{toolbar:["fullscreen bold settitle insertorderedlist insertunorderedlist uploadimg 360map"],initialContent:"\u6211\u6765\u5e2eTA\u56de\u7b54",dropFileEnabled:!1,pasteImageEnabled:!0},uploadImgOpt:{input:$("#js-file-upload"),button_width:28,button_height:28}};h=o.create(e,n),h&&h.onready(function(){$.Browser.msie!="6.0"&&$.Browser.msie!="7.0"&&!Cookie.get("WDUMFULLSCREEN")&&$(".js-fullscreen-tips").length&&($(".js-fullscreen-tips").show(),t.sendShowLog("\u56de\u7b54\u8f93\u5165\u6846\u2014\u5168\u5c4f\u4f7f\u7528\u63d0\u793a"))})}function g(e){var t=$(this),n=t.parents("form");if(!n)return;y(e,n)}function y(e,t){b();var t=t||$(this),n=t.attr("type"),r=!1;n=="0"||n=="4"?(!h.isFullState()||h.setFullScreen(),r=w(t)):r=E(t);if(!r)return!1;x(t,n)}function b(){i.getMID.IE()&&wdextcmd&&($("#ans_mid").val(wdextcmd.GetMid()),s.ansMid=wdextcmd.GetMid()),i.getMID.SE()&&external&&($("#ans_mid").val(external.GetMID(external.GetSID(window))),s.ansMid=external.GetMID(external.GetSID(window)))}function w(e){return s.hasInsertMap&&!h.hasContents(["iframe"])?(T(e,"\u8bf7\u8f93\u5165\u56de\u7b54\u5185\u5bb9"),!1):!s.hasInsertMap&&!h.hasContents(["img"])?(T(e,"\u8bf7\u8f93\u5165\u56de\u7b54\u5185\u5bb9"),!1):!s.hasInsertMap&&!h.isLimit()?(T(e,"\u4eb2\uff0c\u8bf7\u5b8c\u5584\u60a8\u7684\u56de\u7b54\uff0c\u63d0\u95ee\u4eba\u671f\u5f85\u60a8\u66f4\u8be6\u7ec6\u7684\u89e3\u7b54\u54e6\uff01"),!1):r.verify(e)}function E(e){var t=e.attr("type"),n=e.find(".js-added-con"),i="";if($.trim(n.val()).length<3){switch(t){case"1":i="\u4eb2\uff0c\u8bf7\u5b8c\u5584\u60a8\u7684\u95ee\u9898\uff0c\u56de\u7b54\u4eba\u671f\u5f85\u60a8\u66f4\u8be6\u7ec6\u7684\u95ee\u9898\u54e6\uff01";break;case"2":i="\u4eb2\uff0c\u8bf7\u5b8c\u5584\u60a8\u7684\u8ffd\u95ee\uff0c\u56de\u7b54\u4eba\u671f\u5f85\u60a8\u66f4\u8be6\u7ec6\u7684\u95ee\u9898\u54e6\uff01";break;case"3":i="\u4eb2\uff0c\u8bf7\u5b8c\u5584\u60a8\u7684\u56de\u7b54\uff0c\u63d0\u95ee\u4eba\u671f\u5f85\u60a8\u66f4\u8be6\u7ec6\u7684\u89e3\u7b54\u54e6\uff01";break;default:}return T(e,i),n.focus(),!1}return r.verify(e)?!0:!1}function x(n,i){function f(e){var r=n.attr("type");switch(r){case"0":s.answerId=e.data.ans_id,k(e.data.user_info),S&&redPackge.getIsShowRedPackge(e.data),t.send("editform","answer-submit-success");break;case"4":k(e.data.user_info),t.send("editform","hasbest-answer-submit-success");break;default:A(n,e.data.user_info);var i=["added-ask-success","added-trace-success","added-answer-success"];t.send("js-detail",i[r-1])}if($('.js-weiboAuthCheck[type="checkbox"]').is(":checked")){var o={ask_title:$(".js-ask-title").text(),ask_id:s.askId,ans_id:e.data.ans_id,type:"answer"};Wenda.Auth.getWeiboAuth(o)}Wenda.ReferEnum.sendLog("answer",Wenda.ReferEnum.getReplyCode())}var o={"-10001":function(){l.login(function(){$(".js-added-submit").trigger("click")})},"-107":f,"-110":function(){r.showErrorTip(n,"wrong"),r.need(n),r.change(n,!0)},normal:function(e){var t="\u7f51\u7edc\u8bf7\u6c42\u8d85\u65f6\uff0c\u8bf7\u5237\u65b0\u91cd\u8bd5";e&&e.errmsg&&(t=e.errmsg),T(n,t)},end:function(e){C(n);var t=e.errno;t!=0&&t!=-107&&t!=-110&&r.check(n)}};if(i!=0||i!=4){var u=n.find(".js-added-con").val(),a=n.find(".js-preview-img img");a.each(function(e,t){var n=$(this),r=n.attr("src"),i=n.data("size");r&&i&&(u+='<img src="'+r+'" data-size="'+i+'"/>')}),n.find(".js-added-allcon").val(u)}e.post("sendByFormWithToken",n,{beforeSend:function(){N(n)},success:f,complete:function(e){C(n)}},o)}function T(e,t){var n=e.find(".js-form-error");n.find(".err-cnt").html(t),t?n.show().delay(1e4).fadeOut():n.hide()}function N(e){e.find(".js-added-submit").parent().hide(),e.find(".js-submiting").show(),T(e,""),r.initErrorTip(e)}function C(e){e.find(".js-added-submit").parent().show(),e.find(".js-submiting").hide()}function k(e){d=!1;var t=e.coin_frequency_info,n='<div class="qrcode"></div><div class="succbox-rt">';$("#crumb_box").hide(),$("#bd").hide(),$("#answer_succ_box").show(),$("#succ_qlist_box").find(".ft").hide(),i.setMidNotice("answer"),t&&t.coin_add_ans&&t.score_add_ans?(n+='<p>\u606d\u559c\u8d5a\u5f97<span class="org">+'+t.coin_add_ans+"\u91d1\u5e01&nbsp;+"+t.score_add_ans+"\u7ecf\u9a8c",t.coin_continuity_ans&&(n+="\uff0c\u6301\u7eed\u56de\u7b54\u91d1\u5e01+"+t.coin_continuity_ans),n+="</span>\uff0c\u518d\u63a5\u518d\u5389\u54e6~</p>"):n+="\u56de\u7b54\u6210\u529f\uff0c\u611f\u8c22\u60a8\u5bf9\u95ee\u7b54\u7684\u8d21\u732e",n+='<div class="succ-tips js-qrcode-tips">\u626b\u63cf\u5de6\u4fa7\u4e8c\u7ef4\u7801\uff0c\u5173\u6ce8\u201c360\u95ee\u7b54\u201d\u5fae\u4fe1\u516c\u4f17\u8d26\u53f7<br>\u7b2c\u4e00\u65f6\u95f4\u83b7\u53d6\u88ab\u91c7\u7eb3\u4fe1\u606f</div></div>',$("#succ_text").html(n),L(),O()}function L(){var t=$("#succ_text").attr("data-askid");qrcodeWrap=$(".qrcode");var n={normal:function(e){qrcodeWrap.addClass("bg-succ-hand")}};e.get("getAnswerQrcode",{ask_id:t},function(e){qrcodeWrap.html('<img src="'+e.result+'"/><span class="codelogo"></span>'),$(".js-qrcode-tips").show()},n)}function A(e,t){var i=e.find(".js-added-con"),s=e.find(".js-added-allcon").val(),o=e.parents(".js-form"),u=t&&t.coin_frequency_info,a=e.attr("type"),l={1:"\u8865\u5145\uff1a",2:"\u8ffd\u95ee\uff1a",3:"\u8ffd\u7b54\uff1a"},c=a=="1"?'<li class="item-top"><span class="{$cn}">{$d}</span><span class="add-c">{$c}</span></li>':'<li class="item-pop"><span class="{$cn}">{$d}</span><span class="add-c {$bg}"><i class="bg-arr"></i><span class="bg">{$c}</span></span></li>',h=a=="3"?"ico-a":"ico-q",p=a=="3"?"bg-green":"bg-blue";s=f.tmpl(c,{cn:h,bg:p,d:l[a],c:s}),o.find(".js-added-area").show().find("ul").append(s),o.find(".entrance .add-ans, .entrance .add-ask").trigger("click"),i.val(""),e.find(".js-preview-img").remove(),e.find(".js-preview-upload").removeClass("add-icon dis-none"),e.find(".js-upload-tips").removeClass("dis-block"),r.hideCaptcha(e),a==2&&u.score_add_ask&&n.steam({msg:"\u7ecf\u9a8c\u503c+"+u.score_add_ask,width:400}),a==3&&(u.coin_add_append_answer||u.score_add_append_answer)&&n.steam({msg:"\u7ecf\u9a8c\u503c+"+u.score_add_append_answer+"\uff0c\u91d1\u5e01+"+u.coin_add_append_answer,width:400})}function O(n){p++;var r=$("#succ_qlist_box"),i=$("#succ_qlist"),o={cid:s.askCid,tid:s.askTag,ask_id:s.askId,pn:p,tpl:"ajax/detail/moreask_list"},u={normal:function(e){r.hide()}};e.get("moreAskList",o,function(e){e.result?(i.html(e.result),r.find(".hd").html("<span>\u518d\u6765\u4e00\u9898\uff0c\u51b2\u51fb\u5927\u5956</span>"),r.find(".hd").css("backgroundPosition","256px -479px"),r.show(),$("#succ_qlist_box").find(".ft").show(),p==1&&t.sendShowLog("\u3010\u8be6\u60c5\u9875\u518d\u6765\u4e00\u9898\u3011\u5c55\u73b0")):r.hide()},u)}var e=Wenda.Ajax,t=Wenda.Log,n=Wenda.Panel,r=Wenda.Captcha,i=Wenda.Mid,s=Wenda.Info,o=Wenda.UMeditor,u=Wenda.Auth,a=Wenda.Reply,f=Wenda.Util,l=Wenda.User,c=$("#editform"),h=null,p=0,d=!0;v();var S=!1}),Dom.ready(function(){function e(e,t){Wenda.Net.connect("sendByForm",$(".mod-q .js-add-reward form"),function(){var t=W(".mod-q").query(".ask-author"),n=W(".mod-q .mod-user-label .wealth"),r=Number(W(".js-add-reward").query("input:checked").val());n.length?n.html(r+Number(n.html())):t.insertAdjacentHTML("beforebegin",'<span class="wealth">'+r+'</span><span class="line">|</span>'),e.html(Number(e.html())-r),Wenda.Panel.steam(),W(".mod-q .add-reward").fire("click")})}function t(e,t){var n=Number(e.html()),r=t.query('[name="coin"]');if(n<5){var i='<div style="zoom:1;"><p>\u5bf9\u4e0d\u8d77\uff0c\u60a8\u53ea\u6709 <span class="wealth" id="add_coin_num">'+n+"</span> \u91d1\u5e01\uff0c\u4e0d\u8db3\u4ee5\u8ffd\u52a0\u60ac\u8d4f\u3002</p>"+"</div>"+"<div>"+'<span style="color: #999;">\u5feb\u52aa\u529b\u56de\u7b54\u95ee\u9898\uff0c\u83b7\u5f97\u66f4\u591a\u91d1\u5e01\u3002<a style="color:#2E8F02;" href="/c" target="_blank">\u6211\u8981\u56de\u7b54&raquo;</a></span>'+"</div>";return t.html(i),!1}return r.forEach(function(e){e=W(e),n<Number(e.val())&&e.attr("disabled","true").nextSibling("label").css("color","#c8c8c8")}),!0}(function(){W(".mod-detail").delegate(".mod-q .add-reward","click",function(e){e.preventDefault(),setTimeout(function(){var e=W(".mod-q .js-my-coin"),n=W(".mod-q .js-add-reward");t(e,n)},50)}).delegate(".mod-q .js-add-reward-yes","click",function(t){var n=W(".mod-q .js-my-coin"),r=W(".mod-q .js-add-reward");t.preventDefault(),e(n,r)})})()}),Dom.ready(function(){function e(e){function l(e){Wenda.Detail.Panel.accept(s,n,r,i,f,u,a),$("#user_info").attr("qid")?Wenda.Log.send("detail_adopt","\u767b\u5f55\u91c7\u7eb3\u6ee1\u610f\u7b54\u6848"):Wenda.Log.send("detail_adopt","\u4e0d\u767b\u5f55\u91c7\u7eb3\u6ee1\u610f\u7b54\u6848")}var t=$(this).closest(".js-form"),n=Wenda.Info.askId,r=t.attr("ans_id"),i=t.attr("qid"),s=t.find(".ask-author").html(),o=Wenda.Asklayer.getMID.IE()||Wenda.Asklayer.getMID.SE(),u="",a="",f="";t.find("input[name=mid]").val(o),$("#user_info").attr("qid")?(u="gift_btn",f="\u9001TA\u4e00\u4efd\u793c\u7269",a='\u83b7\u5f97 <span class="strong">2</span> \u91d1\u5e01\uff0c<span class="strong">2</span> \u7ecf\u9a8c\u503c'):(u="register_btn",f="\u53bb\u767b\u5f55",a='<span style="font-weight:bold;">\u767b\u5f55\u540e\u53ef\u4ee5\u66f4\u65b9\u4fbf\u7684\u63d0\u95ee\u548c\u91c7\u7eb3\u54e6~</span>'),Wenda.Net.connect("sendByFormWithToken",$(this).closest("form"),l)}$(".mod-detail").delegate(".js-set-confirm .js-yes","click",e).delegate(".js-set-confirm .js-no","click",function(e){$(this).closest(".js-set-confirm").remove()})}),Dom.ready(function(){function e(){var e=W("#ask_added_menu").query(".mod-ask-expert");e.html()==""&&Wenda.Net.connect("getexpertlist",{},function(t){e.html(t)})}W("#js-detail").delegate(".js-ask-expert","click",function(e){e.preventDefault();var t=Wenda.Info.askId,n=W(this).attr("data-qid");Wenda.Net.connect("seekhelp",{ask_id:t,qid:n},function(){var e=Wenda.Detail.askAddedTab,t=e.getItem(3);Wenda.Panel.steam(),e.hide(3)})}).delegate(".js-get-expert","click",function(t){t.preventDefault(),e()})}),Dom.ready(function(){function e(e,n,r,i){var s=W("#helpful_tip");s.length||(W(document.body).appendChild('<div id="helpful_tip" class="pop-remark-tips-yes" style="display:none;"></div>'),s=W("#helpful_tip")),r=="0"?s[0].className="pop-remark-tips-no":s[0].className="pop-remark-tips-yes";var o=W(e).getRect();s.html(n),s.css({height:"0px",opacity:0});var u=s.show().getRect(),a=i=="top"?o.height:u.height;s.css({left:o.left+o.width/2-u.width/2+"px",top:o.top-a+"px"}),t(s,o.top-a-20,20)}function t(e,t,n){e.animate({opacity:1,top:t,height:n},500,function(){e.fadeOut(500,"",QW.Easing.easeInStrong)},QW.Easing.easeInStrong)}W(".js-laud").hover(function(e){var t=W(this),n=t.attr("data-op"),r=Number(t.parentNode().attr("data-clicked")),i=n=="1"?"\u6709\u5e2e\u52a9":"\u65e0\u5e2e\u52a9";r&&(i="\u5df2\u8bc4\u4ef7",t.parentNode().query("a,span").css({cursor:"default"})),t.query("span").html(i)},function(){var e=W(this);e.query("span").html(e.attr("data-num"))}),W(".js-laud").on("click",function(t){var n=W(this),r=n.attr("data-op");if(n.parentNode().attr("data-clicked")=="1")return!1;var i=n.parentNode().attr("data-ans_id"),s=Wenda.Info.askId;Wenda.Net.connect("useful",{ask_id:s,ans_id:i,op:r},function(){var t=parseInt(n.attr("data-num"),10)+1;n.attr("data-num",t),n.parentNode().attr("data-clicked","1"),e(n,"+1\u611f\u8c22\u60a8\u7684\u8bc4\u4ef7",r);var i="useful-"+r;Wenda.Info.qid&&(i={dc:"useful-"+r,qid:Wenda.Info.qid}),Wenda.Log.send("mod-remarks",i)},{"default":function(t){e(n,t.errmsg,r)},"finally":function(e){var t=n.query("span").html();isNaN(t)||n.query("span").html(n.attr("data-num"))}})}),W(".console .action").delegate(".js-approve","click",function(t){var n=W(this),r=n.parentNode(".js-form").attr("ans_id"),i=Number(Wenda.Info.qid)==Number(W("#ask-author").attr("index"))?!0:!1,s=Wenda.Info.askId,o=function(){return Number(Wenda.Info.isResolved)?i?"reslove-asker-approve":"reslove-other-approve":i?"unreslove-asker-approve":"unreslove-other-approve"}();if(n.hasClass("approved"))return!1;Wenda.Net.connect("useful",{ask_id:s,ans_id:r,op:"1"},function(){var t=parseInt(n.attr("data-num"),10)+1;n.attr("data-num",t),n.addClass("approved"),n.query("i").html("\u5df2\u8d5e\u8fc7"),e(n,"+1",1),Wenda.Log.send("mod-remarks",o)},{"finally":function(e){var t=n.query("span").html();isNaN(t)||n.query("span").html(n.attr("data-num"))}})})}),$(function(){var e=Wenda.Info.askId;$(".js-form").hover(function(){$(this).find(".js-operate").css("visibility","visible")},function(){$(this).find(".js-operate").css("visibility","hidden")}),$(".js-weibo_daren").on("click",function(){var t=$(".js-hand");t.length>0&&t.hide();var n=$(this),r=n.data("type"),i={ask_title:$(".js-ask-title").text(),ask_id:e,getTags:!0,type:"ask"};r=="answer"&&(i.ans_id=n.parents(".js-form").attr("ans_id"),i.type=r),Wenda.Auth.getWeiboAuth(i)}),$(".js-report, .js-report2").click(function(){var t=$(this).parents(".js-form").attr("ans_id"),n=$(this).attr("data-type"),r=$(this).attr("qid")||"";Wenda.Global.Panel.report(e,t,n,r),!r&&$(".js-report-user").hide()}),$(".js-self-del").click(function(){Wenda.Panel.confirm("auditing","\u786e\u8ba4\u5220\u9664\u5417\uff1f","\u8bf7\u8c28\u614e\u64cd\u4f5c\uff01",Wenda.Info.wenda_name,function(){Wenda.Net.connect("deleteask",{ask_id:e},function(){Wenda.Panel.steam({msg:"\u64cd\u4f5c\u6210\u529f",width:300}),setTimeout(function(){location.reload()},3e3)})},function(){})})}),Dom.ready(function(){function t(e){var t={1:{url:"http://p7.qhmsg.com/t0182bfc9f44b85511d.png",word:"\u60a8\u7684\u56de\u7b54\u592a\u68d2\u4e86\uff0c\u9876\u4f60\uff01",name:"\u9876\u725b\u4ec1",className:"gift-niu"},2:{url:"http://p4.qhmsg.com/t0169190f5618ad4c78.png",word:"\u597d\u5e05\u7684\u56de\u7b54\uff0c\u4eb2\uff0c\u592a\u611f\u8c22\u60a8\u5566\uff01",name:"\u9001\u9999\u543b",className:"gift-kiss"},3:{url:"http://p3.qhmsg.com/t017e3aee6dd181489f.png",word:"\u60a8\u5e2e\u4e86\u6211\u5927\u5fd9\uff0c\u9001\u60a8\u9c9c\u82b1\u8868\u793a\u611f\u8c22\uff01",name:"\u9c9c\u82b1\u96e8",className:"gift-flower"}},n=t[e.data.gift_type],r=e.data.create_time,i=e.data.hostName=="\u533f\u540d\u7f51\u53cb"?"\u63d0\u95ee\u8005":"<a target='_blank' href='/u/"+e.data.ask_qid+"'>"+e.data.hostName+"</a>",s=i+"&nbsp;&nbsp;\u9001\u7ed9\u56de\u7b54\u8005\u4e00\u4efd\u793c\u7269&nbsp;&nbsp;"+n.name+"&nbsp;&nbsp;\u8d60\u8a00\uff1a"+n.word;n&&W(".mod-resolved-ans .js-gift").addClass(n.className).html(s).show()}var e=Wenda.Info.askId;Wenda.Info.isResolved&&Wenda.Net.connect("getgiftinfo",{ask_id:e},t)}),$(function(){function r(e,t){$.ajax({url:"/chip/getlistbyip?page="+e,dataType:"JSON"}).done(function(n){var i="";if(n.errno==0){if(t==0&&n.list.length==0)return;t==0&&n.list.length>0&&n.list.length<5&&$(".js-city-change").hide(),n.list.length?($.each(n.list,function(){i+='<li class="clearfix"><a href="/q/'+this.ask_id+'" target="_blank" class="title" text="\u3010\u8be6\u60c5\u9875-\u540c\u57ce\u95ee\u9898\u3011-\u70b9\u51fb" title="'+this.title+'">'+'<span class="city">\u3010'+n.tag+"\u3011</span>"+this.title+"</a>"+'<span class="time">'+this.create_time+"</span>"+"</li>",$(".js-related-city").show(),$(".js-city-list").html(i)}),$(".js-more-rel-city").find("a").attr("href","/c/?id_type=1&tid="+n.tid),n.list.length<5&&$(".js-city-change").data("maxpage",e)):e==0?($(".js-city-list").html("<br/><p>\u6682\u65f6\u8fd8\u6ca1\u6709\u9700\u8981\u5e2e\u52a9\u7684\u4eba\u54e6~</p>"),$(".js-city-change").hide(),$(".js-more-rel-city").hide()):($(".js-city-change").data("maxpage",e-1),e==1?$(".js-city-change").hide():(r(0,1),$(".js-city-change").data("page",0)))}})}var e=Wenda.Ajax,t=$.trim($(".js-sh-ipt").val())||$("#js-ask-title").val(),n=t;t.length>30&&(n=n.substring(0,30)+"..."),$(".js-rel-kw").html(n),e.get("getRelateQuery",{title:t},function(e){var t=e.data.slice(0,8),n=t.length;if(n<=0)return;var r=[];t.forEach(function(e){r.push('<li><a href="/search/?q='+encodeURIComponent(e)+'" target="_blank">'+e.subByte(20,"...")+"</a></li>")}),$("#js-rel-list").show(),$(".js-list-item").html(r.join("")),$(".js-sh-ipt").val()?Wenda.Log.send("js-rel-list","rel-show-byquery"):Wenda.Log.send("js-rel-list","rel-show-bytitle")}),Wenda.Info.isResolved&&r(0,0),$(document.body).delegate(".js-city-change","click",function(e){var t=$(this).data("page"),n=$(this).data("maxpage")>=0?$(this).data("maxpage"):9;t=t==n?0:t+1,$(this).data("page",t),r(t,1)})});var oSafeNoticePanel=null,oSafeSurePanel=null,oSafeDonePanel=null;$.ObjectH.mix(namespace("Wenda.Mid"),function(){function r(){var e=$.Deferred();n.IE()&&e.resolve();if(n.SE())try{e.resolve()}catch(t){alert(t)}return e.promise()}function i(){var e=$.Deferred();return t=="ask"&&Cookie.get("__WD_FIRST_SELFASK")==1&&(Cookie.set("__WD_FIRST_SELFASK","",{path:"/",expires:-1}),Wenda.Info.askMid&&e.resolve()),t=="answer"&&e.resolve(),e.promise()}function s(){var e=$.Deferred();return $.get("/safeOther/checkRecentLogin?time="+(new Date).getTime(),function(n){(n.errno==0&&!n.data.login||n.errno==-1&&t=="ask")&&e.resolve()}),e.promise()}function o(){var e=$.Deferred();return $.post("/safeOther/ismidnoticeopen",{mid:t=="ask"?Wenda.Info.askMid:Wenda.Info.ansMid},function(t){t.errno==0&&(t.data==""||t.data.open==0&&t.data.pop==1)&&e.resolve()}),e.promise()}function u(){l(),t=="ask"?($(".panel-osafe-notice").find(".info").text("\u5f53\u60a8\u7684\u63d0\u95ee\u6709\u65b0\u56de\u7b54\u7b49\u6d88\u606f\u65f6\uff0c\u60a8\u662f\u5426\u613f\u610f\u901a\u8fc7\u5173\u8054360\u5b89\u5168\u536b\u58eb\u76f8\u5173\u6a21\u5757\uff0c\u8ba9\u60a8\u7b2c\u4e00\u65f6\u95f4\u4ece360\u5b89\u5168\u536b\u58eb\u63a5\u6536\u6d88\u606f\u63d0\u9192\uff1f").end().find(".btn-ok").text("\u597d\u7684\uff0c\u6709\u65b0\u56de\u7b54\u8bf7\u7b2c\u4e00\u65f6\u95f4\u901a\u77e5\u6211"),$(".panel-osafe-done").find(".info").text("\u64cd\u4f5c\u6210\u529f\uff0c\u6709\u65b0\u56de\u7b54\u65f6\u5c06\u4f1a\u901a\u8fc7\u5c4f\u5e55\u53f3\u4e0b\u89d2\u7684\u5f39\u7a97\u901a\u77e5\u60a8\uff0c\u8bf7\u6ce8\u610f\u67e5\u6536\uff01"),Wenda.Log.send("setMidNotice","\u7f51\u9875\u63d0\u95ee\u6210\u529f\u540eMID\u63d0\u9192\u6d6e\u5c42\u5c55\u73b0")):($(".panel-osafe-notice").find(".info").text("\u5f53\u60a8\u7684\u56de\u7b54\u6709\u65b0\u8ffd\u95ee\u6d88\u606f\u65f6\uff0c\u60a8\u662f\u5426\u613f\u610f\u901a\u8fc7\u5173\u8054360\u5b89\u5168\u536b\u58eb\u76f8\u5173\u6a21\u5757\uff0c\u8ba9\u60a8\u7b2c\u4e00\u65f6\u95f4\u4ece360\u5b89\u5168\u536b\u58eb\u63a5\u6536\u6d88\u606f\u63d0\u9192\uff1f").end().find(".btn-ok").text("\u597d\u7684\uff0c\u6709\u65b0\u8ffd\u95ee\u8bf7\u7b2c\u4e00\u65f6\u95f4\u901a\u77e5\u6211").attr("text","\u7f51\u9875\u56de\u7b54\u6210\u529f\u540eMID\u63d0\u9192\u201c\u597d\u7684\uff0c\u7b2c\u4e00\u65f6\u95f4\u901a\u77e5\u6211\u201d\u70b9\u51fb").end().find(".btn-no").attr("text","\u7f51\u9875\u56de\u7b54\u6210\u529f\u540eMID\u63d0\u9192\u6682\u4e0d\u5f00\u542f\u70b9\u51fb"),$(".panel-osafe-done").find(".info").text("\u64cd\u4f5c\u6210\u529f\uff0c\u6709\u65b0\u8ffd\u95ee\u65f6\u5c06\u4f1a\u901a\u8fc7\u5c4f\u5e55\u53f3\u4e0b\u89d2\u7684\u5f39\u7a97\u901a\u77e5\u60a8\uff0c\u8bf7\u6ce8\u610f\u67e5\u6536\uff01"),Wenda.Log.send("setMidNotice","\u7f51\u9875\u56de\u7b54\u6210\u529f\u540eMID\u63d0\u9192\u6d6e\u5c42\u5c55\u73b0")),oSafeNoticePanel.showModal()}function a(e){t=e,$.when(r(),i()).then(s).then(o).then(u)}function f(e){Cookie.set(e.cookiename,e.cookieval,{expires:e.exp,path:"/"})}function l(){var e='<div class="mod-security-notice"><h1 class="hd">\u5f00\u542f360\u5b89\u5168\u536b\u58eb\u6d88\u606f\u901a\u77e5\u529f\u80fd</h1><div class="content"><div class="pic"></div><p class="info">\u5f53\u60a8\u7684\u63d0\u95ee\u6709\u65b0\u56de\u7b54\u7b49\u6d88\u606f\u65f6\uff0c\u60a8\u662f\u5426\u613f\u610f\u901a\u8fc7\u5173\u8054360\u5b89\u5168\u536b\u58eb\u76f8\u5173\u6a21\u5757\uff0c\u8ba9\u60a8\u7b2c\u4e00\u65f6\u95f4\u4ece360\u5b89\u5168\u536b\u58eb\u63a5\u6536\u6d88\u606f\u63d0\u9192\uff1f</p><div class="btn"><a text="\u7f51\u9875\u63d0\u95ee\u6210\u529f\u540eMID\u63d0\u9192\u201c\u597d\u7684\uff0c\u7b2c\u4e00\u65f6\u95f4\u901a\u77e5\u6211\u201d\u70b9\u51fb" class="btn-ok js-ok-open">\u597d\u7684\uff0c\u6709\u65b0\u56de\u7b54\u8bf7\u7b2c\u4e00\u65f6\u95f4\u901a\u77e5\u6211</a></div><a text="\u7f51\u9875\u63d0\u95ee\u6210\u529f\u540eMID\u63d0\u9192\u6682\u4e0d\u5f00\u542f\u70b9\u51fb" class="btn-no js-no-open">\u6682\u4e0d\u5f00\u542f</a></div></div>';oSafeNoticePanel=Wenda.Panel.create({width:580,height:368,fixed:!0,content:e,backdropOpacity:.4,skin:"panel-osafe-notice"});var t='<div class="mod-makesure-notice"><h1 class="hd">\u786e\u8ba4\u5f00\u542f</h1><div class="content"><div class="center"><a target="_blank" href="/other/midwhitepaper" title="\u4e3a\u4ec0\u4e48\u8981\u5173\u8054\u536b\u58eb\u529f\u80fd\u6a21\u5757"><div class="anzai-pic"></div></a><p class="info">\u63d0\u9192\u670d\u52a1\u9700\u8981\u5173\u8054\u5b89\u5168\u536b\u58eb\u529f\u80fd\u6a21\u5757\uff0c\u662f\u5426\u5141\u8bb8\uff1f</p></div><div class="btn"><a class="btn-sure js-sure-open">\u5141\u8bb8</a><a class="btn-cancel js-cancel-sure">\u4e0d\u5141\u8bb8</a></div></div></div>'
;oSafeSurePanel=Wenda.Panel.create({width:408,height:209,fixed:!0,content:t,backdropOpacity:.4,skin:"panel-osafe-sure"});var n='<div class="mod-security-notice"><h1 class="hd">\u5f00\u542f360\u5b89\u5168\u536b\u58eb\u6d88\u606f\u901a\u77e5\u529f\u80fd</h1><div class="content"><div class="done-pic"></div><p class="info center">\u64cd\u4f5c\u6210\u529f\uff0c\u6709\u65b0\u56de\u7b54\u65f6\u5c06\u4f1a\u901a\u8fc7\u5c4f\u5e55\u53f3\u4e0b\u89d2\u7684\u5f39\u7a97\u901a\u77e5\u60a8\uff0c\u8bf7\u6ce8\u610f\u67e5\u6536\uff01</p><div class="btn"><a class="btn-done js-done-open">\u5b8c\u6210</a></div></div></div>';oSafeDonePanel=Wenda.Panel.create({width:580,height:368,fixed:!0,content:n,backdropOpacity:.4,skin:"panel-osafe-done"})}var e={},t="",n={IE:function(){try{return wdextcmd.GetMid&&wdextcmd.CallQandAExpert}catch(e){return!1}},SE:function(){try{return external.GetMID(external.GetSID(window))}catch(e){return!1}}};return e.setMidNotice=a,e.getMID=n,e}()),$(document).ready(function(){function e(){var e=$.Deferred();return $.post("/safeOther/setMidNotice",{ask_id:Wenda.Info.askId,ans_id:Wenda.Info.answerId,open:1},function(t){t.errno==0&&e.resolve()}),e.promise()}function t(){Wenda.Mid.getMID.IE()&&wdextcmd.CallQandAExpert("/askid="+Wenda.Info.askId);if(Wenda.Mid.getMID.SE())try{external.AppCmd(external.GetSID(window),"sesafe","CallQAndAExpert","/askid="+Wenda.Info.askId,"",function(e,t){})}catch(e){return!1}}function n(){var e=$.Deferred();return $.post("/safeOther/setMidNotice",{ask_id:Wenda.Info.askId,ans_id:Wenda.Info.answerId,open:0},function(t){t.errno==0&&e.resolve()}),e.promise()}Wenda.Mid.setMidNotice("ask"),$(document.body).delegate(".js-ok-open","click",function(n){n.preventDefault(),$.when(e()).done(function(){t(),oSafeNoticePanel.close(),oSafeDonePanel.showModal()})}).delegate(".js-no-open","click",function(e){e.preventDefault(),$.when(n()).done(function(){oSafeNoticePanel.close()})}).delegate(".panel-osafe-notice .close","click",function(e){$(".panel-osafe-notice").find(".btn-no").attr("text").contains("\u63d0\u95ee")?Wenda.Log.send("setMidNotice","\u7f51\u9875\u63d0\u95ee\u6210\u529f\u540eMID\u63d0\u9192\u5173\u95ed\u6309\u94ae\u70b9\u51fb"):Wenda.Log.send("setMidNotice","\u7f51\u9875\u56de\u7b54\u6210\u529f\u540eMID\u63d0\u9192\u5173\u95ed\u6309\u94ae\u70b9\u51fb")}).delegate(".js-done-open","click",function(e){e.preventDefault(),oSafeDonePanel.close()})}),$(document).ready(function(){function t(e,t,n){n=n||{};var r=document.getElementsByTagName("head")[0]||document.documentElement,i=document.createElement("script"),s=!1;i.src=e,n.charset&&(i.charset=n.charset),"async"in n&&(i.async=n.async||""),i.onerror=i.onload=i.onreadystatechange=function(){!s&&(!this.readyState||this.readyState=="loaded"||this.readyState=="complete")&&(s=!0,t&&t(),i.onerror=i.onload=i.onreadystatechange=null,r.removeChild(i))},r.insertBefore(i,r.firstChild)}var e=document.write;document.write=function(t){var n=t.match(/src=(["'])([^"']+)\1/)[2],r=document.getElementById("tuiguang"),i=document.createElement("iframe");if(t.indexOf("http://tf.360.cn")==0)return!1;i.width="100%",i.height="100%",i.scrolling="no",i.frameBorder="0",i.allowtransparency="true",i.src=n,i.id="dianjing",r&&r.appendChild(i),document.write=e},t("http://tf.360.cn/e/w.js?_=76db1bfd2b9ad428")}),Dom.ready(function(){function s(n){function a(e,t,n){var r=0,s=[],o=e.split("");for(i=0;i<o.length;i++){var u=o[i],a=encodeURI(u);r+=a.length==1?1:a.length/3,r>t&&r<t+n+1&&s.push(decodeURI(a))}return s.join("")}function f(e,t){var n=o.length;if(n==0)return!1;for(var r=0;r<n;r++)return e=="match"&&o[r].matchword.indexOf(t)!="-1"?!0:e=="real"&&o[r].realword.indexOf(t)!="-1"?!0:!1}var s=QW.Browser.ie,o=[],u=!1;n.list.forEach(function(i){var l=i.ifstr,c=i.start,h=i.length,p=i.searchkey,d=!1;e.forEach(function(e,i){if(d)return;var v=W(e).html(),m=W(e).attr("__t")||v;if(m.indexOf(l)!="-1"){W(e).attr("__t")||W(e).attr("__t",m);var g=a(l,c,h),y="\u70b9\u51fb\u5b9e\u4f53\u8bcd"+r+encodeURIComponent(t)+r+n.version+r+g,b='<a style="color:#87B5F3;cursor:pointer;" data-id="link-to-so" data-c="'+y+'" text="\u70b9\u51fb\u5b9e\u4f53\u8bcd" target="_blank" href="http://www.'+Wenda.Info.root_domain+"/s?q="+encodeURIComponent(p)+'&ie=utf-8&src=wenda_link">'+g+"</a>",w=l.replace(g,b),E=v;!f("match",l)&&E.indexOf(l)!="-1"?E=E.replace(l,w):f("real",g)||(E=E.replace(g,b)),o.push({matchword:l,realword:g}),s&&parseInt(s)<=8&&v.indexOf("<P>")=="-1"&&(E=E.replace(/(\r\n|\n|\r)/g,"<br>")),W(e).html(E),d=!0,u=!0}})}),u?Wenda.Log.send("link-to-so","\u5339\u914d\u6210\u529f","\u5339\u914d\u6210\u529f"+r+t+r+n.version):Wenda.Log.send("link-to-so","\u5339\u914d\u4e0d\u6210\u529f","\u5339\u914d\u4e0d\u6210\u529f"+r+t+r+n.version),e.removeAttr("__t")}var e=W(".mod-resolved-ans .resolved-cnt");if(!e.length)return;if(W(".mod-resolved-ans").attr("data-resolved-type")=="essence")return;var t=location.href,n=t.split("?")[0],r=String.fromCharCode(1);Wenda.Log.send("link-to-so","\u5f00\u59cb\u5339\u914d","\u5f00\u59cb\u5339\u914d"+r+t),QW.loadJsonp("http://pagerec.f.360.cn/search_tip?cb=%callbackfun%&query="+encodeURIComponent(n),function(e){e&&e.list.length?s(e):Wenda.Log.send("link-to-so","\u5185\u94fe\u540e\u7aef\u4e3a\u7a7a","\u5185\u94fe\u540e\u7aef\u4e3a\u7a7a"+r+t)})}),$.ObjectH.mix(namespace("Wenda.Cate"),function(){function r(e,t){if(n[t]==undefined){var r=[];e.forEach(function(e){t==e.pid&&r.push("<option value="+e.cid+" title="+e.name+">"+e.name+"</option>")}),n[t]=r.join("")}return n[t]}function i(e,n){t?n&&n():$.ajax(e).done(function(e){t=e.data,n&&n()})}function s(e){function o(){$("select[level]",e.node).on("change",function(){f($(this))}),i(e.port_opts,function(){l(e.level,e.pid),e.defaultData&&u(typeof e.defaultData[0]=="object"?e.defaultData[0]:e.defaultData),$(n).triggerHandler("ready")})}function u(t){t.forEach(function(t,n){var r=c(n+Number(e.level));r.val(t),f(r)})}function a(){var t={};return t.value=[],t.title=[],$("select[level]",e.node).each(function(n,r){r=$(this);var i=r.val()||"";if(i==""||i=="-1")return e.level==2||e.level==3?!0:!1;var s=$('option[value="'+i+'"]',r).attr("title");return t.value.push(i),t.title.push(s),!0}),t}function f(t){var r=t.attr("to_level"),i=t.val();e.showIndex.length>1&&e.showIndex.contains(r)?l(r,i):$(n).trigger("change")}function l(i,s){if(!i||!s){$(n).triggerHandler("change");return}var o=r(t[i],s),u=c(i);if(!e.alwaysShow&&!o){u.html("").hide(),i=="2"&&c("3").html("").hide(),$(n).triggerHandler("change");return}var a=e.defaultText[Number(i)-1];a&&(o='<option selected="true" value="-1">'+a+"</option>"+o),u.html(o),e.showIndex.contains(i)&&u.show(),f(u)}function c(t){return $("select[level="+t+"]",e.node)}var n={},s={node:"",defaultData:[573],defaultText:["","\u4e0d\u9009","\u4e0d\u9009"],showIndex:["1","2","3"],alwaysShow:!1,port_opts:{url:"/category/getallcates/",type:"post",data:""},level:"1",pid:"0"},e=$.extend({},s,e);return e.node.length?(o(),n.setData=u,n.getData=a,n):!1}function o(e){for(var n=1;n<4;n++){var r=t[n];for(var i=r.length;i--;)if(r[i].cid==e)return r[i].name}}var e={},t=null,n={};return e.bind=s,e.getTitle=o,e}()),$.ObjectH.mix(namespace("Wenda.Ask.Panel"),function(){var e=Wenda.Panel,t='<div class="{$className}"><strong>{$msg}</strong><div id="{$id}"><select size="{$num}" class="class-table" level="1" to_level="2" style="display:none;"></select><select size="{$num}" class="class-table" level="2" to_level="3" style="display:none;"></select><select size="{$num}" class="class-table class-table-last" level="3" style="display:none;"></select></div></div>',n={cateSelect:function(n,r,i,s){n=n||"\u4e3a\u60a8\u7684\u95ee\u9898\u9009\u62e9\u4e00\u4e2a\u5408\u9002\u7684\u5206\u7c7b\uff1a";var o={skin:"panel-01",fixed:!0,width:488,content:t.tmpl({id:"category-pannel",className:"select-bd",msg:n,num:16}),header:"<h3>\u8bf7\u9009\u62e9\u5206\u7c7b</h3>",footer:'<div class="confirm-btn"><span class="btn btn-2"><button>\u786e\u5b9a</button></span></div><div class="clear"></div>'},u=e.create(o),a={node:$("#category-pannel")},f=Wenda.Cate.bind($.ObjectH.mix(a,r));return u.showModal(),$("."+o.skin).find(".confirm-btn").click(function(){i&&$.isFunction(i)&&(u.close(),i(f.getData()))}),s&&$.isFunction(s)?u.onclose=s:s&&s=="remove"&&(u.onclose=function(){u.remove()}),u.cateComp=f,u},cateSelectFloat:function(e){function o(){e.node.toggle()}var n={},r={id:"category-float-pannel",node:"",className:"classify-bd",msg:"",num:10};e=$.ObjectH.mix(e,r);if(!e.node.length)return!1;var i=t.tmpl(e);e.node.hide().html(i);var s=Wenda.Cate.bind({node:$("#"+e.id),defaultText:e.defaultText,defaultData:[e.defaultData],port_opts:e.port_opts,level:e.level,pid:e.pid,alwaysShow:e.alwaysShow,showIndex:e.showIndex});return e.alwaysShow?e.node.off("mouseleave"):e.node.on("mouseleave",function(t){e.node.hide()}),n.cateComp=s,n.toggle=o,n},safeCate:function(e){var t='<div class="{$className}"><strong>{$msg}</strong><div id="{$id}"><select size="{$num}" class="class-table l1" level="1" to_level="2" style="display:none;"></select><select size="{$num}" class="class-table l2" level="2" style="display:none;"></select><select size="{$num}" class="class-table l3" level="3" style="display:none;"></select></div></div>',n={id:"category-float-pannel",node:"",className:"classify-bd",msg:"",num:16},r={};e=$.ObjectH.mix(e,n);if(!e.node.length)return!1;var i=t.tmpl(e);e.node.html(i);var s=Wenda.Cate.bind({node:$("#"+e.id),defaultData:[1]});return r.cateComp=s,r},nologinAsk:function(){var t='<div class="log-item" id="nologin_btn" data-index="1"><div class="nolog-btn"></div><div class="log-guide">\u76f4\u63a5\u63d0\u95ee</div><div class="log-tips">\u65e0\u9700\u767b\u5f55\uff0c\u4e00\u952e\u63d0\u95ee</div><div class="log-tips-ask">( \u53ea\u80fd\u4f7f\u7528\u4e24\u6b21\u54e6~ )</div></div><div class="log-item" id="login_btn" data-index="2"><div class="qh-btn"></div><div class="log-guide">360\u5e10\u53f7\u767b\u5f55</div><div class="log-tips">\u66f4\u591a\u529f\u80fd\u3001\u5feb\u901f\u901a\u77e5</div></div><div id="log-item-bg" class="log-item-bg"></div>',n=e.create({width:300,fixed:!0,content:t,header:"<h3>\u8bf7\u9009\u62e9\u63d0\u95ee\u7684\u65b9\u5f0f</h3>",backdropOpacity:.2,skin:"panel-dialog panel-nologin-ask"});return n.onready=function(){$(this.node).delegate(".log-item","mouseenter",function(e){e.preventDefault();var t=$(this).attr("data-index");$("#log-item-bg").stop().animate({opacity:1,top:Number($(this).position().top)+1+"px"},150)})},n.showModal(),n},anonyNick:function(){var t='<div class="bd"><p class="desc">\u4eb2\uff0c\u4e3a\u4e86\u8ba9\u793e\u533a\u7684\u5c0f\u4f19\u4f34\u4eec\u8ba4\u8bc6\u60a8\uff0c\u8bf7\u8bbe\u7f6e\u6635\u79f0\uff1a</p><p><input type="text" class="text" id="nick_value" maxlength="5" value="\u95ee\u7b54\u6e38\u5ba2"><a id="nick_submit" href="javascript:;" class="btn btn-2-m"><span>\u63d0\u4ea4</span></a></p><p style="color: #ccc;">\u6635\u79f0\u4e0d\u8981\u8d85\u8fc75\u4e2a\u82f1\u6587\u5355\u8bcd\u6216\u80055\u4e2a\u4e2d\u6587\u5b57\u5466</p></div>',n=e.create({width:400,fixed:!0,cancel:function(){return!1},content:t,header:"\u9996\u6b21\u76f4\u63a5\u63d0\u95ee\u8bbe\u7f6e",footer:"",backdropOpacity:.2,skin:"panel panel-dialog panel-nick"});return n.onready=function(){this._$("close").hide()},n}};return n}()),$(document).ready(function(){function r(e,t,n,r,i){var s=e=="admin_ask"?"deleteaskbymgr":"deleteansbymgr";Wenda.Net.connect(s,{ask_id:t,ans_id:n,reason:r},function(){Wenda.Panel.steam({msg:"\u5220\u9664\u6210\u529f",width:300}),i=="detail"&&setTimeout(function(){location.reload()},1e3)})}function i(e,n){Wenda.Net.connect("setrecommendanswer",{ask_id:t,ans_id:e},function(){n=="admin"?$("#js-no-good-ans-btn").removeAttr("data-type").trigger("click","autoClick"):(Wenda.Panel.steam({msg:"\u63a8\u8350\u6210\u529f,2\u79d2\u540e\u9875\u9762\u81ea\u52a8\u5237\u65b0",width:500}),setTimeout(function(){location.reload()},2e3))})}function s(e){Wenda.Net.connect("cancelrecomanswer",{ask_id:e},function(){Wenda.Panel.steam({msg:"\u53d6\u6d88\u6210\u529f",width:500}),setTimeout(function(){location.reload()},500)})}function o(e){Wenda.Net.connect("setexcellentanswer",{ask_id:t,ans_id:e},function(){window.parent.$("#js-no-good-ans-btn").removeAttr("data-type").click()})}function u(){Wenda.Net.connect("cancelrecomanswer",{ask_id:t},function(){window.parent.$("#js-no-good-ans-btn").removeAttr("data-type").click()})}function a(e){var t=$(this),r=n.cateSelect("\u8f6c\u79fb\u5230\u5206\u7c7b:",!1,function(t){var n=t.value,r=n.pop();Wenda.Net.connect("changecatabymgr",{ask_id:e,dcid:r},function(){Wenda.Panel.steam({msg:"\u8f6c\u79fb\u6210\u529f",width:300})})},"remove")}location.href.indexOf("/userMgr/mgraskdetail?ask_id")!=-1&&top===self&&Wenda.Info.adminRole!=6&&(location.href="/userMgr/mgrasklist"),Wenda.Log.sendClose();var e=!0;$(".js-admin-apply-btn").click(function(t){t.preventDefault();if(!e)return;e=!1;var n=$(this).find("span"),r=Number(Wenda.Info.userRole),i=Wenda.Info.applyStatus;if(r){Wenda.Panel.alert("\u8bf7\u4e0d\u8981\u91cd\u590d\u7533\u8bf7\u54e6","\u60a8\u5df2\u7ecf\u662f\u7ba1\u7406\u5458\u65e0\u9700\u518d\u7533\u8bf7\u3002\u82e5\u60f3\u664b\u7ea7\u8bf7\u5230\u7ba1\u7406\u5458\u540e\u53f0\u7533\u8bf7\uff0c\u8c22\u8c22\uff01","","","");return}var s="";i=="0"?s="\u60a8\u5df2\u63d0\u4ea4\u8fc7\u7ba1\u7406\u5458\u7533\u8bf7\u8868\uff0c\u8bf7\u8010\u5fc3\u7b49\u5f85\u6211\u4eec\u7684\u7b54\u590d\uff0c\u8c22\u8c22\uff01":i=="1"&&(s="\u60a8\u5df2\u7ecf\u662f\u7ba1\u7406\u5458\u65e0\u9700\u518d\u7533\u8bf7\u3002\u82e5\u60f3\u664b\u7ea7\u8bf7\u5230\u7ba1\u7406\u5458\u540e\u53f0\u7533\u8bf7\uff0c\u8c22\u8c22\uff01");if(s){Wenda.Panel.alert("\u8bf7\u4e0d\u8981\u91cd\u590d\u7533\u8bf7\u54e6",s,"","","");return}$.ajax({url:"/userMgrApply/checkApply",timeout:5e3,beforeSend:function(){n.html("\u8df3\u8f6c\u4e2d...")},success:function(t){if(t.errno===0)window.location.href="/userMgrApply/apply";else if(t.errno===-1&&t.errmsg){if(t.errmsg.black===1)Wenda.Panel.alert("\u975e\u5e38\u62b1\u6b49\uff0c\u60a8\u5df2\u7ecf\u88ab\u62c9\u9ed1","\u62c9\u9ed1\u540e\u4e00\u4e2a\u6708\u4e4b\u5185\uff0c\u4e0d\u80fd\u518d\u7533\u8bf7","","","");else{var r="<br/>";t.errmsg.user_level&&t.errmsg.user_level===1?r+='<span class="apply_text apply_error">\u95ee\u7b54\u7b49\u7ea7\u226516</span><br/>':r+='<span class="apply_text apply_suc">\u95ee\u7b54\u7b49\u7ea7\u226516</span><br/>',t.errmsg.accept&&t.errmsg.accept===1?r+='<span class="apply_text apply_error">\u91c7\u7eb3\u7387\u226530%</span><br/>':r+='<span class="apply_text apply_suc">\u91c7\u7eb3\u7387\u226530%</span><br/>',Wenda.Panel.alert("\u975e\u5e38\u62b1\u6b49\uff0c\u60a8\u8fd8\u672a\u7b26\u5408\u8981\u6c42\uff01","\u8bf7\u7b26\u5408\u6761\u4ef6\u540e\u518d\u6b21\u7533\u8bf7\uff0c\u6211\u4eec\u7b49\u5f85\u60a8\u7684\u52a0\u5165\uff01"+r,"","","")}e=!0,n.html("\u7533\u8bf7\u52a0\u5165")}},error:function(){e=!0,n.html("\u7533\u8bf7\u52a0\u5165"),Wenda.Panel.alert("\u975e\u5e38\u62b1\u6b49\uff0c\u8bf7\u6c42\u5931\u8d25\uff01","\u7531\u4e8e\u7f51\u7edc\u4e0d\u7a33\u5b9a\u7533\u8bf7\u5931\u8d25\uff0c\u8bf7\u91cd\u65b0\u7533\u8bf7\uff01","","","")}})});if(!$("#user_info").attr("role"))return!1;var t=Wenda.Info.askId,n=Wenda.Ask.Panel;(function(){var e=location.href;if(e.indexOf("/userMgr/mgraskdetail")!="-1"){e.queryUrl("get_next")&&$(".pagination .pages a").each(function(e,n){$(n).attr("href","/userMgr/mgraskdetail?ask_id="+t+"&pn="+$(n).attr("href").queryUrl("pn"))});function n(e,n){var r=window.parent.location.href,i=r.queryUrl("pn")?r.queryUrl("pn"):0,s=e.data("next-page")!==""?parseInt(e.data("next-page")):parseInt(i*window.parent.SIZE+window.parent.CURIDX);if(window.parent.location.href.indexOf("/userMgr/specifiedasklist")!=-1||e.data("type")!="no-recomm")s+=1;var o="";if(n==="autoClick")o="/userMgr/mgraskdetail?ask_id="+t+"&get_next=1&next_pn="+s;else{var u=e.data("next-flag");o="/userMgr/mgraskdetail?ask_id="+t+"&next_flag="+u+"&get_next=1&next_pn="+s}var a=r.split("?")[1];if(a){var f=a.queryUrl();delete f.pn,o+="&"+$.ObjectH.encodeURIJson(f)}o+=window.parent.location.href.indexOf("/userMgr/specifiedasklist")!=-1?"&from_specified=1":"",location.href=o}function r(e){var n=Wenda.Panel.show({skin:"panel-dialog",title:"\u9ad8\u7ea7\u7f16\u8f91\u5185\u5bb9",fixed:!0,content:'<iframe src="/userMgr/getAdvancedAns?ask_id='+t+"&ans_id="+e+'"'+'width="715" height="502" scroll="no" frameborder="0"></iframe>',quickClose:!0,backdropOpacity:.4,onclose:function(){this.remove()}})}$(".no-good-ans-btn").on("click","#js-can-not-ans-btn",function(e,t){var r=$(this);Wenda.Log.send("","<\u7ba1\u7406\u5458\u540e\u53f0>\u3010\u6b64\u9898\u6211\u4e0d\u4f1a\uff0c\u6362\u4e00\u9898\u3011\u70b9\u51fb"),setTimeout(function(){n(r,t)},500)}),$(".no-good-ans-btn").on("click","#js-no-good-ans-btn",function(e,r){var i=$(this);if($(this).data("type")=="no-recomm"){var s=window.parent.location.href,o=s.queryUrl("answer_schema"),u={ask_id:t};o=="1"&&(u.is_advance="1"),Wenda.Net.connect("admin_nogood_answer",u,function(){n(i,r)})}else n(i,r)}),$(".js-admin-excellent-detail").click(function(e){r($(this).closest(".js-form").attr("ans_id"))})}})(),$(".js-admin-mba").click(function(e){e.preventDefault();var t=$(this).closest(".js-form").attr("ans_id"),n=$(".js-editor-best"),r=Wenda.UMeditor.get("detailUmeditor");n.find("#advance").hide().end().find("#fill-blank").remove().end().find('input[name="ans_id"]').val(t),r.setContent($(this).closest(".bd").find(".resolved-cnt").html()),n.show(),$("html,body").animate({scrollTop:n.offset().top-120}),r.setFocus(!0)}),$(".js-admin-del").click(function(e){e.preventDefault();var n="",i=$(this).parents(".js-form"),s=$(this).attr("data-type"),o=$(this).attr("data-qtype");i.length&&(n=i.attr("ans_id"));var u=$(this).parents("tr");u.find(".lnk").css("color","#999"),t=u.attr("id")||t;var a={skin:"panel-02 panel-report",fixed:!0,content:'<div class="group group-3"><h4>\u8bf7\u8c28\u614e\u505a\u5220\u9664\u64cd\u4f5c\uff0c\u5e76\u5728\u8f93\u5165\u6846\u91cc\u5199\u51fa\u5220\u9664\u7406\u7531\uff1a</h4><div class="textarea"><textarea id="rp_content" name="content" maxlength="100" style="height: 80px;" placeholder="\u8bf7\u8f93\u5165\u5220\u9664\u7406\u75315\u5230100\u4e2a\u5b57" ></textarea></div></div>',header:'<h3><i class="ico-report"></i>\u786e\u8ba4\u8981\u5220\u9664\u5417\uff1f</h3>',footer:'<span class="mark" style="float:left;" id="js-error"></span><span class="btn btn-2"><button id="rp_btn">\u786e\u8ba4</button></span>'},f=Wenda.Panel.show(a,470);f.onclose=function(){f.remove()},$("#rp_btn").click(function(e){var i=$("#rp_content").val().trim();e.preventDefault(),r(s,t,n,i,o),f.close()})}),$(".js-form").on("click",".js-admin-recom",function(e){e.preventDefault();var t=$(this).parents(".js-form").attr("ans_id"),n=$(this).data("page-type");Wenda.Panel.confirm("auditing","\u786e\u8ba4\u63a8\u8350\u5417\uff1f","\u63a8\u8350\u6210\u529f\u540e\u4f1a\u7acb\u523b\u751f\u6548\uff01",Wenda.Info.wenda_name,function(){i(t,n)},function(){})}),$(".js-admin-cancel-recom").click(function(e){e.preventDefault();var n=$(this).closest("tr").data("askid")||t;Wenda.Panel.confirm("auditing","\u786e\u8ba4\u53d6\u6d88\u63a8\u8350\u7b54\u6848\u5417\uff1f","\u53d6\u6d88\u6210\u529f\u540e\u4f1a\u7acb\u523b\u751f\u6548\uff01",Wenda.Info.wenda_name,function(){s(n)},function(){})}),$(".js-admin-mcate").click(function(e){e.preventDefault();var n=$(this).parents("tr");n.find(".lnk").css("color","#999"),a(n.attr("id")||t)}),$(".js-admin-excellent").click(function(e){e.preventDefault();var t=$(this).parents(".js-form").attr("ans_id");Wenda.Panel.confirm("auditing","\u786e\u8ba4\u52a0\u7cbe\u5417\uff1f","\u52a0\u7cbe\u6210\u529f\u540e\u4f1a\u7acb\u523b\u751f\u6548\uff01",Wenda.Info.wenda_name,function(){o(t)},function(){})}),$(".js-admin-excellent-cancel").click(function(e){e.preventDefault(),Wenda.Panel.confirm("auditing","\u786e\u8ba4\u53d6\u6d88\u52a0\u7cbe\u5417\uff1f","\u53d6\u6d88\u6210\u529f\u540e\u4f1a\u7acb\u523b\u751f\u6548\uff01",Wenda.Info.wenda_name,function(){u()},function(){})}),$(".js-admin-report").click(function(e){e.preventDefault();var n="",r=$(this).parents(".js-form"),i=$(this).attr("data-type");r.length&&(n=r.attr("ans_id"));var s=$(this).parents("tr");s.find(".lnk").css("color","#999");var o=s.attr("id")||t,u=$(this).attr("qid")||"";$.get("/userMgr/reportExist/",{ask_id:o,ans_id:n,t:+(new Date)},function(e){var t=e.errno|0;t==0?Wenda.Global.Panel.report(o,n,i,u):Wenda.Panel.steam({msg:"\u8be5\u6761\u63d0\u95ee\u6216\u56de\u7b54\u5df2\u88ab\u5176\u4ed6\u7ba1\u7406\u5458\u4e3e\u62a5",width:300})})})}),$(document).ready(function(){(function(){$("#js-detail").height()<$("#js-aside").height()+170?$("#e_idea_wenda_detail_rightBox").remove():$("#e_idea_wenda_detail_rightBox").css({visibility:"visible"});if($("#js-detail").height()<$("#js-aside").height()+410)return;var e=$("#js-haosou-qlist");$.get("/engine/getSoHotQuery",{t:+(new Date)},function(t){if(t.errno==0&&t.data.length){var n=[];$.each(t.data,function(e,t){n.push('<li><a text="<\u7f51\u9875\u8be6\u60c5\u9875><\u5927\u641c\u7d22>\u5927\u5bb6\u90fd\u5728\u641c<\u70b9\u51fb>" href="'+t.url+'" target="_blank">'+t.title+"</a></li>")}),e.show().find("ul").html(n.join("")).find("li").eq(n.length-1).addClass("last"),Wenda.Log.send("<\u7f51\u9875\u8be6\u60c5\u9875><\u5927\u641c\u7d22>\u5927\u5bb6\u90fd\u5728\u641c<\u5c55\u73b0>")}}),$("#js-haosou-qr").show()})()}),$(function(){function t(t){var r={toqid:t.data("toqid"),userName:t.data("username")},o={"-1":function(e){var t='<div class="panel-dialog-sys panel-alert cls"><div class="msg"><div class="auditing"><span><i></i>\u60a8\u8fd8\u4e0d\u53ef\u4ee5\u548cTA\u79c1\u4fe1\u4ea4\u6d41\u54e6~<br>\u4e0d\u8fc7\uff0c\u60a8\u53ef\u4ee5\uff1a</span></div><p>1.\u52a0\u5165\u4e50\u5e2e\u56e2\uff0c\u5373\u53ef\u548c\u672c\u56e2\u6210\u5458\u79c1\u4fe1\u4ea4\u6d41&nbsp;&nbsp;&nbsp;<br>2.\u6210\u4e3a\u4e50\u5e2e\u56e2\u56e2\u957f\uff0c\u5373\u53ef\u5411\u5168\u90e8\u95ee\u7b54\u7528\u6237\u79c1\u4fe1\u4ea4\u6d41</p></div><a class="btn-ctn js-close-msgpanel" href="/team" target="blank"><span class="btn btn-2 js-alert"><button>\u53bb\u4e50\u5e2e\u56e2</button></span></a></div>',n=Wenda.Panel.create({skin:"panel-dialog js-msg-panel",width:400,content:t,onready:function(){var e=$(".js-msg-panel");$(".js-close-msgpanel",e).click(function(e){Wenda.Log.send("\u79c1\u4fe1\u6d88\u606f_\u65e0\u6743\u9650\u5f39\u7a97_\u53bb\u4e50\u5e2e\u56e2\u70b9\u51fb"),n.close()}),$("span.close",e).click(function(e){Wenda.Log.send("\u79c1\u4fe1\u6d88\u606f_\u65e0\u6743\u9650\u5f39\u7a97_X\u6389\u70b9\u51fb")}),Wenda.Log.send("\u79c1\u4fe1\u6d88\u606f_\u65e0\u6743\u9650\u5f39\u7a97_\u5f39\u7a97\u5c55\u793a")}}).showModal()}};Wenda.Ajax.get("checkRole",r,function(t){Wenda.Panel.create({skin:"panel-dialog-msgbox",width:600,content:t.result,onready:function(){var t=$(".panel-dialog-msgbox"),r=$(".js-form-msg",t),o=$(".js-msg-relation",t),u=$(".js-send-msgbtn",t);e.need(r,!1),u.click(function(e){return e.preventDefault(),i(r)&&s(r)&&n(r),!1}),o.click(function(e){e.preventDefault();var n=$(this),r={toqid:n.data("toqid"),flag:"block"},i="\u786e\u8ba4\u5c4f\u853d\u6b64\u7528\u6237?",s="\u5c4f\u853d\u540e\uff0c\u60a8\u5c06\u4e0d\u518d\u6536\u5230\u5176\u79c1\u4fe1\uff0c\u4e5f\u4e0d\u80fd\u5411\u5176\u53d1\u9001\u79c1\u4fe1";n.hasClass("off")&&(r.flag="cancelblock",i="\u786e\u8ba4\u53d6\u6d88\u5c4f\u853d\u6b64\u7528\u6237?",s="\u53d6\u6d88\u5c4f\u853d\u540e\uff0c\u60a8\u53ef\u4ee5\u6b63\u5e38\u6536\u53d1\u8be5\u7528\u6237\u7684\u79c1\u4fe1"),Wenda.Panel.confirm("",i,s,"",function(){Wenda.Ajax.get("blockCancelUser",r,function(){n.toggleClass("off"),u.toggleClass("off"),n.hasClass("off")?$(".msg-err-tips",t).text("\u60a8\u5df2\u5c4f\u853d\u4e86\u6b64\u7528\u6237\uff0c\u8bf7\u70b9\u51fb\u53f3\u4e0a\u89d2\u53d6\u6d88\u5c4f\u853d").show():$(".msg-err-tips",t).hide()})})})},onclose:function(){Wenda.Log.send("\u79c1\u4fe1\u6d88\u606f_\u79c1\u4fe1TA\u5f39\u7a97_\u5173\u95ed\u70b9\u51fb")}}).showModal()},o)}function n(t){var n={normal:function(e){$(".msg-err-tips",t).text(e.errmsg).fadeIn(300).delay(3e3).fadeOut(300)},"-3001":function(e){$(".js-msg-relation",t).addClass("off"),$(".js-send-msgbtn",t).addClass("off"),$(".msg-err-tips",t).text(e.errmsg).show()},"-110":function(){$(".msg-captcha-tips",t).addClass("error").css("display","inline-block")},"-10001":function(){msgboxPanel.close(),Wenda.User.login()},end:function(){e.change(t,!0)}};Wenda.Ajax.post("sendPrivateMsg",t,function(){location.href="/user/msglist/"+Wenda.Info.qid},n)}function i(t){if($(".js-send-msgbtn",t).hasClass("off"))return!1;if(t){var n=$(".js-word-num i",t).text();if(n>0&&n<=1e3)return!0;$(".msg-err-tips",t).text("\u8bf7\u8f93\u51651-1000\u5b57\u7684\u79c1\u4fe1\u5185\u5bb9").fadeIn(300).delay(3e3).fadeOut(300),e.change(t,!0)}return!1}function s(t){if(t){var n=$(".msg-captcha-tips",t);if(e.verify(t))return!0;n.addClass("error").css("display","inline-block")}return!1}var e=Wenda.Captcha;$(document).on("click",".js-send-message",function(e){e.preventDefault(),t($(this))});var r="oninput"in document?"input":"keyup";$(document).on(r,".panel-dialog-msgbox .js-msg-content",function(e){var t=$(".panel-dialog-msgbox"),n=$(this).val().length;$(".js-word-num i",t).text(n)})}),$(function(){var e=$("#js-mod-novice-task");e.on("click",".js-user-login",function(){$("#js-not-login").find(".user-login").click(),Wenda.Log.send("\u65b0\u624b\u5f15\u5bfc_\u8be6\u60c5\u9875_\u9a6c\u4e0a\u767b\u5f55\u6309\u94ae_\u70b9\u51fb")}),e.on("click",".js-user-reg",function(){$("#js-not-login").find(".user-reg").click(),Wenda.Log.send("\u65b0\u624b\u5f15\u5bfc_\u8be6\u60c5\u9875_\u7acb\u5373\u6ce8\u518c\u6309\u94ae_\u70b9\u51fb")}),e.find(".js-user-login").length&&Wenda.Log.send("\u65b0\u624b\u5f15\u5bfc_\u8be6\u60c5\u9875_\u51fa\u767b\u5f55\u63d0\u793a\u6240\u6709\u9875\u9762_\u5c55\u793a"),e.find(".do-task").length&&Wenda.Log.send("\u65b0\u624b\u5f15\u5bfc_\u8be6\u60c5\u9875_\u51fa\u53bb\u505a\u65b0\u624b\u4efb\u52a1\u6240\u6709\u9875\u9762_\u5c55\u793a"),e.find(".answer-guide").length&&Wenda.Log.send("\u65b0\u624b\u5f15\u5bfc_\u8be6\u60c5\u9875_\u51fa\u7b54\u9898\u653b\u7565\u6240\u6709\u9875\u9762_\u5c55\u793a"),$(".mod-log-scoll-mall").length&&Wenda.Log.send("\u65b0\u624b\u5f15\u5bfc_\u8be6\u60c5\u9875_\u51fa\u673a\u52a8\u5e7f\u544a\u56fe\u6240\u6709\u9875\u9762_\u6d4f\u89c8")});